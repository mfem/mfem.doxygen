<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFEM: miniapps/solvers/div_free_solver.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v4.5.2</span>
   </div>
   <div id="projectbrief">Finite element discretization library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_91a531bd2464e2c6fce2455e0d45f88f.html">miniapps</a></li><li class="navelem"><a class="el" href="dir_30a46d574472fdba873c4128bbc57ff9.html">solvers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">div_free_solver.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="div__free__solver_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) 2010-2023, Lawrence Livermore National Security, LLC. Produced</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// at the Lawrence Livermore National Laboratory. All Rights reserved. See files</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LICENSE and NOTICE for details. LLNL-CODE-806117.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the MFEM library. For more information and source code</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// availability visit https://mfem.org.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// terms of the BSD-3 license. We welcome feedback and contributions, see file</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// CONTRIBUTING.md for details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="div__free__solver_8hpp.html">div_free_solver.hpp</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacemfem.html">mfem</a>;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">using namespace </span>blocksolvers;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="div__free__solver_8cpp.html#aa0da922baa249048aeaba5672d6c28a7">   18</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="div__free__solver_8cpp.html#aa0da922baa249048aeaba5672d6c28a7">SetOptions</a>(<a class="code" href="classmfem_1_1IterativeSolver.html">IterativeSolver</a>&amp; solver, <span class="keyword">const</span> <a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html">IterSolveParameters</a>&amp; param)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   solver.<a class="code" href="classmfem_1_1IterativeSolver.html#a95572a30eb8d7f2958faf0086b9f7bd2">SetPrintLevel</a>(param.<a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#a401a50aa6a65361a4e5a20a632909076">print_level</a>);</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   solver.<a class="code" href="classmfem_1_1IterativeSolver.html#a99fd388c7f98fed97fdcda50776288f5">SetMaxIter</a>(param.<a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#ab455df7166cca7e98fa5444dc3a22f88">max_iter</a>);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   solver.<a class="code" href="classmfem_1_1IterativeSolver.html#a180b408e09c85536b3f97b1f97039c76">SetAbsTol</a>(param.<a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#a25e5bfb80565a559d93dc7bdca59a01a">abs_tol</a>);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   solver.<a class="code" href="classmfem_1_1IterativeSolver.html#ac2c2469f0b0ca6f3d183d11c89f2cdf9">SetRelTol</a>(param.<a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#adf0b83f507276f406774f6e3c2786259">rel_tol</a>);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="div__free__solver_8cpp.html#a77a3f5dc1bbb79e8f03c51ce63871d9d">   26</a></span>&#160;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>* <a class="code" href="div__free__solver_8cpp.html#a77a3f5dc1bbb79e8f03c51ce63871d9d">TwoStepsRAP</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; Rt, <span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; A,</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; P)</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> R(Rt.<a class="code" href="classmfem_1_1HypreParMatrix.html#af4b829612c06c355c02e515b4a23f542">Transpose</a>());</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> RA(<a class="code" href="namespacemfem.html#aac0ca1f147dff828a18e0c38d1eabf63">ParMult</a>(R.As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;(), &amp;A));</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="namespacemfem.html#aac0ca1f147dff828a18e0c38d1eabf63">ParMult</a>(RA.As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;(), &amp;P, <span class="keyword">true</span>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="div__free__solver_8cpp.html#a05444ce25fd061bd9145b44ca26b216a">   34</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="div__free__solver_8cpp.html#a05444ce25fd061bd9145b44ca26b216a">GetRowColumnsRef</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; A, <span class="keywordtype">int</span> row, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>&amp; cols)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   cols.<a class="code" href="classmfem_1_1Array.html#a7f0770ecb717feb309f278800f65a416">MakeRef</a>(const_cast&lt;int*&gt;(A.<a class="code" href="classmfem_1_1SparseMatrix.html#a93c5050b0b98e26b82f9a205c7253273">GetRowColumns</a>(row)), A.<a class="code" href="classmfem_1_1SparseMatrix.html#a97386d280f2a41b36161aec5a6748cf4">RowSize</a>(row));</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="div__free__solver_8cpp.html#ab2735d067d4901b29904b007ea1afed0">   39</a></span>&#160;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a> <a class="code" href="div__free__solver_8cpp.html#ab2735d067d4901b29904b007ea1afed0">ElemToDof</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>&amp; fes)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="keywordtype">int</span>* I = <span class="keyword">new</span> <span class="keywordtype">int</span>[fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a7ec934fafa4317e6f9b33434bd8cf5b6">GetNE</a>()+1];</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   copy_n(fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a85ec308dd5c94207f05825e2acc8722c">GetElementToDofTable</a>().<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>(), fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a7ec934fafa4317e6f9b33434bd8cf5b6">GetNE</a>()+1, I);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> J(<span class="keyword">new</span> <span class="keywordtype">int</span>[I[fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a7ec934fafa4317e6f9b33434bd8cf5b6">GetNE</a>()]], I[fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a7ec934fafa4317e6f9b33434bd8cf5b6">GetNE</a>()]);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   copy_n(fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a85ec308dd5c94207f05825e2acc8722c">GetElementToDofTable</a>().<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>(), J.Size(), J.begin());</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a33252b6934b06dc088c2683868c8a88d">AdjustVDofs</a>(J);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="keywordtype">double</span>* D = <span class="keyword">new</span> <span class="keywordtype">double</span>[J.Size()];</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   fill_n(D, J.Size(), 1.0);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>(I, J, D, fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a7ec934fafa4317e6f9b33434bd8cf5b6">GetNE</a>(), fes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#ad01ffa1b529189db65b3dd27293ca791">GetVSize</a>());</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1DFSSpaces.html#a452f4a5ec69d9ee401d9616001ab583c">   51</a></span>&#160;DFSSpaces::DFSSpaces(<span class="keywordtype">int</span> order, <span class="keywordtype">int</span> num_refine, <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *mesh,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>&amp; ess_attr, <span class="keyword">const</span> <a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html">DFSParameters</a>&amp; param)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   : hdiv_fec_(order, mesh-&gt;Dimension()), l2_fec_(order, mesh-&gt;Dimension()),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;     l2_0_fec_(0, mesh-&gt;Dimension()), ess_bdr_attr_(ess_attr), level_(0)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">if</span> (mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aac0ecfa0737785cb713cb30b81bdf591">GetElement</a>(0)-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1">Element::TETRAHEDRON</a> &amp;&amp; order)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;DFSDataCollector: High order spaces on tetrahedra are not supported&quot;</span>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#aba60d7d4a2e89b1ecafeb605f7489c22">param</a> = param;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span> (mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a6875d857942c66cb8cea1159337b807a">Dimension</a>() == 3)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      hcurl_fec_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ND__FECollection.html">ND_FECollection</a>(order+1, mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a6875d857942c66cb8cea1159337b807a">Dimension</a>()));</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      hcurl_fec_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1H1__FECollection.html">H1_FECollection</a>(order+1, mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a6875d857942c66cb8cea1159337b807a">Dimension</a>()));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   all_bdr_attr_.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(ess_attr.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(), 1);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   hdiv_fes_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(mesh, &amp;hdiv_fec_));</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   l2_fes_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(mesh, &amp;l2_fec_));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   coarse_hdiv_fes_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(*hdiv_fes_));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   coarse_l2_fes_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(*l2_fes_));</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   l2_0_fes_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(mesh, &amp;l2_0_fec_));</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   l2_0_fes_-&gt;SetUpdateOperatorType(<a class="code" href="classmfem_1_1Operator.html#aaa033bcf10ca8783218f5d98d8c54288a1149a94d7b60f7432d9106f29bea24ac">Operator::MFEM_SPARSEMAT</a>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   el_l2dof_.reserve(num_refine+1);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   el_l2dof_.push_back(<a class="code" href="div__free__solver_8cpp.html#ab2735d067d4901b29904b007ea1afed0">ElemToDof</a>(*coarse_l2_fes_));</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ade694bd867d944826c2218207f456694">agg_hdivdof</a>.resize(num_refine);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a2995e0eb2a01de41b2c9de1a6e58ba31">agg_l2dof</a>.resize(num_refine);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d5267f1a32c43d783fd84aa315213d2">P_hdiv</a>.resize(num_refine, <a class="code" href="namespacemfem.html#a1b718f7693a3082acf73b7edd45c23a5">OperatorPtr</a>(<a class="code" href="classmfem_1_1Operator.html#aaa033bcf10ca8783218f5d98d8c54288a4387eb0ca1b04ce84b728325a98ea82c">Operator::Hypre_ParCSR</a>));</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>.resize(num_refine, <a class="code" href="namespacemfem.html#a1b718f7693a3082acf73b7edd45c23a5">OperatorPtr</a>(<a class="code" href="classmfem_1_1Operator.html#aaa033bcf10ca8783218f5d98d8c54288a4387eb0ca1b04ce84b728325a98ea82c">Operator::Hypre_ParCSR</a>));</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ab4b1208c465773bf1a17ed54b0eb99e8">Q_l2</a>.resize(num_refine);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   hdiv_fes_-&gt;GetEssentialTrueDofs(ess_attr, data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d2e5d184cab013170ab2ce17ef98565">coarsest_ess_hdivdofs</a>);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">C</a>.resize(num_refine+1);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   hcurl_fes_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(mesh, hcurl_fec_.get()));</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   coarse_hcurl_fes_.reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(*hcurl_fes_));</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a371db30f609920065da1bddfa46bafdf">P_hcurl</a>.resize(num_refine, <a class="code" href="namespacemfem.html#a1b718f7693a3082acf73b7edd45c23a5">OperatorPtr</a>(<a class="code" href="classmfem_1_1Operator.html#aaa033bcf10ca8783218f5d98d8c54288a4387eb0ca1b04ce84b728325a98ea82c">Operator::Hypre_ParCSR</a>));</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="div__free__solver_8cpp.html#ade939524a52cca9c3527fd74e9961fda">   95</a></span>&#160;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>* <a class="code" href="div__free__solver_8cpp.html#ade939524a52cca9c3527fd74e9961fda">AggToInteriorDof</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>&amp; bdr_truedofs,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; agg_elem,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; elem_dof,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; dof_truedof,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                               <a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a>&amp; agg_starts)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> agg_dof(<a class="code" href="namespacemfem.html#a2e66df64396d3a16eea7b2623380f51b">Mult</a>(agg_elem, elem_dof));</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; agg_dof_ref = *agg_dof.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&gt;();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> agg_tdof(dof_truedof.<a class="code" href="classmfem_1_1HypreParMatrix.html#a5fb3df7868045fe5659196e205de2aec">LeftDiagMult</a>(agg_dof_ref, agg_starts));</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> agg_tdof_T(agg_tdof.As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;<a class="code" href="classmfem_1_1HypreParMatrix.html#af4b829612c06c355c02e515b4a23f542">Transpose</a>());</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a> tdof_agg, is_shared;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <a class="code" href="hypre__parcsr_8hpp.html#a891d15140bcc33b92ff03f02664c9022">HYPRE_BigInt</a>* trash;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   agg_tdof_T.As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;GetDiag(tdof_agg);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   agg_tdof_T.As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;GetOffd(is_shared, trash);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="keywordtype">int</span> * I = <span class="keyword">new</span> <span class="keywordtype">int</span> [tdof_agg.NumRows()+1]();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordtype">int</span> * J = <span class="keyword">new</span> <span class="keywordtype">int</span>[tdof_agg.NumNonZeroElems()];</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> is_bdr;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="classmfem_1_1FiniteElementSpace.html#a47bf8a3ca650bc0c8e77941304172656">FiniteElementSpace::ListToMarker</a>(bdr_truedofs, tdof_agg.NumRows(), is_bdr);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="keywordtype">int</span> counter = 0;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; tdof_agg.NumRows(); ++i)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordtype">bool</span> agg_bdr = is_bdr[i] || is_shared.RowSize(i) || tdof_agg.RowSize(i)&gt;1;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">if</span> (agg_bdr) { I[i+1] = I[i]; <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      I[i+1] = I[i] + 1;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      J[counter++] = tdof_agg.GetRowColumns(i)[0];</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="keywordtype">double</span> * D = <span class="keyword">new</span> <span class="keywordtype">double</span>[I[tdof_agg.NumRows()]];</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   std::fill_n(D, I[tdof_agg.NumRows()], 1.0);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a> intdof_agg(I, J, D, tdof_agg.NumRows(), tdof_agg.NumCols());</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">Transpose</a>(intdof_agg);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">void</span> DFSSpaces::MakeDofRelationTables(<span class="keywordtype">int</span> level)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> agg_starts(<a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a>(l2_0_fes_-&gt;GetDofOffsets(),</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                      2));</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keyword">auto</span>&amp; elem_agg = (<span class="keyword">const</span> <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp;)*l2_0_fes_-&gt;GetUpdateOperator();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> agg_elem(<a class="code" href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">Transpose</a>(elem_agg));</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; agg_el = *agg_elem.As&lt;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&gt;();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   el_l2dof_.push_back(<a class="code" href="div__free__solver_8cpp.html#ab2735d067d4901b29904b007ea1afed0">ElemToDof</a>(*l2_fes_));</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a2995e0eb2a01de41b2c9de1a6e58ba31">agg_l2dof</a>[level].Reset(<a class="code" href="namespacemfem.html#a2e66df64396d3a16eea7b2623380f51b">Mult</a>(agg_el, el_l2dof_[level+1]));</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> bdr_tdofs;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   hdiv_fes_-&gt;GetEssentialTrueDofs(all_bdr_attr_, bdr_tdofs);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keyword">auto</span> tmp = <a class="code" href="div__free__solver_8cpp.html#ade939524a52cca9c3527fd74e9961fda">AggToInteriorDof</a>(bdr_tdofs, agg_el, <a class="code" href="div__free__solver_8cpp.html#ab2735d067d4901b29904b007ea1afed0">ElemToDof</a>(*hdiv_fes_),</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                               *hdiv_fes_-&gt;Dof_TrueDof_Matrix(), agg_starts);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ade694bd867d944826c2218207f456694">agg_hdivdof</a>[level].Reset(tmp);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1DFSSpaces.html#a2edf45bbd3def98585932e3b9c4945d4">  150</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1blocksolvers_1_1DFSSpaces.html#a2edf45bbd3def98585932e3b9c4945d4">DFSSpaces::CollectDFSData</a>()</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keyword">auto</span> GetP = [<span class="keyword">this</span>](<a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a>&amp; P, unique_ptr&lt;ParFiniteElementSpace&gt;&amp; cfes,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                      <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>&amp; fes, <span class="keywordtype">bool</span> remove_zero)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      fes.Update();</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      fes.GetTrueTransferOperator(*cfes, P);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">if</span> (remove_zero)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;         P.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;DropSmallEntries(1e-16);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      (level_ &lt; (int)data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>.size()-1) ? cfes-&gt;Update() : cfes.reset();</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   };</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   GetP(data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d5267f1a32c43d783fd84aa315213d2">P_hdiv</a>[level_], coarse_hdiv_fes_, *hdiv_fes_, <span class="keyword">true</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   GetP(data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>[level_], coarse_l2_fes_, *l2_fes_, <span class="keyword">false</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   MakeDofRelationTables(level_);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   GetP(data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a371db30f609920065da1bddfa46bafdf">P_hcurl</a>[level_], coarse_hcurl_fes_, *hcurl_fes_, <span class="keyword">true</span>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> trash1(hcurl_fes_-&gt;GetVSize()), trash2(hdiv_fes_-&gt;GetVSize());</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <a class="code" href="classmfem_1_1ParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a> curl(hcurl_fes_.get(), hdiv_fes_.get());</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   curl.<a class="code" href="classmfem_1_1DiscreteLinearOperator.html#a2d8415910e68d576798a029f8ae88bc1">AddDomainInterpolator</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1CurlInterpolator.html">CurlInterpolator</a>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   curl.Assemble();</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   curl.EliminateTrialDofs(ess_bdr_attr_, trash1, trash2);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   curl.Finalize();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">C</a>[level_+1].Reset(curl.ParallelAssemble());</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   ++level_;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordflow">if</span> (level_ == (<span class="keywordtype">int</span>)data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>.size()) { DataFinalize(); }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">void</span> DFSSpaces::DataFinalize()</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <a class="code" href="classmfem_1_1ParBilinearForm.html">ParBilinearForm</a> mass(l2_fes_.get());</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   mass.<a class="code" href="classmfem_1_1BilinearForm.html#a2ac313b9d213af233e4d9155666bded8">AddDomainIntegrator</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1MassIntegrator.html">MassIntegrator</a>());</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   mass.Assemble();</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   mass.Finalize();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> W(mass.LoseMat());</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a> P_l2;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = (<span class="keywordtype">int</span>)data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>.size()-1; l &gt;= 0; --l)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>[l].As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;GetDiag(P_l2);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> PT_l2(<a class="code" href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">Transpose</a>(P_l2));</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keyword">auto</span> PTW = <a class="code" href="namespacemfem.html#a2e66df64396d3a16eea7b2623380f51b">Mult</a>(*PT_l2.As&lt;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&gt;(), *W.As&lt;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&gt;());</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keyword">auto</span> cW = <a class="code" href="namespacemfem.html#a2e66df64396d3a16eea7b2623380f51b">Mult</a>(*PTW, P_l2);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">auto</span> cW_inv = <span class="keyword">new</span> <a class="code" href="classmfem_1_1blocksolvers_1_1SymDirectSubBlockSolver.html">SymDirectSubBlockSolver</a>(*cW, el_l2dof_[l]);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ab4b1208c465773bf1a17ed54b0eb99e8">Q_l2</a>[l].Reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ProductOperator.html">ProductOperator</a>(cW_inv, PTW, <span class="keyword">true</span>, <span class="keyword">true</span>));</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      W.Reset(cW);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   l2_0_fes_.reset();</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1BBTSolver.html#a0a18a979c7ed1d7cf76680704a18cf6e">  206</a></span>&#160;<a class="code" href="classmfem_1_1blocksolvers_1_1BBTSolver.html#a0a18a979c7ed1d7cf76680704a18cf6e">BBTSolver::BBTSolver</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; B, <a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html">IterSolveParameters</a> param)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   : <a class="code" href="classmfem_1_1Solver.html">Solver</a>(B.NumRows()), BBT_solver_(B.GetComm())</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <a class="code" href="classmfem_1_1OperatorHandle.html">OperatorPtr</a> BT(B.<a class="code" href="classmfem_1_1HypreParMatrix.html#af4b829612c06c355c02e515b4a23f542">Transpose</a>());</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   BBT_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<a class="code" href="namespacemfem.html#aac0ca1f147dff828a18e0c38d1eabf63">ParMult</a>(&amp;B, BT.As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()));</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   BBT_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;CopyColStarts();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   BBT_prec_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1HypreBoomerAMG.html">HypreBoomerAMG</a>(*BBT_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()));</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   BBT_prec_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreBoomerAMG.html">HypreBoomerAMG</a>&gt;()-&gt;SetPrintLevel(0);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <a class="code" href="div__free__solver_8cpp.html#aa0da922baa249048aeaba5672d6c28a7">SetOptions</a>(BBT_solver_, param);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   BBT_solver_.<a class="code" href="classmfem_1_1CGSolver.html#a0fd77af55cdb293ab1cfd8e99e5631fa">SetOperator</a>(*BBT_);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   BBT_solver_.<a class="code" href="classmfem_1_1IterativeSolver.html#a860a3a142ab0904591ef7cfd90471b5b">SetPreconditioner</a>(*BBT_prec_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreBoomerAMG.html">HypreBoomerAMG</a>&gt;());</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1LocalSolver.html#a3e4fd95db3ea34153ca62e1c5af9e738">  221</a></span>&#160;<a class="code" href="classmfem_1_1blocksolvers_1_1LocalSolver.html#a3e4fd95db3ea34153ca62e1c5af9e738">LocalSolver::LocalSolver</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a>&amp; M, <span class="keyword">const</span> <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a>&amp; B)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   : <a class="code" href="classmfem_1_1Solver.html">Solver</a>(M.NumRows()+B.NumRows()), local_system_(height), offset_(M.NumRows())</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   local_system_.<a class="code" href="classmfem_1_1DenseMatrix.html#ab94228a1bb74f1611a94c203f2a732c6">CopyMN</a>(M, 0, 0);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   local_system_.<a class="code" href="classmfem_1_1DenseMatrix.html#ab94228a1bb74f1611a94c203f2a732c6">CopyMN</a>(B, offset_, 0);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   local_system_.<a class="code" href="classmfem_1_1DenseMatrix.html#a78fe035aa201b6f3f25fce772f425f17">CopyMNt</a>(B, 0, offset_);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   local_system_.<a class="code" href="classmfem_1_1DenseMatrix.html#ab13ca5b1261245ed7de93e1c90ad7f15">SetRow</a>(offset_, 0.0);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   local_system_.<a class="code" href="classmfem_1_1DenseMatrix.html#a5e56d16a096246c38e83c092934082f0">SetCol</a>(offset_, 0.0);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   local_system_(offset_, offset_) = -1.0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   local_solver_.<a class="code" href="classmfem_1_1DenseMatrixInverse.html#adeaa668ba0ae73a3dc2db6f493c8f443">SetOperator</a>(local_system_);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1LocalSolver.html#abf87846f23c05707e4eb057cea4beb08">  234</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1blocksolvers_1_1LocalSolver.html#abf87846f23c05707e4eb057cea4beb08">LocalSolver::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;y)<span class="keyword"> const</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> x0 = x[offset_];</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp;<span class="keyword">&gt;</span>(x)[offset_] = 0.0;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   y.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(local_system_.<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>());</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   local_solver_.<a class="code" href="classmfem_1_1DenseMatrixInverse.html#a6831cfd087e1150daaef0048596253fb">Mult</a>(x, y);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp;<span class="keyword">&gt;</span>(x)[offset_] = x0;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html#a8b73bfeeba73f7947acb1155811970a8">  245</a></span>&#160;<a class="code" href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html#a8b73bfeeba73f7947acb1155811970a8">SaddleSchwarzSmoother::SaddleSchwarzSmoother</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; M,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; B,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; agg_hdivdof,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; agg_l2dof,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; P_l2,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; Q_l2)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   : <a class="code" href="classmfem_1_1Solver.html">Solver</a>(M.NumRows() + B.NumRows()), agg_hdivdof_(agg_hdivdof),</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;     agg_l2dof_(agg_l2dof), solvers_loc_(agg_l2dof.NumRows())</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;{</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   coarse_l2_projector_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1ProductOperator.html">ProductOperator</a>(&amp;P_l2, &amp;Q_l2, <span class="keyword">false</span>, <span class="keyword">false</span>));</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   offsets_loc_.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3, 0);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   offsets_.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3, 0);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   offsets_[1] = M.<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   offsets_[2] = M.<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>() + B.<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>();</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a> M_diag, B_diag;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   M.<a class="code" href="classmfem_1_1HypreParMatrix.html#a518458f221fe334d78a0393d9b535199">GetDiag</a>(M_diag);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   B.<a class="code" href="classmfem_1_1HypreParMatrix.html#a518458f221fe334d78a0393d9b535199">GetDiag</a>(B_diag);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> B_loc, M_loc;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> agg = 0; agg &lt; (int)solvers_loc_.size(); agg++)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="div__free__solver_8cpp.html#a05444ce25fd061bd9145b44ca26b216a">GetRowColumnsRef</a>(agg_hdivdof_, agg, hdivdofs_loc_);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="div__free__solver_8cpp.html#a05444ce25fd061bd9145b44ca26b216a">GetRowColumnsRef</a>(agg_l2dof_, agg, l2dofs_loc_);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      M_loc.<a class="code" href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">SetSize</a>(hdivdofs_loc_.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(), hdivdofs_loc_.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      B_loc.<a class="code" href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">SetSize</a>(l2dofs_loc_.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(), hdivdofs_loc_.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      M_diag.<a class="code" href="classmfem_1_1SparseMatrix.html#a293733a824d904ec571e8a8d462f8b7b">GetSubMatrix</a>(hdivdofs_loc_, hdivdofs_loc_, M_loc);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      B_diag.<a class="code" href="classmfem_1_1SparseMatrix.html#a293733a824d904ec571e8a8d462f8b7b">GetSubMatrix</a>(l2dofs_loc_, hdivdofs_loc_, B_loc);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      solvers_loc_[agg].Reset(<span class="keyword">new</span> <a class="code" href="classmfem_1_1blocksolvers_1_1LocalSolver.html">LocalSolver</a>(M_loc, B_loc));</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html#a803ab31d99bc1fc5b2ec63406a84eef3">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html#a803ab31d99bc1fc5b2ec63406a84eef3">SaddleSchwarzSmoother::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp; x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp; y)<span class="keyword"> const</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   y.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(offsets_[2]);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   y = 0.0;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <a class="code" href="classmfem_1_1BlockVector.html">BlockVector</a> blk_y(y.<a class="code" href="classmfem_1_1Vector.html#aee4a1c4326df943c398b401cd58ea3eb">GetData</a>(), offsets_);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <a class="code" href="classmfem_1_1BlockVector.html">BlockVector</a> Pi_x(offsets_); <span class="comment">// aggregate-wise average free projection of x</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="keyword">static_cast&lt;</span><a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp;<span class="keyword">&gt;</span>(Pi_x) = x;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   <span class="comment">// Right hand side: F_l = F - W_l P_l2[l] (W_{l+1})^{-1} P_l2[l]^T F</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="comment">// This ensures the existence of solutions to the local problems</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> coarse_l2_projection(Pi_x.BlockSize(1));</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   coarse_l2_projector_-&gt;<a class="code" href="classmfem_1_1Operator.html#af5a0b4cc0ea7c32d3a267a30e8500ee0">MultTranspose</a>(Pi_x.GetBlock(1), coarse_l2_projection);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   Pi_x.GetBlock(1) -= coarse_l2_projection;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> agg = 0; agg &lt; (int)solvers_loc_.size(); agg++)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <a class="code" href="div__free__solver_8cpp.html#a05444ce25fd061bd9145b44ca26b216a">GetRowColumnsRef</a>(agg_hdivdof_, agg, hdivdofs_loc_);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <a class="code" href="div__free__solver_8cpp.html#a05444ce25fd061bd9145b44ca26b216a">GetRowColumnsRef</a>(agg_l2dof_, agg, l2dofs_loc_);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      offsets_loc_[1] = hdivdofs_loc_.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      offsets_loc_[2] = offsets_loc_[1]+l2dofs_loc_.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <a class="code" href="classmfem_1_1BlockVector.html">BlockVector</a> rhs_loc(offsets_loc_), sol_loc(offsets_loc_);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      Pi_x.GetBlock(0).GetSubVector(hdivdofs_loc_, rhs_loc.GetBlock(0));</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      Pi_x.GetBlock(1).GetSubVector(l2dofs_loc_, rhs_loc.GetBlock(1));</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      solvers_loc_[agg]-&gt;Mult(rhs_loc, sol_loc);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      blk_y.GetBlock(0).AddElementVector(hdivdofs_loc_, sol_loc.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0));</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      blk_y.GetBlock(1).AddElementVector(l2dofs_loc_, sol_loc.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(1));</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   coarse_l2_projector_-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(blk_y.GetBlock(1), coarse_l2_projection);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   blk_y.GetBlock(1) -= coarse_l2_projection;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html#a04f912b9f1ca67bde8d88246570b7f41">  317</a></span>&#160;<a class="code" href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html#a04f912b9f1ca67bde8d88246570b7f41">BDPMinresSolver::BDPMinresSolver</a>(<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; M, <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; B,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                 <a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html">IterSolveParameters</a> param)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   : <a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html">DarcySolver</a>(M.NumRows(), B.NumRows()), op_(offsets_), prec_(offsets_),</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     BT_(B.<a class="code" href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">Transpose</a>()), solver_(M.GetComm())</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   op_.<a class="code" href="classmfem_1_1BlockOperator.html#afe9b4676b6ae952aab133d1e70b6235c">SetBlock</a>(0,0, &amp;M);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   op_.<a class="code" href="classmfem_1_1BlockOperator.html#afe9b4676b6ae952aab133d1e70b6235c">SetBlock</a>(0,1, BT_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;());</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   op_.<a class="code" href="classmfem_1_1BlockOperator.html#afe9b4676b6ae952aab133d1e70b6235c">SetBlock</a>(1,0, &amp;B);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> Md;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   M.<a class="code" href="classmfem_1_1HypreParMatrix.html#a518458f221fe334d78a0393d9b535199">GetDiag</a>(Md);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   BT_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;InvScaleRows(Md);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   S_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<a class="code" href="namespacemfem.html#aac0ca1f147dff828a18e0c38d1eabf63">ParMult</a>(&amp;B, BT_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()));</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   BT_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()-&gt;ScaleRows(Md);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   prec_.<a class="code" href="classmfem_1_1BlockDiagonalPreconditioner.html#acd9317979590a4e94b432e6f78d046c4">SetDiagonalBlock</a>(0, <span class="keyword">new</span> <a class="code" href="classmfem_1_1HypreDiagScale.html">HypreDiagScale</a>(M));</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   prec_.<a class="code" href="classmfem_1_1BlockDiagonalPreconditioner.html#acd9317979590a4e94b432e6f78d046c4">SetDiagonalBlock</a>(1, <span class="keyword">new</span> <a class="code" href="classmfem_1_1HypreBoomerAMG.html">HypreBoomerAMG</a>(*S_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;()));</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <span class="keyword">static_cast&lt;</span><a class="code" href="classmfem_1_1HypreBoomerAMG.html">HypreBoomerAMG</a>&amp;<span class="keyword">&gt;</span>(prec_.<a class="code" href="classmfem_1_1BlockDiagonalPreconditioner.html#a61b3ad23ff1474e4b18421a76903a39c">GetDiagonalBlock</a>(1)).SetPrintLevel(0);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   prec_.<a class="code" href="classmfem_1_1BlockDiagonalPreconditioner.html#a3d98e00c15148269ac31ce918505c2fb">owns_blocks</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <a class="code" href="div__free__solver_8cpp.html#aa0da922baa249048aeaba5672d6c28a7">SetOptions</a>(solver_, param);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   solver_.<a class="code" href="classmfem_1_1MINRESSolver.html#ac8c7671eb572b0478981cdda9f89bac6">SetOperator</a>(op_);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   solver_.<a class="code" href="classmfem_1_1MINRESSolver.html#ad6ca9fd0fba83eb50dfedc7f3c92aa8f">SetPreconditioner</a>(prec_);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html#a02ec9951c8479d5074dc110799ef8226">  342</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html#a02ec9951c8479d5074dc110799ef8226">BDPMinresSolver::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp; x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp; y)<span class="keyword"> const</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   solver_.<a class="code" href="classmfem_1_1MINRESSolver.html#a7b49ed13721f163bf54b16966acc447e">Mult</a>(x, y);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dof : ess_zero_dofs_) { y[dof] = 0.0; }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a702246323f25670409f8b31d57bffa0f">  348</a></span>&#160;<a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a702246323f25670409f8b31d57bffa0f">DivFreeSolver::DivFreeSolver</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a> &amp;M, <span class="keyword">const</span> <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; B,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                             <span class="keyword">const</span> <a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html">DFSData</a>&amp; data)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   : <a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html">DarcySolver</a>(M.NumRows(), B.NumRows()), data_(data), param_(data.param),</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     BT_(B.<a class="code" href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">Transpose</a>()), BBT_solver_(B, param_.BBT_solve_param),</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;     ops_offsets_(data.P_l2.size()+1), ops_(ops_offsets_.size()),</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     blk_Ps_(ops_.Size()-1), smoothers_(ops_.Size())</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   ops_offsets_.back().MakeRef(<a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html#a92a725bb5aef1520100d68a40326568d">DarcySolver::offsets_</a>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   ops_.Last() = <span class="keyword">new</span> <a class="code" href="classmfem_1_1BlockOperator.html">BlockOperator</a>(ops_offsets_.back());</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   ops_.Last()-&gt;SetBlock(0, 0, const_cast&lt;HypreParMatrix*&gt;(&amp;M));</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   ops_.Last()-&gt;SetBlock(1, 0, const_cast&lt;HypreParMatrix*&gt;(&amp;B));</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   ops_.Last()-&gt;SetBlock(0, 1, BT_.<a class="code" href="classmfem_1_1OperatorHandle.html#a5d7481f32dac1fb44f8a1acb129abb2b">Ptr</a>());</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>.size(); l &gt;= 0; --l)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keyword">auto</span>&amp; M_f = <span class="keyword">static_cast&lt;</span><a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp;<span class="keyword">&gt;</span>(ops_[l]-&gt;GetBlock(0, 0));</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keyword">auto</span>&amp; B_f = <span class="keyword">static_cast&lt;</span><a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp;<span class="keyword">&gt;</span>(ops_[l]-&gt;GetBlock(1, 0));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">if</span> (l == 0)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a> M_f_diag, B_f_diag;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;         M_f.<a class="code" href="classmfem_1_1SparseMatrix.html#a0ac491537e8cbfab11d261cf166cf612">GetDiag</a>(M_f_diag);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         B_f.GetDiag(B_f_diag);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dof : data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d2e5d184cab013170ab2ce17ef98565">coarsest_ess_hdivdofs</a>)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;         {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            M_f_diag.<a class="code" href="classmfem_1_1SparseMatrix.html#a3803b1d1b11d9ea3648d7fcf05af47e2">EliminateRowCol</a>(dof);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            B_f_diag.<a class="code" href="classmfem_1_1SparseMatrix.html#a4c8c9f0e4b03907551e05a5a7f3bf778">EliminateCol</a>(dof);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;         <span class="keyword">const</span> <a class="code" href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html">IterSolveParameters</a>&amp; param = param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a0ee260f913ab9b2960854e746498533b">coarse_solve_param</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;         <span class="keyword">auto</span> coarse_solver = <span class="keyword">new</span> <a class="code" href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html">BDPMinresSolver</a>(M_f, B_f, param);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;         <span class="keywordflow">if</span> (ops_.Size() &gt; 1)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;         {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            coarse_solver-&gt;SetEssZeroDofs(data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d2e5d184cab013170ab2ce17ef98565">coarsest_ess_hdivdofs</a>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;         }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;         smoothers_[l] = coarse_solver;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; P_hdiv_l = *data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d5267f1a32c43d783fd84aa315213d2">P_hdiv</a>[l-1].As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; P_l2_l = *data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>[l-1].As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; agg_hdivdof_l = *data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ade694bd867d944826c2218207f456694">agg_hdivdof</a>[l-1].As&lt;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&gt;();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&amp; agg_l2dof_l = *data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a2995e0eb2a01de41b2c9de1a6e58ba31">agg_l2dof</a>[l-1].As&lt;<a class="code" href="classmfem_1_1SparseMatrix.html">SparseMatrix</a>&gt;();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; Q_l2_l = *data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ab4b1208c465773bf1a17ed54b0eb99e8">Q_l2</a>[l-1].As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>* C_l = data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">C</a>[l].As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keyword">auto</span> S0 = <span class="keyword">new</span> <a class="code" href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html">SaddleSchwarzSmoother</a>(M_f, B_f, agg_hdivdof_l,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                          agg_l2dof_l, P_l2_l, Q_l2_l);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span> (param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a1b5e4f6e97c9e984d97c42db6b38f953">coupled_solve</a>)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;         <span class="keyword">auto</span> S1 = <span class="keyword">new</span> <a class="code" href="classmfem_1_1BlockDiagonalPreconditioner.html">BlockDiagonalPreconditioner</a>(ops_offsets_[l]);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;         S1-&gt;SetDiagonalBlock(0, <span class="keyword">new</span> <a class="code" href="classmfem_1_1AuxSpaceSmoother.html">AuxSpaceSmoother</a>(M_f, C_l));</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         S1-&gt;owns_blocks = <span class="keyword">true</span>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;         smoothers_[l] = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ProductSolver.html">ProductSolver</a>(ops_[l], S0, S1, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;         smoothers_[l] = S0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>* M_c = <a class="code" href="div__free__solver_8cpp.html#a77a3f5dc1bbb79e8f03c51ce63871d9d">TwoStepsRAP</a>(P_hdiv_l, M_f, P_hdiv_l);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>* B_c = <a class="code" href="div__free__solver_8cpp.html#a77a3f5dc1bbb79e8f03c51ce63871d9d">TwoStepsRAP</a>(P_l2_l, B_f, P_hdiv_l);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      ops_offsets_[l-1].SetSize(3, 0);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      ops_offsets_[l-1][1] = M_c-&gt;<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      ops_offsets_[l-1][2] = M_c-&gt;<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>() + B_c-&gt;<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>();</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      blk_Ps_[l-1] = <span class="keyword">new</span> <a class="code" href="classmfem_1_1BlockOperator.html">BlockOperator</a>(ops_offsets_[l], ops_offsets_[l-1]);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      blk_Ps_[l-1]-&gt;SetBlock(0, 0, &amp;P_hdiv_l);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      blk_Ps_[l-1]-&gt;SetBlock(1, 1, &amp;P_l2_l);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      ops_[l-1] = <span class="keyword">new</span> <a class="code" href="classmfem_1_1BlockOperator.html">BlockOperator</a>(ops_offsets_[l-1]);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      ops_[l-1]-&gt;SetBlock(0, 0, M_c);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      ops_[l-1]-&gt;SetBlock(1, 0, B_c);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      ops_[l-1]-&gt;SetBlock(0, 1, B_c-&gt;<a class="code" href="classmfem_1_1HypreParMatrix.html#af4b829612c06c355c02e515b4a23f542">Transpose</a>());</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      ops_[l-1]-&gt;owns_blocks = <span class="keyword">true</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;bool&gt;</a> own_ops(ops_.Size());</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;bool&gt;</a> own_smoothers(smoothers_.Size());</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;bool&gt;</a> own_Ps(blk_Ps_.Size());</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   own_ops = <span class="keyword">true</span>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   own_smoothers = <span class="keyword">true</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   own_Ps = <span class="keyword">true</span>;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">if</span> (data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">P_l2</a>.size() == 0) { <span class="keywordflow">return</span>; }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keywordflow">if</span> (param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a1b5e4f6e97c9e984d97c42db6b38f953">coupled_solve</a>)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      solver_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1GMRESSolver.html">GMRESSolver</a>(B.<a class="code" href="classmfem_1_1HypreParMatrix.html#ab4d1d307b1871dcc880c40dfe56b4571">GetComm</a>()));</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      solver_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1GMRESSolver.html">GMRESSolver</a>&gt;()-&gt;<a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a1e5712899ceed4e8473c633078933ca1">SetOperator</a>(*(ops_.Last()));</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      prec_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Multigrid.html">Multigrid</a>(ops_, smoothers_, blk_Ps_,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                own_ops, own_smoothers, own_Ps));</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;HypreParMatrix*&gt;</a> ops(data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a371db30f609920065da1bddfa46bafdf">P_hcurl</a>.size()+1);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;Solver*&gt;</a> smoothers(ops.Size());</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;HypreParMatrix*&gt;</a> Ps(data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a371db30f609920065da1bddfa46bafdf">P_hcurl</a>.size());</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      own_Ps = <span class="keyword">false</span>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp; C_finest = *data.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">C</a>.back().As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;();</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      ops.Last() = <a class="code" href="div__free__solver_8cpp.html#a77a3f5dc1bbb79e8f03c51ce63871d9d">TwoStepsRAP</a>(C_finest, M, C_finest);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      ops.Last()-&gt;EliminateZeroRows();</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      ops.Last()-&gt;DropSmallEntries(1e-14);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      solver_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1CGSolver.html">CGSolver</a>(B.<a class="code" href="classmfem_1_1HypreParMatrix.html#ab4d1d307b1871dcc880c40dfe56b4571">GetComm</a>()));</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      solver_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1CGSolver.html">CGSolver</a>&gt;()-&gt;<a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a1e5712899ceed4e8473c633078933ca1">SetOperator</a>(*ops.Last());</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      smoothers.Last() = <span class="keyword">new</span> <a class="code" href="classmfem_1_1HypreSmoother.html">HypreSmoother</a>(*ops.Last());</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="classmfem_1_1HypreSmoother.html">HypreSmoother</a>*<span class="keyword">&gt;</span>(smoothers.Last())-&gt;SetOperatorSymmetry(<span class="keyword">true</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = Ps.Size()-1; l &gt;= 0; --l)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;         Ps[l] = data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#a371db30f609920065da1bddfa46bafdf">P_hcurl</a>[l].As&lt;<a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&gt;();</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;         ops[l] = <a class="code" href="div__free__solver_8cpp.html#a77a3f5dc1bbb79e8f03c51ce63871d9d">TwoStepsRAP</a>(*Ps[l], *ops[l+1], *Ps[l]);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;         ops[l]-&gt;<a class="code" href="classmfem_1_1HypreParMatrix.html#a4cc1852638b841200f12781d26cd62be">DropSmallEntries</a>(1e-14);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;         smoothers[l] = <span class="keyword">new</span> <a class="code" href="classmfem_1_1HypreSmoother.html">HypreSmoother</a>(*ops[l]);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;         <span class="keyword">static_cast&lt;</span><a class="code" href="classmfem_1_1HypreSmoother.html">HypreSmoother</a>*<span class="keyword">&gt;</span>(smoothers[l])-&gt;SetOperatorSymmetry(<span class="keyword">true</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      prec_.<a class="code" href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">Reset</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Multigrid.html">Multigrid</a>(ops, smoothers, Ps, own_ops, own_smoothers, own_Ps));</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   solver_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1IterativeSolver.html">IterativeSolver</a>&gt;()-&gt;SetPreconditioner(*prec_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1Solver.html">Solver</a>&gt;());</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <a class="code" href="div__free__solver_8cpp.html#aa0da922baa249048aeaba5672d6c28a7">SetOptions</a>(*solver_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1IterativeSolver.html">IterativeSolver</a>&gt;(), param_);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#ae4bc5802b013513ce813619211d0eec9">  475</a></span>&#160;<a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#ae4bc5802b013513ce813619211d0eec9">DivFreeSolver::~DivFreeSolver</a>()</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <span class="keywordflow">if</span> (param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a1b5e4f6e97c9e984d97c42db6b38f953">coupled_solve</a>) { <span class="keywordflow">return</span>; }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ops_.Size(); ++i)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keyword">delete</span> ops_[i];</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keyword">delete</span> smoothers_[i];</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">if</span> (i == ops_.Size() - 1) { <span class="keywordflow">break</span>; }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keyword">delete</span> blk_Ps_[i];</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keywordtype">void</span> DivFreeSolver::SolveParticular(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp; rhs, <a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp; sol)<span class="keyword"> const</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   std::vector&lt;Vector&gt; rhss(smoothers_.Size());</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   std::vector&lt;Vector&gt; sols(smoothers_.Size());</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   rhss.back().SetDataAndSize(const_cast&lt;double*&gt;(rhs.<a class="code" href="classmfem_1_1Vector.html#ab93e53490b5cc7a8c39eed008ce889bd">HostRead</a>()), rhs.<a class="code" href="classmfem_1_1Vector.html#aa9c5be6e53d0993d5851c276ba2a6079">Size</a>());</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   sols.back().SetDataAndSize(sol.<a class="code" href="classmfem_1_1Vector.html#a4483f06f5cbc408f6c8021e68fc0cfab">HostWrite</a>(), sol.<a class="code" href="classmfem_1_1Vector.html#aa9c5be6e53d0993d5851c276ba2a6079">Size</a>());</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = blk_Ps_.Size()-1; l &gt;= 0; --l)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      rhss[l].SetSize(blk_Ps_[l]-&gt;<a class="code" href="classmfem_1_1Operator.html#a7e7e6e0ce7d3bd928c8f17d895ca2742">NumCols</a>());</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      sols[l].SetSize(blk_Ps_[l]-&gt;<a class="code" href="classmfem_1_1Operator.html#a7e7e6e0ce7d3bd928c8f17d895ca2742">NumCols</a>());</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      sols[l] = 0.0;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      rhss[l] = 0.0;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      blk_Ps_[l]-&gt;MultTranspose(rhss[l+1], rhss[l]);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; smoothers_.Size(); ++l)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      smoothers_[l]-&gt;Mult(rhss[l], sols[l]);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; blk_Ps_.Size(); ++l)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <a class="code" href="classmfem_1_1Vector.html">Vector</a> P_sol(blk_Ps_[l]-&gt;<a class="code" href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">NumRows</a>());</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      blk_Ps_[l]-&gt;Mult(sols[l], P_sol);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      sols[l+1] += P_sol;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="keywordtype">void</span> DivFreeSolver::SolveDivFree(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;rhs, <a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp; sol)<span class="keyword"> const</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> rhs_divfree(data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">C</a>.back()-&gt;NumCols());</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">C</a>.back()-&gt;MultTranspose(rhs, rhs_divfree);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> potential_divfree(rhs_divfree.Size());</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   potential_divfree = 0.0;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   solver_-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(rhs_divfree, potential_divfree);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   data_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">C</a>.back()-&gt;Mult(potential_divfree, sol);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keywordtype">void</span> DivFreeSolver::SolvePotential(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp; rhs, <a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp; sol)<span class="keyword"> const</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> rhs_p(BT_-&gt;<a class="code" href="classmfem_1_1Operator.html#a7e7e6e0ce7d3bd928c8f17d895ca2742">NumCols</a>());</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   BT_-&gt;<a class="code" href="classmfem_1_1Operator.html#af5a0b4cc0ea7c32d3a267a30e8500ee0">MultTranspose</a>(rhs, rhs_p);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   BBT_solver_.<a class="code" href="classmfem_1_1blocksolvers_1_1BBTSolver.html#adeba8aa8b4eccfe2d8abdd803b48e59a">Mult</a>(rhs_p, sol);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;}</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#ac073466e34190be49f1117ba1aa6e844">  538</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#ac073466e34190be49f1117ba1aa6e844">DivFreeSolver::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp; x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp; y)<span class="keyword"> const</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   MFEM_VERIFY(x.<a class="code" href="classmfem_1_1Vector.html#aa9c5be6e53d0993d5851c276ba2a6079">Size</a>() == <a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html#a92a725bb5aef1520100d68a40326568d">offsets_</a>[2], <span class="stringliteral">&quot;MLDivFreeSolver: x size is invalid&quot;</span>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   MFEM_VERIFY(y.<a class="code" href="classmfem_1_1Vector.html#aa9c5be6e53d0993d5851c276ba2a6079">Size</a>() == <a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html#a92a725bb5aef1520100d68a40326568d">offsets_</a>[2], <span class="stringliteral">&quot;MLDivFreeSolver: y size is invalid&quot;</span>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <span class="keywordflow">if</span> (ops_.Size() == 1) { smoothers_[0]-&gt;Mult(x, y); <span class="keywordflow">return</span>; }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <a class="code" href="classmfem_1_1BlockVector.html">BlockVector</a> blk_y(y, <a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html#a92a725bb5aef1520100d68a40326568d">offsets_</a>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="classmfem_1_1BlockVector.html">BlockVector</a> resid(<a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html#a92a725bb5aef1520100d68a40326568d">offsets_</a>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   ops_.Last()-&gt;Mult(y, resid);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <a class="code" href="namespacemfem.html#a480ada169fcfa4214d92548e77737f3a">add</a>(1.0, x, -1.0, resid, resid);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <a class="code" href="classmfem_1_1BlockVector.html">BlockVector</a> correction(<a class="code" href="classmfem_1_1blocksolvers_1_1DarcySolver.html#a92a725bb5aef1520100d68a40326568d">offsets_</a>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   correction = 0.0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordflow">if</span> (param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a1b5e4f6e97c9e984d97c42db6b38f953">coupled_solve</a>)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      solver_-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(resid, correction);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      y += correction;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="classmfem_1_1StopWatch.html">StopWatch</a> ch;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      ch.<a class="code" href="classmfem_1_1StopWatch.html#a6ff604f4c8b2ea33b323827486ca082f">Start</a>();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      SolveParticular(resid, correction);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      blk_y += correction;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">if</span> (param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a3474d081f854c015dcb84b9f3ef548e4">verbose</a>)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Particular solution found in &quot;</span> &lt;&lt; ch.<a class="code" href="classmfem_1_1StopWatch.html#a1aac7642b6cefb1357f7c19ad4c9e514">RealTime</a>() &lt;&lt; <span class="stringliteral">&quot;s.\n&quot;</span>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      ch.<a class="code" href="classmfem_1_1StopWatch.html#ae272e3b952c266c4b873e4f85dac9f85">Clear</a>();</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      ch.<a class="code" href="classmfem_1_1StopWatch.html#a6ff604f4c8b2ea33b323827486ca082f">Start</a>();</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      ops_.Last()-&gt;Mult(y, resid);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="namespacemfem.html#a480ada169fcfa4214d92548e77737f3a">add</a>(1.0, x, -1.0, resid, resid);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      SolveDivFree(resid.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0), correction.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0));</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      blk_y.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0) += correction.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">if</span> (param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a3474d081f854c015dcb84b9f3ef548e4">verbose</a>)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Divergence free solution found in &quot;</span> &lt;&lt; ch.<a class="code" href="classmfem_1_1StopWatch.html#a1aac7642b6cefb1357f7c19ad4c9e514">RealTime</a>() &lt;&lt; <span class="stringliteral">&quot;s.\n&quot;</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      ch.<a class="code" href="classmfem_1_1StopWatch.html#ae272e3b952c266c4b873e4f85dac9f85">Clear</a>();</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      ch.<a class="code" href="classmfem_1_1StopWatch.html#a6ff604f4c8b2ea33b323827486ca082f">Start</a>();</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keyword">auto</span> M = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1HypreParMatrix.html">HypreParMatrix</a>&amp;<span class="keyword">&gt;</span>(ops_.Last()-&gt;GetBlock(0, 0));</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      M.<a class="code" href="classmfem_1_1HypreParMatrix.html#ac8002a6739728dd513e0d1887bc2f8a7">Mult</a>(-1.0, correction.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0), 1.0, resid.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0));</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      SolvePotential(resid.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(0), correction.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(1));</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      blk_y.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(1) += correction.<a class="code" href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">GetBlock</a>(1);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">if</span> (param_.<a class="code" href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a3474d081f854c015dcb84b9f3ef548e4">verbose</a>)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Scalar potential found in &quot;</span> &lt;&lt; ch.<a class="code" href="classmfem_1_1StopWatch.html#a1aac7642b6cefb1357f7c19ad4c9e514">RealTime</a>() &lt;&lt; <span class="stringliteral">&quot;s.\n&quot;</span>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;}</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a4f8093cc23562dfbb6f7735c22f85827">  601</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a4f8093cc23562dfbb6f7735c22f85827">DivFreeSolver::GetNumIterations</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   <span class="keywordflow">if</span> (ops_.Size() == 1)</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html">BDPMinresSolver</a>*<span class="keyword">&gt;</span>(smoothers_[0])-&gt;<a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a4f8093cc23562dfbb6f7735c22f85827">GetNumIterations</a>();</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keywordflow">return</span> solver_.<a class="code" href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">As</a>&lt;<a class="code" href="classmfem_1_1IterativeSolver.html">IterativeSolver</a>&gt;()-&gt;<a class="code" href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a4f8093cc23562dfbb6f7735c22f85827">GetNumIterations</a>();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div><div class="ttc" id="classmfem_1_1Operator_html_af5a0b4cc0ea7c32d3a267a30e8500ee0"><div class="ttname"><a href="classmfem_1_1Operator.html#af5a0b4cc0ea7c32d3a267a30e8500ee0">mfem::Operator::MultTranspose</a></div><div class="ttdeci">virtual void MultTranspose(const Vector &amp;x, Vector &amp;y) const</div><div class="ttdoc">Action of the transpose operator: y=A^t(x). The default behavior in class Operator is to generate an ...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00093">operator.hpp:93</a></div></div>
<div class="ttc" id="classmfem_1_1Multigrid_html"><div class="ttname"><a href="classmfem_1_1Multigrid.html">mfem::Multigrid</a></div><div class="ttdoc">Multigrid solver class. </div><div class="ttdef"><b>Definition:</b> <a href="multigrid_8hpp_source.html#l00135">multigrid.hpp:135</a></div></div>
<div class="ttc" id="classmfem_1_1CGSolver_html"><div class="ttname"><a href="classmfem_1_1CGSolver.html">mfem::CGSolver</a></div><div class="ttdoc">Conjugate gradient method. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00493">solvers.hpp:493</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a2649ebd417db36c5c29371e59bbd65fa"><div class="ttname"><a href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">mfem::Table::GetJ</a></div><div class="ttdeci">int * GetJ()</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00114">table.hpp:114</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother_html_a803ab31d99bc1fc5b2ec63406a84eef3"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html#a803ab31d99bc1fc5b2ec63406a84eef3">mfem::blocksolvers::SaddleSchwarzSmoother::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const</div><div class="ttdoc">Operator application: y=A(x). </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00279">div_free_solver.cpp:279</a></div></div>
<div class="ttc" id="classmfem_1_1SparseMatrix_html_a4c8c9f0e4b03907551e05a5a7f3bf778"><div class="ttname"><a href="classmfem_1_1SparseMatrix.html#a4c8c9f0e4b03907551e05a5a7f3bf778">mfem::SparseMatrix::EliminateCol</a></div><div class="ttdeci">void EliminateCol(int col, DiagonalPolicy dpolicy=DIAG_ZERO)</div><div class="ttdoc">Eliminates the column col from the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="sparsemat_8cpp_source.html#l01741">sparsemat.cpp:1741</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_a5e56d16a096246c38e83c092934082f0"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#a5e56d16a096246c38e83c092934082f0">mfem::DenseMatrix::SetCol</a></div><div class="ttdeci">void SetCol(int c, const double *col)</div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l02193">densemat.cpp:2193</a></div></div>
<div class="ttc" id="classmfem_1_1SparseMatrix_html_a0ac491537e8cbfab11d261cf166cf612"><div class="ttname"><a href="classmfem_1_1SparseMatrix.html#a0ac491537e8cbfab11d261cf166cf612">mfem::SparseMatrix::GetDiag</a></div><div class="ttdeci">void GetDiag(Vector &amp;d) const</div><div class="ttdoc">Returns the Diagonal of A. </div><div class="ttdef"><b>Definition:</b> <a href="sparsemat_8cpp_source.html#l00669">sparsemat.cpp:669</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DivFreeSolver_html_ae4bc5802b013513ce813619211d0eec9"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#ae4bc5802b013513ce813619211d0eec9">mfem::blocksolvers::DivFreeSolver::~DivFreeSolver</a></div><div class="ttdeci">~DivFreeSolver()</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00475">div_free_solver.cpp:475</a></div></div>
<div class="ttc" id="classmfem_1_1BlockVector_html"><div class="ttname"><a href="classmfem_1_1BlockVector.html">mfem::BlockVector</a></div><div class="ttdoc">A class to handle Vectors in a block fashion. </div><div class="ttdef"><b>Definition:</b> <a href="blockvector_8hpp_source.html#l00030">blockvector.hpp:30</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_ab13ca5b1261245ed7de93e1c90ad7f15"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#ab13ca5b1261245ed7de93e1c90ad7f15">mfem::DenseMatrix::SetRow</a></div><div class="ttdeci">void SetRow(int r, const double *row)</div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l02178">densemat.cpp:2178</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DivFreeSolver_html_a702246323f25670409f8b31d57bffa0f"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a702246323f25670409f8b31d57bffa0f">mfem::blocksolvers::DivFreeSolver::DivFreeSolver</a></div><div class="ttdeci">DivFreeSolver(const HypreParMatrix &amp;M, const HypreParMatrix &amp;B, const DFSData &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00348">div_free_solver.cpp:348</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6875d857942c66cb8cea1159337b807a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6875d857942c66cb8cea1159337b807a">mfem::Mesh::Dimension</a></div><div class="ttdeci">int Dimension() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01047">mesh.hpp:1047</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrixInverse_html_a6831cfd087e1150daaef0048596253fb"><div class="ttname"><a href="classmfem_1_1DenseMatrixInverse.html#a6831cfd087e1150daaef0048596253fb">mfem::DenseMatrixInverse::Mult</a></div><div class="ttdeci">void Mult(const double *x, double *y) const</div><div class="ttdoc">Matrix vector multiplication with the inverse of dense matrix. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l03963">densemat.cpp:3963</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_ac1e67bd3ee82db59573950d19897c149"><div class="ttname"><a href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">mfem::Vector::SetSize</a></div><div class="ttdeci">void SetSize(int s)</div><div class="ttdoc">Resize the vector to size s. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00512">vector.hpp:512</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_ab93e53490b5cc7a8c39eed008ce889bd"><div class="ttname"><a href="classmfem_1_1Vector.html#ab93e53490b5cc7a8c39eed008ce889bd">mfem::Vector::HostRead</a></div><div class="ttdeci">virtual const double * HostRead() const</div><div class="ttdoc">Shortcut for mfem::Read(vec.GetMemory(), vec.Size(), false). </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00452">vector.hpp:452</a></div></div>
<div class="ttc" id="classmfem_1_1SparseMatrix_html_a93c5050b0b98e26b82f9a205c7253273"><div class="ttname"><a href="classmfem_1_1SparseMatrix.html#a93c5050b0b98e26b82f9a205c7253273">mfem::SparseMatrix::GetRowColumns</a></div><div class="ttdeci">int * GetRowColumns(const int row)</div><div class="ttdoc">Return a pointer to the column indices in a row. </div><div class="ttdef"><b>Definition:</b> <a href="sparsemat_8cpp_source.html#l00391">sparsemat.cpp:391</a></div></div>
<div class="ttc" id="classmfem_1_1SparseMatrix_html_a97386d280f2a41b36161aec5a6748cf4"><div class="ttname"><a href="classmfem_1_1SparseMatrix.html#a97386d280f2a41b36161aec5a6748cf4">mfem::SparseMatrix::RowSize</a></div><div class="ttdeci">int RowSize(const int i) const</div><div class="ttdoc">Returns the number of elements in row i. </div><div class="ttdef"><b>Definition:</b> <a href="sparsemat_8cpp_source.html#l00344">sparsemat.cpp:344</a></div></div>
<div class="ttc" id="namespacemfem_html_a2e66df64396d3a16eea7b2623380f51b"><div class="ttname"><a href="namespacemfem.html#a2e66df64396d3a16eea7b2623380f51b">mfem::Mult</a></div><div class="ttdeci">void Mult(const Table &amp;A, const Table &amp;B, Table &amp;C)</div><div class="ttdoc">C = A * B (as boolean matrices) </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00475">table.cpp:475</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_ab4b1208c465773bf1a17ed54b0eb99e8"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#ab4b1208c465773bf1a17ed54b0eb99e8">mfem::blocksolvers::DFSData::Q_l2</a></div><div class="ttdeci">std::vector&lt; OperatorPtr &gt; Q_l2</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00055">div_free_solver.hpp:55</a></div></div>
<div class="ttc" id="classmfem_1_1OperatorHandle_html"><div class="ttname"><a href="classmfem_1_1OperatorHandle.html">mfem::OperatorHandle</a></div><div class="ttdoc">Pointer to an Operator of a specified type. </div><div class="ttdef"><b>Definition:</b> <a href="handle_8hpp_source.html#l00033">handle.hpp:33</a></div></div>
<div class="ttc" id="classmfem_1_1MINRESSolver_html_a7b49ed13721f163bf54b16966acc447e"><div class="ttname"><a href="classmfem_1_1MINRESSolver.html#a7b49ed13721f163bf54b16966acc447e">mfem::MINRESSolver::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;b, Vector &amp;x) const</div><div class="ttdoc">Operator application: y=A(x). </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8cpp_source.html#l01612">solvers.cpp:1612</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DarcySolver_html_a92a725bb5aef1520100d68a40326568d"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DarcySolver.html#a92a725bb5aef1520100d68a40326568d">mfem::blocksolvers::DarcySolver::offsets_</a></div><div class="ttdeci">Array&lt; int &gt; offsets_</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00106">div_free_solver.hpp:106</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1">mfem::Element::TETRAHEDRON</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00042">element.hpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DarcySolver_html"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DarcySolver.html">mfem::blocksolvers::DarcySolver</a></div><div class="ttdoc">Abstract solver class for Darcy&amp;#39;s flow. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00103">div_free_solver.hpp:103</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1BDPMinresSolver_html_a02ec9951c8479d5074dc110799ef8226"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html#a02ec9951c8479d5074dc110799ef8226">mfem::blocksolvers::BDPMinresSolver::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const</div><div class="ttdoc">Operator application: y=A(x). </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00342">div_free_solver.cpp:342</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_a4d2e5d184cab013170ab2ce17ef98565"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d2e5d184cab013170ab2ce17ef98565">mfem::blocksolvers::DFSData::coarsest_ess_hdivdofs</a></div><div class="ttdeci">Array&lt; int &gt; coarsest_ess_hdivdofs</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00056">div_free_solver.hpp:56</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1IterSolveParameters_html_a401a50aa6a65361a4e5a20a632909076"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#a401a50aa6a65361a4e5a20a632909076">mfem::blocksolvers::IterSolveParameters::print_level</a></div><div class="ttdeci">int print_level</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00027">div_free_solver.hpp:27</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_aa9c5be6e53d0993d5851c276ba2a6079"><div class="ttname"><a href="classmfem_1_1Vector.html#aa9c5be6e53d0993d5851c276ba2a6079">mfem::Vector::Size</a></div><div class="ttdeci">int Size() const</div><div class="ttdoc">Returns the size of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00199">vector.hpp:199</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html">mfem::DenseMatrix</a></div><div class="ttdoc">Data type dense matrix using column-major storage. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8hpp_source.html#l00023">densemat.hpp:23</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_a4483f06f5cbc408f6c8021e68fc0cfab"><div class="ttname"><a href="classmfem_1_1Vector.html#a4483f06f5cbc408f6c8021e68fc0cfab">mfem::Vector::HostWrite</a></div><div class="ttdeci">virtual double * HostWrite()</div><div class="ttdoc">Shortcut for mfem::Write(vec.GetMemory(), vec.Size(), false). </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00460">vector.hpp:460</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DFSSpaces_html_a2edf45bbd3def98585932e3b9c4945d4"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DFSSpaces.html#a2edf45bbd3def98585932e3b9c4945d4">mfem::blocksolvers::DFSSpaces::CollectDFSData</a></div><div class="ttdeci">void CollectDFSData()</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00150">div_free_solver.cpp:150</a></div></div>
<div class="ttc" id="classmfem_1_1CurlInterpolator_html"><div class="ttname"><a href="classmfem_1_1CurlInterpolator.html">mfem::CurlInterpolator</a></div><div class="ttdef"><b>Definition:</b> <a href="bilininteg_8hpp_source.html#l03383">bilininteg.hpp:3383</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_ade258863b7f724756a74de438052f0ce"><div class="ttname"><a href="classmfem_1_1Operator.html#ade258863b7f724756a74de438052f0ce">mfem::Operator::NumRows</a></div><div class="ttdeci">int NumRows() const</div><div class="ttdoc">Get the number of rows (size of output) of the Operator. Synonym with Height(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00069">operator.hpp:69</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a700c3008b5ab43155cdfd279c8360472"><div class="ttname"><a href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">mfem::Operator::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const =0</div><div class="ttdoc">Operator application: y=A(x). </div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aac0ecfa0737785cb713cb30b81bdf591"><div class="ttname"><a href="classmfem_1_1Mesh.html#aac0ecfa0737785cb713cb30b81bdf591">mfem::Mesh::GetElement</a></div><div class="ttdeci">const Element * GetElement(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01081">mesh.hpp:1081</a></div></div>
<div class="ttc" id="classmfem_1_1StopWatch_html_a1aac7642b6cefb1357f7c19ad4c9e514"><div class="ttname"><a href="classmfem_1_1StopWatch.html#a1aac7642b6cefb1357f7c19ad4c9e514">mfem::StopWatch::RealTime</a></div><div class="ttdeci">double RealTime()</div><div class="ttdef"><b>Definition:</b> <a href="tic__toc_8cpp_source.html#l00426">tic_toc.cpp:426</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html">mfem::ParFiniteElementSpace</a></div><div class="ttdoc">Abstract parallel finite element space. </div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8hpp_source.html#l00028">pfespace.hpp:28</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother_html_a8b73bfeeba73f7947acb1155811970a8"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html#a8b73bfeeba73f7947acb1155811970a8">mfem::blocksolvers::SaddleSchwarzSmoother::SaddleSchwarzSmoother</a></div><div class="ttdeci">SaddleSchwarzSmoother(const HypreParMatrix &amp;M, const HypreParMatrix &amp;B, const SparseMatrix &amp;agg_hdivdof, const SparseMatrix &amp;agg_l2dof, const HypreParMatrix &amp;P_l2, const HypreParMatrix &amp;Q_l2)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00245">div_free_solver.cpp:245</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_a371db30f609920065da1bddfa46bafdf"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#a371db30f609920065da1bddfa46bafdf">mfem::blocksolvers::DFSData::P_hcurl</a></div><div class="ttdeci">std::vector&lt; OperatorPtr &gt; P_hcurl</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00054">div_free_solver.hpp:54</a></div></div>
<div class="ttc" id="classmfem_1_1SparseMatrix_html_a293733a824d904ec571e8a8d462f8b7b"><div class="ttname"><a href="classmfem_1_1SparseMatrix.html#a293733a824d904ec571e8a8d462f8b7b">mfem::SparseMatrix::GetSubMatrix</a></div><div class="ttdeci">void GetSubMatrix(const Array&lt; int &gt; &amp;rows, const Array&lt; int &gt; &amp;cols, DenseMatrix &amp;subm) const</div><div class="ttdef"><b>Definition:</b> <a href="sparsemat_8cpp_source.html#l02886">sparsemat.cpp:2886</a></div></div>
<div class="ttc" id="namespacemfem_html_aac0ca1f147dff828a18e0c38d1eabf63"><div class="ttname"><a href="namespacemfem.html#aac0ca1f147dff828a18e0c38d1eabf63">mfem::ParMult</a></div><div class="ttdeci">HypreParMatrix * ParMult(const HypreParMatrix *A, const HypreParMatrix *B, bool own_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="hypre_8cpp_source.html#l02850">hypre.cpp:2850</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DivFreeSolver_html_ac073466e34190be49f1117ba1aa6e844"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#ac073466e34190be49f1117ba1aa6e844">mfem::blocksolvers::DivFreeSolver::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const</div><div class="ttdoc">Operator application: y=A(x). </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00538">div_free_solver.cpp:538</a></div></div>
<div class="ttc" id="namespacemfem_html_a480ada169fcfa4214d92548e77737f3a"><div class="ttname"><a href="namespacemfem.html#a480ada169fcfa4214d92548e77737f3a">mfem::add</a></div><div class="ttdeci">void add(const Vector &amp;v1, const Vector &amp;v2, Vector &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8cpp_source.html#l00314">vector.cpp:314</a></div></div>
<div class="ttc" id="classmfem_1_1DiscreteLinearOperator_html_a2d8415910e68d576798a029f8ae88bc1"><div class="ttname"><a href="classmfem_1_1DiscreteLinearOperator.html#a2d8415910e68d576798a029f8ae88bc1">mfem::DiscreteLinearOperator::AddDomainInterpolator</a></div><div class="ttdeci">void AddDomainInterpolator(DiscreteInterpolator *di)</div><div class="ttdoc">Adds a domain interpolator. Assumes ownership of di. </div><div class="ttdef"><b>Definition:</b> <a href="bilinearform_8hpp_source.html#l01060">bilinearform.hpp:1060</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSParameters_html_a0ee260f913ab9b2960854e746498533b"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a0ee260f913ab9b2960854e746498533b">mfem::blocksolvers::DFSParameters::coarse_solve_param</a></div><div class="ttdeci">IterSolveParameters coarse_solve_param</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00043">div_free_solver.hpp:43</a></div></div>
<div class="ttc" id="classmfem_1_1ProductSolver_html"><div class="ttname"><a href="classmfem_1_1ProductSolver.html">mfem::ProductSolver</a></div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l01142">solvers.hpp:1142</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1LocalSolver_html_a3e4fd95db3ea34153ca62e1c5af9e738"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1LocalSolver.html#a3e4fd95db3ea34153ca62e1c5af9e738">mfem::blocksolvers::LocalSolver::LocalSolver</a></div><div class="ttdeci">LocalSolver(const DenseMatrix &amp;M, const DenseMatrix &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00221">div_free_solver.cpp:221</a></div></div>
<div class="ttc" id="classmfem_1_1BlockDiagonalPreconditioner_html_a61b3ad23ff1474e4b18421a76903a39c"><div class="ttname"><a href="classmfem_1_1BlockDiagonalPreconditioner.html#a61b3ad23ff1474e4b18421a76903a39c">mfem::BlockDiagonalPreconditioner::GetDiagonalBlock</a></div><div class="ttdeci">Operator &amp; GetDiagonalBlock(int iblock)</div><div class="ttdoc">Return a reference to block i,i. </div><div class="ttdef"><b>Definition:</b> <a href="blockoperator_8hpp_source.html#l00168">blockoperator.hpp:168</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_aaa033bcf10ca8783218f5d98d8c54288a1149a94d7b60f7432d9106f29bea24ac"><div class="ttname"><a href="classmfem_1_1Operator.html#aaa033bcf10ca8783218f5d98d8c54288a1149a94d7b60f7432d9106f29bea24ac">mfem::Operator::MFEM_SPARSEMAT</a></div><div class="ttdoc">ID for class SparseMatrix. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00286">operator.hpp:286</a></div></div>
<div class="ttc" id="classmfem_1_1HypreBoomerAMG_html"><div class="ttname"><a href="classmfem_1_1HypreBoomerAMG.html">mfem::HypreBoomerAMG</a></div><div class="ttdoc">The BoomerAMG solver in hypre. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8hpp_source.html#l01590">hypre.hpp:1590</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html">mfem::blocksolvers::DFSData</a></div><div class="ttdoc">Data for the divergence free solver. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00048">div_free_solver.hpp:48</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1IterSolveParameters_html_ab455df7166cca7e98fa5444dc3a22f88"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#ab455df7166cca7e98fa5444dc3a22f88">mfem::blocksolvers::IterSolveParameters::max_iter</a></div><div class="ttdeci">int max_iter</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00028">div_free_solver.hpp:28</a></div></div>
<div class="ttc" id="classmfem_1_1ProductOperator_html"><div class="ttname"><a href="classmfem_1_1ProductOperator.html">mfem::ProductOperator</a></div><div class="ttdoc">General product operator: x -&gt; (A*B)(x) = A(B(x)). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00774">operator.hpp:774</a></div></div>
<div class="ttc" id="classmfem_1_1MINRESSolver_html_ad6ca9fd0fba83eb50dfedc7f3c92aa8f"><div class="ttname"><a href="classmfem_1_1MINRESSolver.html#ad6ca9fd0fba83eb50dfedc7f3c92aa8f">mfem::MINRESSolver::SetPreconditioner</a></div><div class="ttdeci">virtual void SetPreconditioner(Solver &amp;pr)</div><div class="ttdoc">This should be called before SetOperator. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00616">solvers.hpp:616</a></div></div>
<div class="ttc" id="classmfem_1_1IterativeSolver_html_a95572a30eb8d7f2958faf0086b9f7bd2"><div class="ttname"><a href="classmfem_1_1IterativeSolver.html#a95572a30eb8d7f2958faf0086b9f7bd2">mfem::IterativeSolver::SetPrintLevel</a></div><div class="ttdeci">virtual void SetPrintLevel(int print_lvl)</div><div class="ttdoc">Legacy method to set the level of verbosity of the solver output. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8cpp_source.html#l00071">solvers.cpp:71</a></div></div>
<div class="ttc" id="classmfem_1_1BlockDiagonalPreconditioner_html"><div class="ttname"><a href="classmfem_1_1BlockDiagonalPreconditioner.html">mfem::BlockDiagonalPreconditioner</a></div><div class="ttdoc">A class to handle Block diagonal preconditioners in a matrix-free implementation. ...</div><div class="ttdef"><b>Definition:</b> <a href="blockoperator_8hpp_source.html#l00150">blockoperator.hpp:150</a></div></div>
<div class="ttc" id="classmfem_1_1SparseMatrix_html"><div class="ttname"><a href="classmfem_1_1SparseMatrix.html">mfem::SparseMatrix</a></div><div class="ttdoc">Data type sparse matrix. </div><div class="ttdef"><b>Definition:</b> <a href="sparsemat_8hpp_source.html#l00050">sparsemat.hpp:50</a></div></div>
<div class="ttc" id="namespacemfem_html"><div class="ttname"><a href="namespacemfem.html">mfem</a></div><div class="ttdef"><b>Definition:</b> <a href="CodeDocumentation_8dox_source.html#l00001">CodeDocumentation.dox:1</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1BDPMinresSolver_html"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html">mfem::blocksolvers::BDPMinresSolver</a></div><div class="ttdoc">Wrapper for the block-diagonal-preconditioned MINRES defined in ex5p.cpp. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00184">div_free_solver.hpp:184</a></div></div>
<div class="ttc" id="classmfem_1_1HypreDiagScale_html"><div class="ttname"><a href="classmfem_1_1HypreDiagScale.html">mfem::HypreDiagScale</a></div><div class="ttdoc">Jacobi preconditioner in hypre. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8hpp_source.html#l01421">hypre.hpp:1421</a></div></div>
<div class="ttc" id="div__free__solver_8cpp_html_ab2735d067d4901b29904b007ea1afed0"><div class="ttname"><a href="div__free__solver_8cpp.html#ab2735d067d4901b29904b007ea1afed0">ElemToDof</a></div><div class="ttdeci">SparseMatrix ElemToDof(const ParFiniteElementSpace &amp;fes)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00039">div_free_solver.cpp:39</a></div></div>
<div class="ttc" id="namespacemfem_html_abd1b6105cb4110752ec41c956c18d198"><div class="ttname"><a href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem::mfem_error</a></div><div class="ttdeci">void mfem_error(const char *msg)</div><div class="ttdoc">Function called when an error is encountered. Used by the macros MFEM_ABORT, MFEM_ASSERT, MFEM_VERIFY. </div><div class="ttdef"><b>Definition:</b> <a href="error_8cpp_source.html#l00154">error.cpp:154</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html"><div class="ttname"><a href="classmfem_1_1Array.html">mfem::Array&lt; int &gt;</a></div></div>
<div class="ttc" id="classmfem_1_1StopWatch_html"><div class="ttname"><a href="classmfem_1_1StopWatch.html">mfem::StopWatch</a></div><div class="ttdoc">Timing object. </div><div class="ttdef"><b>Definition:</b> <a href="tic__toc_8hpp_source.html#l00034">tic_toc.hpp:34</a></div></div>
<div class="ttc" id="classmfem_1_1IterativeSolver_html_a99fd388c7f98fed97fdcda50776288f5"><div class="ttname"><a href="classmfem_1_1IterativeSolver.html#a99fd388c7f98fed97fdcda50776288f5">mfem::IterativeSolver::SetMaxIter</a></div><div class="ttdeci">void SetMaxIter(int max_it)</div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00201">solvers.hpp:201</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_a4d5267f1a32c43d783fd84aa315213d2"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#a4d5267f1a32c43d783fd84aa315213d2">mfem::blocksolvers::DFSData::P_hdiv</a></div><div class="ttdeci">std::vector&lt; OperatorPtr &gt; P_hdiv</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00052">div_free_solver.hpp:52</a></div></div>
<div class="ttc" id="classmfem_1_1HypreParMatrix_html_a5fb3df7868045fe5659196e205de2aec"><div class="ttname"><a href="classmfem_1_1HypreParMatrix.html#a5fb3df7868045fe5659196e205de2aec">mfem::HypreParMatrix::LeftDiagMult</a></div><div class="ttdeci">HypreParMatrix * LeftDiagMult(const SparseMatrix &amp;D, HYPRE_BigInt *row_starts=NULL) const</div><div class="ttdoc">Multiply the HypreParMatrix on the left by a block-diagonal parallel matrix D and return the result a...</div><div class="ttdef"><b>Definition:</b> <a href="hypre_8cpp_source.html#l01912">hypre.cpp:1912</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DivFreeSolver_html_a1e5712899ceed4e8473c633078933ca1"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a1e5712899ceed4e8473c633078933ca1">mfem::blocksolvers::DivFreeSolver::SetOperator</a></div><div class="ttdeci">virtual void SetOperator(const Operator &amp;op)</div><div class="ttdoc">Set/update the solver for the given operator. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00234">div_free_solver.hpp:234</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSParameters_html_a1b5e4f6e97c9e984d97c42db6b38f953"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a1b5e4f6e97c9e984d97c42db6b38f953">mfem::blocksolvers::DFSParameters::coupled_solve</a></div><div class="ttdeci">bool coupled_solve</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00041">div_free_solver.hpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1DivFreeSolver_html_a4f8093cc23562dfbb6f7735c22f85827"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1DivFreeSolver.html#a4f8093cc23562dfbb6f7735c22f85827">mfem::blocksolvers::DivFreeSolver::GetNumIterations</a></div><div class="ttdeci">virtual int GetNumIterations() const</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00601">div_free_solver.cpp:601</a></div></div>
<div class="ttc" id="classmfem_1_1HypreSmoother_html"><div class="ttname"><a href="classmfem_1_1HypreSmoother.html">mfem::HypreSmoother</a></div><div class="ttdoc">Parallel smoothers in hypre. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8hpp_source.html#l00971">hypre.hpp:971</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrixInverse_html_adeaa668ba0ae73a3dc2db6f493c8f443"><div class="ttname"><a href="classmfem_1_1DenseMatrixInverse.html#adeaa668ba0ae73a3dc2db6f493c8f443">mfem::DenseMatrixInverse::SetOperator</a></div><div class="ttdeci">virtual void SetOperator(const Operator &amp;op)</div><div class="ttdoc">Set/update the solver for the given operator. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l03956">densemat.cpp:3956</a></div></div>
<div class="ttc" id="classmfem_1_1MINRESSolver_html_ac8c7671eb572b0478981cdda9f89bac6"><div class="ttname"><a href="classmfem_1_1MINRESSolver.html#ac8c7671eb572b0478981cdda9f89bac6">mfem::MINRESSolver::SetOperator</a></div><div class="ttdeci">virtual void SetOperator(const Operator &amp;op)</div><div class="ttdoc">Also calls SetOperator for the preconditioner if there is one. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8cpp_source.html#l01591">solvers.cpp:1591</a></div></div>
<div class="ttc" id="classmfem_1_1HypreParMatrix_html_a518458f221fe334d78a0393d9b535199"><div class="ttname"><a href="classmfem_1_1HypreParMatrix.html#a518458f221fe334d78a0393d9b535199">mfem::HypreParMatrix::GetDiag</a></div><div class="ttdeci">void GetDiag(Vector &amp;diag) const</div><div class="ttdoc">Get the local diagonal of the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8cpp_source.html#l01481">hypre.cpp:1481</a></div></div>
<div class="ttc" id="classmfem_1_1AuxSpaceSmoother_html"><div class="ttname"><a href="classmfem_1_1AuxSpaceSmoother.html">mfem::AuxSpaceSmoother</a></div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l01214">solvers.hpp:1214</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a7ec934fafa4317e6f9b33434bd8cf5b6"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a7ec934fafa4317e6f9b33434bd8cf5b6">mfem::FiniteElementSpace::GetNE</a></div><div class="ttdeci">int GetNE() const</div><div class="ttdoc">Returns number of elements in the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00614">fespace.hpp:614</a></div></div>
<div class="ttc" id="classmfem_1_1StopWatch_html_a6ff604f4c8b2ea33b323827486ca082f"><div class="ttname"><a href="classmfem_1_1StopWatch.html#a6ff604f4c8b2ea33b323827486ca082f">mfem::StopWatch::Start</a></div><div class="ttdeci">void Start()</div><div class="ttdoc">Start the stopwatch. The elapsed time is not cleared. </div><div class="ttdef"><b>Definition:</b> <a href="tic__toc_8cpp_source.html#l00411">tic_toc.cpp:411</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_aee4a1c4326df943c398b401cd58ea3eb"><div class="ttname"><a href="classmfem_1_1Vector.html#aee4a1c4326df943c398b401cd58ea3eb">mfem::Vector::GetData</a></div><div class="ttdeci">double * GetData() const</div><div class="ttdoc">Return a pointer to the beginning of the Vector data. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00208">vector.hpp:208</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1BDPMinresSolver_html_a04f912b9f1ca67bde8d88246570b7f41"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1BDPMinresSolver.html#a04f912b9f1ca67bde8d88246570b7f41">mfem::blocksolvers::BDPMinresSolver::BDPMinresSolver</a></div><div class="ttdeci">BDPMinresSolver(HypreParMatrix &amp;M, HypreParMatrix &amp;B, IterSolveParameters param)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00317">div_free_solver.cpp:317</a></div></div>
<div class="ttc" id="classmfem_1_1HypreParMatrix_html_ab4d1d307b1871dcc880c40dfe56b4571"><div class="ttname"><a href="classmfem_1_1HypreParMatrix.html#ab4d1d307b1871dcc880c40dfe56b4571">mfem::HypreParMatrix::GetComm</a></div><div class="ttdeci">MPI_Comm GetComm() const</div><div class="ttdoc">MPI communicator. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8hpp_source.html#l00534">hypre.hpp:534</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1IterSolveParameters_html_a25e5bfb80565a559d93dc7bdca59a01a"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#a25e5bfb80565a559d93dc7bdca59a01a">mfem::blocksolvers::IterSolveParameters::abs_tol</a></div><div class="ttdeci">double abs_tol</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00029">div_free_solver.hpp:29</a></div></div>
<div class="ttc" id="classmfem_1_1IterativeSolver_html_a180b408e09c85536b3f97b1f97039c76"><div class="ttname"><a href="classmfem_1_1IterativeSolver.html#a180b408e09c85536b3f97b1f97039c76">mfem::IterativeSolver::SetAbsTol</a></div><div class="ttdeci">void SetAbsTol(double atol)</div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00200">solvers.hpp:200</a></div></div>
<div class="ttc" id="classmfem_1_1IterativeSolver_html_ac2c2469f0b0ca6f3d183d11c89f2cdf9"><div class="ttname"><a href="classmfem_1_1IterativeSolver.html#ac2c2469f0b0ca6f3d183d11c89f2cdf9">mfem::IterativeSolver::SetRelTol</a></div><div class="ttdeci">void SetRelTol(double rtol)</div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00199">solvers.hpp:199</a></div></div>
<div class="ttc" id="classmfem_1_1IterativeSolver_html"><div class="ttname"><a href="classmfem_1_1IterativeSolver.html">mfem::IterativeSolver</a></div><div class="ttdoc">Abstract base class for iterative solver. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00066">solvers.hpp:66</a></div></div>
<div class="ttc" id="namespacemfem_html_a1b718f7693a3082acf73b7edd45c23a5"><div class="ttname"><a href="namespacemfem.html#a1b718f7693a3082acf73b7edd45c23a5">mfem::OperatorPtr</a></div><div class="ttdeci">OperatorHandle OperatorPtr</div><div class="ttdoc">Add an alternative name for OperatorHandle  OperatorPtr. </div><div class="ttdef"><b>Definition:</b> <a href="handle_8hpp_source.html#l00212">handle.hpp:212</a></div></div>
<div class="ttc" id="div__free__solver_8cpp_html_ade939524a52cca9c3527fd74e9961fda"><div class="ttname"><a href="div__free__solver_8cpp.html#ade939524a52cca9c3527fd74e9961fda">AggToInteriorDof</a></div><div class="ttdeci">SparseMatrix * AggToInteriorDof(const Array&lt; int &gt; &amp;bdr_truedofs, const SparseMatrix &amp;agg_elem, const SparseMatrix &amp;elem_dof, const HypreParMatrix &amp;dof_truedof, Array&lt; HYPRE_BigInt &gt; &amp;agg_starts)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00095">div_free_solver.cpp:95</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a566edbabee3d4f0d7ce15cbc638021ca"><div class="ttname"><a href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">mfem::Array::SetSize</a></div><div class="ttdeci">void SetSize(int nsize)</div><div class="ttdoc">Change the logical size of the array, keep existing entries. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00684">array.hpp:684</a></div></div>
<div class="ttc" id="classmfem_1_1SparseMatrix_html_a3803b1d1b11d9ea3648d7fcf05af47e2"><div class="ttname"><a href="classmfem_1_1SparseMatrix.html#a3803b1d1b11d9ea3648d7fcf05af47e2">mfem::SparseMatrix::EliminateRowCol</a></div><div class="ttdeci">void EliminateRowCol(int rc, const double sol, Vector &amp;rhs, DiagonalPolicy dpolicy=DIAG_ONE)</div><div class="ttdoc">Eliminate row rc and column rc and modify the rhs using sol. </div><div class="ttdef"><b>Definition:</b> <a href="sparsemat_8cpp_source.html#l01854">sparsemat.cpp:1854</a></div></div>
<div class="ttc" id="hypre__parcsr_8hpp_html_a891d15140bcc33b92ff03f02664c9022"><div class="ttname"><a href="hypre__parcsr_8hpp.html#a891d15140bcc33b92ff03f02664c9022">HYPRE_BigInt</a></div><div class="ttdeci">HYPRE_Int HYPRE_BigInt</div><div class="ttdef"><b>Definition:</b> <a href="hypre__parcsr_8hpp_source.html#l00028">hypre_parcsr.hpp:28</a></div></div>
<div class="ttc" id="namespacemfem_html_a49e8b6b6fbef900c91b7db4cd3f6e2b6"><div class="ttname"><a href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">mfem::Transpose</a></div><div class="ttdeci">void Transpose(const Table &amp;A, Table &amp;At, int ncols_A_)</div><div class="ttdoc">Transpose a Table. </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00413">table.cpp:413</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1LocalSolver_html_abf87846f23c05707e4eb057cea4beb08"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1LocalSolver.html#abf87846f23c05707e4eb057cea4beb08">mfem::blocksolvers::LocalSolver::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const</div><div class="ttdoc">Operator application: y=A(x). </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00234">div_free_solver.cpp:234</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_ade694bd867d944826c2218207f456694"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#ade694bd867d944826c2218207f456694">mfem::blocksolvers::DFSData::agg_hdivdof</a></div><div class="ttdeci">std::vector&lt; OperatorPtr &gt; agg_hdivdof</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00050">div_free_solver.hpp:50</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_a2995e0eb2a01de41b2c9de1a6e58ba31"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#a2995e0eb2a01de41b2c9de1a6e58ba31">mfem::blocksolvers::DFSData::agg_l2dof</a></div><div class="ttdeci">std::vector&lt; OperatorPtr &gt; agg_l2dof</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00051">div_free_solver.hpp:51</a></div></div>
<div class="ttc" id="classmfem_1_1GMRESSolver_html"><div class="ttname"><a href="classmfem_1_1GMRESSolver.html">mfem::GMRESSolver</a></div><div class="ttdoc">GMRES method. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00525">solvers.hpp:525</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSParameters_html"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSParameters.html">mfem::blocksolvers::DFSParameters</a></div><div class="ttdoc">Parameters for the divergence free solver. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00034">div_free_solver.hpp:34</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a7e7e6e0ce7d3bd928c8f17d895ca2742"><div class="ttname"><a href="classmfem_1_1Operator.html#a7e7e6e0ce7d3bd928c8f17d895ca2742">mfem::Operator::NumCols</a></div><div class="ttdeci">int NumCols() const</div><div class="ttdoc">Get the number of columns (size of input) of the Operator. Synonym with Width(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00075">operator.hpp:75</a></div></div>
<div class="ttc" id="classmfem_1_1HypreParMatrix_html_af4b829612c06c355c02e515b4a23f542"><div class="ttname"><a href="classmfem_1_1HypreParMatrix.html#af4b829612c06c355c02e515b4a23f542">mfem::HypreParMatrix::Transpose</a></div><div class="ttdeci">HypreParMatrix * Transpose() const</div><div class="ttdoc">Returns the transpose of *this. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8cpp_source.html#l01608">hypre.cpp:1608</a></div></div>
<div class="ttc" id="classmfem_1_1ParDiscreteLinearOperator_html"><div class="ttname"><a href="classmfem_1_1ParDiscreteLinearOperator.html">mfem::ParDiscreteLinearOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="pbilinearform_8hpp_source.html#l00307">pbilinearform.hpp:307</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_ae44fe518410a7e18a6783f36169a3656"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#ae44fe518410a7e18a6783f36169a3656">mfem::blocksolvers::DFSData::C</a></div><div class="ttdeci">std::vector&lt; OperatorPtr &gt; C</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00057">div_free_solver.hpp:57</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_a78fe035aa201b6f3f25fce772f425f17"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#a78fe035aa201b6f3f25fce772f425f17">mfem::DenseMatrix::CopyMNt</a></div><div class="ttdeci">void CopyMNt(const DenseMatrix &amp;A, int row_offset, int col_offset)</div><div class="ttdoc">Copy matrix A^t to the location in *this at row_offset, col_offset. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l01618">densemat.cpp:1618</a></div></div>
<div class="ttc" id="div__free__solver_8cpp_html_aa0da922baa249048aeaba5672d6c28a7"><div class="ttname"><a href="div__free__solver_8cpp.html#aa0da922baa249048aeaba5672d6c28a7">SetOptions</a></div><div class="ttdeci">void SetOptions(IterativeSolver &amp;solver, const IterSolveParameters &amp;param)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00018">div_free_solver.cpp:18</a></div></div>
<div class="ttc" id="div__free__solver_8cpp_html_a77a3f5dc1bbb79e8f03c51ce63871d9d"><div class="ttname"><a href="div__free__solver_8cpp.html#a77a3f5dc1bbb79e8f03c51ce63871d9d">TwoStepsRAP</a></div><div class="ttdeci">HypreParMatrix * TwoStepsRAP(const HypreParMatrix &amp;Rt, const HypreParMatrix &amp;A, const HypreParMatrix &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00026">div_free_solver.cpp:26</a></div></div>
<div class="ttc" id="classmfem_1_1OperatorHandle_html_af8bdd06aee243a54a094f57aac071260"><div class="ttname"><a href="classmfem_1_1OperatorHandle.html#af8bdd06aee243a54a094f57aac071260">mfem::OperatorHandle::As</a></div><div class="ttdeci">OpType * As() const</div><div class="ttdoc">Return the Operator pointer statically cast to a specified OpType. Similar to the method Get()...</div><div class="ttdef"><b>Definition:</b> <a href="handle_8hpp_source.html#l00104">handle.hpp:104</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1SymDirectSubBlockSolver_html"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1SymDirectSubBlockSolver.html">mfem::blocksolvers::SymDirectSubBlockSolver</a></div><div class="ttdoc">Block diagonal solver for symmetric A, each block is inverted by direct solver. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00127">div_free_solver.hpp:127</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_aba60d7d4a2e89b1ecafeb605f7489c22"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#aba60d7d4a2e89b1ecafeb605f7489c22">mfem::blocksolvers::DFSData::param</a></div><div class="ttdeci">DFSParameters param</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00058">div_free_solver.hpp:58</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1BBTSolver_html_adeba8aa8b4eccfe2d8abdd803b48e59a"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1BBTSolver.html#adeba8aa8b4eccfe2d8abdd803b48e59a">mfem::blocksolvers::BBTSolver::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const</div><div class="ttdoc">Operator application: y=A(x). </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00122">div_free_solver.hpp:122</a></div></div>
<div class="ttc" id="classmfem_1_1BilinearForm_html_a2ac313b9d213af233e4d9155666bded8"><div class="ttname"><a href="classmfem_1_1BilinearForm.html#a2ac313b9d213af233e4d9155666bded8">mfem::BilinearForm::AddDomainIntegrator</a></div><div class="ttdeci">void AddDomainIntegrator(BilinearFormIntegrator *bfi)</div><div class="ttdoc">Adds new Domain Integrator. Assumes ownership of bfi. </div><div class="ttdef"><b>Definition:</b> <a href="bilinearform_8cpp_source.html#l00236">bilinearform.cpp:236</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_ad01ffa1b529189db65b3dd27293ca791"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#ad01ffa1b529189db65b3dd27293ca791">mfem::FiniteElementSpace::GetVSize</a></div><div class="ttdeci">int GetVSize() const</div><div class="ttdoc">Return the number of vector dofs, i.e. GetNDofs() x GetVDim(). </div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00587">fespace.hpp:587</a></div></div>
<div class="ttc" id="div__free__solver_8cpp_html_a05444ce25fd061bd9145b44ca26b216a"><div class="ttname"><a href="div__free__solver_8cpp.html#a05444ce25fd061bd9145b44ca26b216a">GetRowColumnsRef</a></div><div class="ttdeci">void GetRowColumnsRef(const SparseMatrix &amp;A, int row, Array&lt; int &gt; &amp;cols)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00034">div_free_solver.cpp:34</a></div></div>
<div class="ttc" id="classmfem_1_1ParBilinearForm_html"><div class="ttname"><a href="classmfem_1_1ParBilinearForm.html">mfem::ParBilinearForm</a></div><div class="ttdoc">Class for parallel bilinear form. </div><div class="ttdef"><b>Definition:</b> <a href="pbilinearform_8hpp_source.html#l00028">pbilinearform.hpp:28</a></div></div>
<div class="ttc" id="classmfem_1_1OperatorHandle_html_a5d7481f32dac1fb44f8a1acb129abb2b"><div class="ttname"><a href="classmfem_1_1OperatorHandle.html#a5d7481f32dac1fb44f8a1acb129abb2b">mfem::OperatorHandle::Ptr</a></div><div class="ttdeci">Operator * Ptr() const</div><div class="ttdoc">Access the underlying Operator pointer. </div><div class="ttdef"><b>Definition:</b> <a href="handle_8hpp_source.html#l00087">handle.hpp:87</a></div></div>
<div class="ttc" id="div__free__solver_8hpp_html"><div class="ttname"><a href="div__free__solver_8hpp.html">div_free_solver.hpp</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a5efef8b3cd9f7f35f89bb8330e76d120"><div class="ttname"><a href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">mfem::Array::Size</a></div><div class="ttdeci">int Size() const</div><div class="ttdoc">Return the logical size of the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00141">array.hpp:141</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a47bf8a3ca650bc0c8e77941304172656"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a47bf8a3ca650bc0c8e77941304172656">mfem::FiniteElementSpace::ListToMarker</a></div><div class="ttdeci">static void ListToMarker(const Array&lt; int &gt; &amp;list, int marker_size, Array&lt; int &gt; &amp;marker, int mark_val=-1)</div><div class="ttdoc">Convert an array of indices (list) to a Boolean marker array where all indices in the list are marked...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l00617">fespace.cpp:617</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a7f0770ecb717feb309f278800f65a416"><div class="ttname"><a href="classmfem_1_1Array.html#a7f0770ecb717feb309f278800f65a416">mfem::Array::MakeRef</a></div><div class="ttdeci">void MakeRef(T *, int)</div><div class="ttdoc">Make this Array a reference to a pointer. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00869">array.hpp:869</a></div></div>
<div class="ttc" id="classmfem_1_1CGSolver_html_a0fd77af55cdb293ab1cfd8e99e5631fa"><div class="ttname"><a href="classmfem_1_1CGSolver.html#a0fd77af55cdb293ab1cfd8e99e5631fa">mfem::CGSolver::SetOperator</a></div><div class="ttdeci">virtual void SetOperator(const Operator &amp;op)</div><div class="ttdoc">Also calls SetOperator for the preconditioner if there is one. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8hpp_source.html#l00507">solvers.hpp:507</a></div></div>
<div class="ttc" id="classmfem_1_1ND__FECollection_html"><div class="ttname"><a href="classmfem_1_1ND__FECollection.html">mfem::ND_FECollection</a></div><div class="ttdoc">Arbitrary order H(curl)-conforming Nedelec finite elements. </div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00447">fe_coll.hpp:447</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html"><div class="ttname"><a href="classmfem_1_1Vector.html">mfem::Vector</a></div><div class="ttdoc">Vector data type. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00060">vector.hpp:60</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_aaa033bcf10ca8783218f5d98d8c54288a4387eb0ca1b04ce84b728325a98ea82c"><div class="ttname"><a href="classmfem_1_1Operator.html#aaa033bcf10ca8783218f5d98d8c54288a4387eb0ca1b04ce84b728325a98ea82c">mfem::Operator::Hypre_ParCSR</a></div><div class="ttdoc">ID for class HypreParMatrix. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00287">operator.hpp:287</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother_html"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1SaddleSchwarzSmoother.html">mfem::blocksolvers::SaddleSchwarzSmoother</a></div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00138">div_free_solver.hpp:138</a></div></div>
<div class="ttc" id="classmfem_1_1IterativeSolver_html_a860a3a142ab0904591ef7cfd90471b5b"><div class="ttname"><a href="classmfem_1_1IterativeSolver.html#a860a3a142ab0904591ef7cfd90471b5b">mfem::IterativeSolver::SetPreconditioner</a></div><div class="ttdeci">virtual void SetPreconditioner(Solver &amp;pr)</div><div class="ttdoc">This should be called before SetOperator. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_8cpp_source.html#l00173">solvers.cpp:173</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1IterSolveParameters_html"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html">mfem::blocksolvers::IterSolveParameters</a></div><div class="ttdoc">Parameters for iterative solver. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00025">div_free_solver.hpp:25</a></div></div>
<div class="ttc" id="classmfem_1_1HypreParMatrix_html_a4cc1852638b841200f12781d26cd62be"><div class="ttname"><a href="classmfem_1_1HypreParMatrix.html#a4cc1852638b841200f12781d26cd62be">mfem::HypreParMatrix::DropSmallEntries</a></div><div class="ttdeci">void DropSmallEntries(double tol)</div><div class="ttdoc">Wrapper for hypre_ParCSRMatrixDropSmallEntries in different versions of hypre. Drop off-diagonal entr...</div><div class="ttdef"><b>Definition:</b> <a href="hypre_8cpp_source.html#l02227">hypre.cpp:2227</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a1f6835099238cd350794c812622c68f4"><div class="ttname"><a href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">mfem::Table::GetI</a></div><div class="ttdeci">int * GetI()</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00113">table.hpp:113</a></div></div>
<div class="ttc" id="classmfem_1_1H1__FECollection_html"><div class="ttname"><a href="classmfem_1_1H1__FECollection.html">mfem::H1_FECollection</a></div><div class="ttdoc">Arbitrary order H1-conforming (continuous) finite elements. </div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00252">fe_coll.hpp:252</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_ab94228a1bb74f1611a94c203f2a732c6"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#ab94228a1bb74f1611a94c203f2a732c6">mfem::DenseMatrix::CopyMN</a></div><div class="ttdeci">void CopyMN(const DenseMatrix &amp;A, int m, int n, int Aro, int Aco)</div><div class="ttdoc">Copy the m x n submatrix of A at row/col offsets Aro/Aco to *this. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l01592">densemat.cpp:1592</a></div></div>
<div class="ttc" id="classmfem_1_1MassIntegrator_html"><div class="ttname"><a href="classmfem_1_1MassIntegrator.html">mfem::MassIntegrator</a></div><div class="ttdef"><b>Definition:</b> <a href="bilininteg_8hpp_source.html#l02175">bilininteg.hpp:2175</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSParameters_html_a3474d081f854c015dcb84b9f3ef548e4"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSParameters.html#a3474d081f854c015dcb84b9f3ef548e4">mfem::blocksolvers::DFSParameters::verbose</a></div><div class="ttdeci">bool verbose</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00042">div_free_solver.hpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1Solver_html"><div class="ttname"><a href="classmfem_1_1Solver.html">mfem::Solver</a></div><div class="ttdoc">Base class for solvers. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00682">operator.hpp:682</a></div></div>
<div class="ttc" id="classmfem_1_1BlockDiagonalPreconditioner_html_a3d98e00c15148269ac31ce918505c2fb"><div class="ttname"><a href="classmfem_1_1BlockDiagonalPreconditioner.html#a3d98e00c15148269ac31ce918505c2fb">mfem::BlockDiagonalPreconditioner::owns_blocks</a></div><div class="ttdeci">int owns_blocks</div><div class="ttdef"><b>Definition:</b> <a href="blockoperator_8hpp_source.html#l00192">blockoperator.hpp:192</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_a5c62b399e1c6408e5f1903f6cab5dfbb"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">mfem::DenseMatrix::SetSize</a></div><div class="ttdeci">void SetSize(int s)</div><div class="ttdoc">Change the size of the DenseMatrix to s x s. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8hpp_source.html#l00105">densemat.hpp:105</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1LocalSolver_html"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1LocalSolver.html">mfem::blocksolvers::LocalSolver</a></div><div class="ttdoc">Solver for local problems in SaddleSchwarzSmoother. </div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00172">div_free_solver.hpp:172</a></div></div>
<div class="ttc" id="classmfem_1_1HypreParMatrix_html"><div class="ttname"><a href="classmfem_1_1HypreParMatrix.html">mfem::HypreParMatrix</a></div><div class="ttdoc">Wrapper for hypre&amp;#39;s ParCSR matrix class. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8hpp_source.html#l00343">hypre.hpp:343</a></div></div>
<div class="ttc" id="classmfem_1_1BlockOperator_html"><div class="ttname"><a href="classmfem_1_1BlockOperator.html">mfem::BlockOperator</a></div><div class="ttdoc">A class to handle Block systems in a matrix-free implementation. </div><div class="ttdef"><b>Definition:</b> <a href="blockoperator_8hpp_source.html#l00034">blockoperator.hpp:34</a></div></div>
<div class="ttc" id="classmfem_1_1blocksolvers_1_1BBTSolver_html_a0a18a979c7ed1d7cf76680704a18cf6e"><div class="ttname"><a href="classmfem_1_1blocksolvers_1_1BBTSolver.html#a0a18a979c7ed1d7cf76680704a18cf6e">mfem::blocksolvers::BBTSolver::BBTSolver</a></div><div class="ttdeci">BBTSolver(const HypreParMatrix &amp;B, IterSolveParameters param)</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8cpp_source.html#l00206">div_free_solver.cpp:206</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html"><div class="ttname"><a href="classmfem_1_1ParMesh.html">mfem::ParMesh</a></div><div class="ttdoc">Class for parallel meshes. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00032">pmesh.hpp:32</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a85ec308dd5c94207f05825e2acc8722c"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a85ec308dd5c94207f05825e2acc8722c">mfem::FiniteElementSpace::GetElementToDofTable</a></div><div class="ttdeci">const Table &amp; GetElementToDofTable() const</div><div class="ttdoc">Return a reference to the internal Table that stores the lists of scalar dofs, for each mesh element...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00750">fespace.hpp:750</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaa7b6a988fd7eb10928cc14ba0f47543"><div class="ttname"><a href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">mfem::Element::GetType</a></div><div class="ttdeci">virtual Type GetType() const =0</div><div class="ttdoc">Returns element&amp;#39;s type. </div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1DFSData_html_a94537e13e50b8e59aa7a97d17bf2f663"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1DFSData.html#a94537e13e50b8e59aa7a97d17bf2f663">mfem::blocksolvers::DFSData::P_l2</a></div><div class="ttdeci">std::vector&lt; OperatorPtr &gt; P_l2</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00053">div_free_solver.hpp:53</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a33252b6934b06dc088c2683868c8a88d"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a33252b6934b06dc088c2683868c8a88d">mfem::FiniteElementSpace::AdjustVDofs</a></div><div class="ttdeci">static void AdjustVDofs(Array&lt; int &gt; &amp;vdofs)</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l00267">fespace.cpp:267</a></div></div>
<div class="ttc" id="classmfem_1_1HypreParMatrix_html_ac8002a6739728dd513e0d1887bc2f8a7"><div class="ttname"><a href="classmfem_1_1HypreParMatrix.html#ac8002a6739728dd513e0d1887bc2f8a7">mfem::HypreParMatrix::Mult</a></div><div class="ttdeci">HYPRE_Int Mult(HypreParVector &amp;x, HypreParVector &amp;y, double alpha=1.0, double beta=0.0) const</div><div class="ttdoc">Computes y = alpha * A * x + beta * y. </div><div class="ttdef"><b>Definition:</b> <a href="hypre_8cpp_source.html#l01733">hypre.cpp:1733</a></div></div>
<div class="ttc" id="classmfem_1_1StopWatch_html_ae272e3b952c266c4b873e4f85dac9f85"><div class="ttname"><a href="classmfem_1_1StopWatch.html#ae272e3b952c266c4b873e4f85dac9f85">mfem::StopWatch::Clear</a></div><div class="ttdeci">void Clear()</div><div class="ttdoc">Clear the elapsed time on the stopwatch and restart it if it&amp;#39;s running. </div><div class="ttdef"><b>Definition:</b> <a href="tic__toc_8cpp_source.html#l00406">tic_toc.cpp:406</a></div></div>
<div class="ttc" id="classmfem_1_1BlockOperator_html_afe9b4676b6ae952aab133d1e70b6235c"><div class="ttname"><a href="classmfem_1_1BlockOperator.html#afe9b4676b6ae952aab133d1e70b6235c">mfem::BlockOperator::SetBlock</a></div><div class="ttdeci">void SetBlock(int iRow, int iCol, Operator *op, double c=1.0)</div><div class="ttdoc">Add a block op in the block-entry (iblock, jblock). </div><div class="ttdef"><b>Definition:</b> <a href="blockoperator_8cpp_source.html#l00057">blockoperator.cpp:57</a></div></div>
<div class="ttc" id="classmfem_1_1OperatorHandle_html_ab5c65466ab64a9b6a9c1958472c6d7ca"><div class="ttname"><a href="classmfem_1_1OperatorHandle.html#ab5c65466ab64a9b6a9c1958472c6d7ca">mfem::OperatorHandle::Reset</a></div><div class="ttdeci">void Reset(OpType *A, bool own_A=true)</div><div class="ttdoc">Reset the OperatorHandle to the given OpType pointer, A. </div><div class="ttdef"><b>Definition:</b> <a href="handle_8hpp_source.html#l00145">handle.hpp:145</a></div></div>
<div class="ttc" id="classmfem_1_1BlockDiagonalPreconditioner_html_acd9317979590a4e94b432e6f78d046c4"><div class="ttname"><a href="classmfem_1_1BlockDiagonalPreconditioner.html#acd9317979590a4e94b432e6f78d046c4">mfem::BlockDiagonalPreconditioner::SetDiagonalBlock</a></div><div class="ttdeci">void SetDiagonalBlock(int iblock, Operator *op)</div><div class="ttdoc">Add a square block op in the block-entry (iblock, iblock). </div><div class="ttdef"><b>Definition:</b> <a href="blockoperator_8cpp_source.html#l00160">blockoperator.cpp:160</a></div></div>
<div class="ttc" id="classmfem_1_1BlockVector_html_a9f3845d64bd676f5e658d78a2615f11d"><div class="ttname"><a href="classmfem_1_1BlockVector.html#a9f3845d64bd676f5e658d78a2615f11d">mfem::BlockVector::GetBlock</a></div><div class="ttdeci">Vector &amp; GetBlock(int i)</div><div class="ttdoc">Get the i-th vector in the block. </div><div class="ttdef"><b>Definition:</b> <a href="blockvector_8hpp_source.html#l00090">blockvector.hpp:90</a></div></div>
<div class="ttc" id="structmfem_1_1blocksolvers_1_1IterSolveParameters_html_adf0b83f507276f406774f6e3c2786259"><div class="ttname"><a href="structmfem_1_1blocksolvers_1_1IterSolveParameters.html#adf0b83f507276f406774f6e3c2786259">mfem::blocksolvers::IterSolveParameters::rel_tol</a></div><div class="ttdeci">double rel_tol</div><div class="ttdef"><b>Definition:</b> <a href="div__free__solver_8hpp_source.html#l00030">div_free_solver.hpp:30</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 23 2023 16:28:25 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
