<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MFEM: hypre.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM&#160;<span id="projectnumber">v1.2.2</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_22e7892454e350ae265aec98296a27f7.html">mfem</a>      </li>
      <li class="navelem"><a class="el" href="dir_a28d2400c06ca1f168b29dc351700a81.html">linalg</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">hypre.cpp</div>  </div>
</div>
<div class="contents">
<a href="hypre_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (c) 2010, Lawrence Livermore National Security, LLC. Produced at</span>
<a name="l00002"></a>00002 <span class="comment">// the Lawrence Livermore National Laboratory. LLNL-CODE-443211. All Rights</span>
<a name="l00003"></a>00003 <span class="comment">// reserved. See file COPYRIGHT for details.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This file is part of the MFEM library. For more information and source code</span>
<a name="l00006"></a>00006 <span class="comment">// availability see http://mfem.googlecode.com.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span>
<a name="l00009"></a>00009 <span class="comment">// terms of the GNU Lesser General Public License (as published by the Free</span>
<a name="l00010"></a>00010 <span class="comment">// Software Foundation) version 2.1 dated February 1999.</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#ifdef MFEM_USE_MPI</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;iomanip&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="linalg_8hpp.html">linalg.hpp</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;../fem/fem.hpp&quot;</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <a class="code" href="classHypreParVector.html#a4959c8be0ffba30ca0c4bd1d410c1ddb">HypreParVector::HypreParVector</a>(<span class="keywordtype">int</span> glob_size, <span class="keywordtype">int</span> *col) : <a class="code" href="classVector.html" title="Vector data type.">Vector</a>()
<a name="l00024"></a>00024 {
<a name="l00025"></a>00025    x = hypre_ParVectorCreate(MPI_COMM_WORLD,glob_size,col);
<a name="l00026"></a>00026    hypre_ParVectorInitialize(x);
<a name="l00027"></a>00027    hypre_ParVectorSetPartitioningOwner(x,0);
<a name="l00028"></a>00028    <span class="comment">// The data will be destroyed by hypre (this is the default)</span>
<a name="l00029"></a>00029    hypre_ParVectorSetDataOwner(x,1);
<a name="l00030"></a>00030    hypre_SeqVectorSetDataOwner(hypre_ParVectorLocalVector(x),1);
<a name="l00031"></a>00031    SetDataAndSize(hypre_VectorData(hypre_ParVectorLocalVector(x)),
<a name="l00032"></a>00032                   hypre_VectorSize(hypre_ParVectorLocalVector(x)));
<a name="l00033"></a>00033    own_ParVector = 1;
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <a class="code" href="classHypreParVector.html#a4959c8be0ffba30ca0c4bd1d410c1ddb">HypreParVector::HypreParVector</a>(<span class="keywordtype">int</span> glob_size, <span class="keywordtype">double</span> *_data, <span class="keywordtype">int</span> *col)
<a name="l00037"></a>00037    : <a class="code" href="classVector.html" title="Vector data type.">Vector</a>()
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039    x = hypre_ParVectorCreate(MPI_COMM_WORLD,glob_size,col);
<a name="l00040"></a>00040    hypre_ParVectorSetDataOwner(x,1); <span class="comment">// owns the seq vector</span>
<a name="l00041"></a>00041    hypre_SeqVectorSetDataOwner(hypre_ParVectorLocalVector(x),0);
<a name="l00042"></a>00042    hypre_ParVectorSetPartitioningOwner(x,0);
<a name="l00043"></a>00043    hypre_VectorData(hypre_ParVectorLocalVector(x)) = _data;
<a name="l00044"></a>00044    <span class="comment">// If hypre_ParVectorLocalVector(x) is non-NULL, hypre_ParVectorInitialize(x)</span>
<a name="l00045"></a>00045    <span class="comment">// does not allocate memory!</span>
<a name="l00046"></a>00046    hypre_ParVectorInitialize(x);
<a name="l00047"></a>00047    SetDataAndSize(hypre_VectorData(hypre_ParVectorLocalVector(x)),
<a name="l00048"></a>00048                   hypre_VectorSize(hypre_ParVectorLocalVector(x)));
<a name="l00049"></a>00049    own_ParVector = 1;
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <a class="code" href="classHypreParVector.html#a4959c8be0ffba30ca0c4bd1d410c1ddb">HypreParVector::HypreParVector</a>(<span class="keyword">const</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;y) : <a class="code" href="classVector.html" title="Vector data type.">Vector</a>()
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054    x = hypre_ParVectorCreate(MPI_COMM_WORLD, y.<a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a> -&gt; global_size,
<a name="l00055"></a>00055                              y.<a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a> -&gt; partitioning);
<a name="l00056"></a>00056    hypre_ParVectorInitialize(x);
<a name="l00057"></a>00057    hypre_ParVectorSetPartitioningOwner(x,0);
<a name="l00058"></a>00058    hypre_ParVectorSetDataOwner(x,1);
<a name="l00059"></a>00059    hypre_SeqVectorSetDataOwner(hypre_ParVectorLocalVector(x),1);
<a name="l00060"></a>00060    SetDataAndSize(hypre_VectorData(hypre_ParVectorLocalVector(x)),
<a name="l00061"></a>00061                   hypre_VectorSize(hypre_ParVectorLocalVector(x)));
<a name="l00062"></a>00062    own_ParVector = 1;
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <a class="code" href="classHypreParVector.html#a4959c8be0ffba30ca0c4bd1d410c1ddb">HypreParVector::HypreParVector</a>(HYPRE_ParVector y) : <a class="code" href="classVector.html" title="Vector data type.">Vector</a>()
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067    x = (hypre_ParVector *) y;
<a name="l00068"></a>00068    SetDataAndSize(hypre_VectorData(hypre_ParVectorLocalVector(x)),
<a name="l00069"></a>00069                   hypre_VectorSize(hypre_ParVectorLocalVector(x)));
<a name="l00070"></a>00070    own_ParVector = 0;
<a name="l00071"></a>00071 }
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <a class="code" href="classHypreParVector.html#a7be184704544d87214a6befe2bb464ba" title="Typecasting to hypre&#39;s hypre_ParVector*.">HypreParVector::operator hypre_ParVector*</a>()<span class="keyword"> const</span>
<a name="l00074"></a>00074 <span class="keyword"></span>{
<a name="l00075"></a>00075    <span class="keywordflow">return</span> <a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a>;
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <a class="code" href="classHypreParVector.html#a337b739859910b5d999ceb143b1bd326" title="Typecasting to hypre&#39;s HYPRE_ParVector, a.k.a. void *.">HypreParVector::operator HYPRE_ParVector</a>()<span class="keyword"> const</span>
<a name="l00079"></a>00079 <span class="keyword"></span>{
<a name="l00080"></a>00080    <span class="keywordflow">return</span> (HYPRE_ParVector) <a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a>;
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <a class="code" href="classVector.html" title="Vector data type.">Vector</a> * <a class="code" href="classHypreParVector.html#a983b922399b4b57ac255e8acb6c82064" title="Returns the global vector in each processor.">HypreParVector::GlobalVector</a>()
<a name="l00084"></a>00084 {
<a name="l00085"></a>00085    hypre_Vector *hv = hypre_ParVectorToVectorAll(*<span class="keyword">this</span>);
<a name="l00086"></a>00086    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> *v = <span class="keyword">new</span> <a class="code" href="classVector.html#a6f80c73b5f18dcf3f8e36065bdc8b9e5" title="Default constructor for Vector. Sets size = 0 and data = NULL.">Vector</a>(hv-&gt;data, hv-&gt;size);
<a name="l00087"></a>00087    v-&gt;<a class="code" href="classVector.html#ac3164e4177dd29acc086cf4e6940c992">MakeDataOwner</a>();
<a name="l00088"></a>00088    hypre_SeqVectorSetDataOwner(hv,0);
<a name="l00089"></a>00089    hypre_SeqVectorDestroy(hv);
<a name="l00090"></a>00090    <span class="keywordflow">return</span> v;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>&amp; <a class="code" href="classHypreParVector.html#a7af50abc0f383d54afa133294586f352" title="Set constant values.">HypreParVector::operator=</a>(<span class="keywordtype">double</span> d)
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095    hypre_ParVectorSetConstantValues(<a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a>,d);
<a name="l00096"></a>00096    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>&amp; <a class="code" href="classHypreParVector.html#a7af50abc0f383d54afa133294586f352" title="Set constant values.">HypreParVector::operator=</a>(<span class="keyword">const</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;y)
<a name="l00100"></a>00100 {
<a name="l00101"></a>00101 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classVector.html#ae13c6e730a6558ba444beb8f7e44d4ca">size</a> != y.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>())
<a name="l00103"></a>00103       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;HypreParVector::operator=&quot;</span>);
<a name="l00104"></a>00104 <span class="preprocessor">#endif</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
<a name="l00106"></a>00106    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classVector.html#ae13c6e730a6558ba444beb8f7e44d4ca">size</a>; i++)
<a name="l00107"></a>00107       <a class="code" href="classVector.html#a5c596b5d8971aaeaf42b7fbb971d2a17">data</a>[i] = y.<a class="code" href="classVector.html#a5c596b5d8971aaeaf42b7fbb971d2a17">data</a>[i];
<a name="l00108"></a>00108    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00109"></a>00109 }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="keywordtype">void</span> <a class="code" href="classHypreParVector.html#a88eeaac0b71e746777b80670537d2cec">HypreParVector::SetData</a>(<span class="keywordtype">double</span> *_data)
<a name="l00112"></a>00112 {
<a name="l00113"></a>00113    <a class="code" href="classVector.html#a5c596b5d8971aaeaf42b7fbb971d2a17">Vector::data</a> = hypre_VectorData(hypre_ParVectorLocalVector(<a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a>)) = _data;
<a name="l00114"></a>00114 }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="keywordtype">int</span> <a class="code" href="classHypreParVector.html#a12400dbc352e82f494272077e211feb2" title="Set random values.">HypreParVector::Randomize</a>(<span class="keywordtype">int</span> seed)
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118    <span class="keywordflow">return</span> hypre_ParVectorSetRandomValues(<a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a>,seed);
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="keywordtype">void</span> <a class="code" href="classHypreParVector.html#abc0df4338339d57cb33116126e16ef87" title="Prints the locally owned rows in parallel.">HypreParVector::Print</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname)
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123    hypre_ParVectorPrint(<a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a>,fname);
<a name="l00124"></a>00124 }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <a class="code" href="classHypreParVector.html#a11813316e972670ac1a961b5c745dfb9" title="Calls hypre&#39;s destroy function.">HypreParVector::~HypreParVector</a>()
<a name="l00127"></a>00127 {
<a name="l00128"></a>00128    <span class="keywordflow">if</span> (<a class="code" href="classHypreParVector.html#a44be0b21454d3e51df0b95cd389db943">own_ParVector</a>)
<a name="l00129"></a>00129       hypre_ParVectorDestroy(<a class="code" href="classHypreParVector.html#a2d673964e7e0648628bd5b127a889960" title="The actual object.">x</a>);
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="keywordtype">double</span> <a class="code" href="hypre_8hpp.html#a38ca3f21b834c27d9f6652407408bce4" title="Returns the inner product of x and y.">InnerProduct</a>(<a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> *x, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> *y)
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135    <span class="keywordflow">return</span> hypre_ParVectorInnerProd(*x, *y);
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="keywordtype">double</span> <a class="code" href="hypre_8hpp.html#a38ca3f21b834c27d9f6652407408bce4" title="Returns the inner product of x and y.">InnerProduct</a>(<a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;x, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;y)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140    <span class="keywordflow">return</span> hypre_ParVectorInnerProd(x, y);
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix::HypreParMatrix</a>(<span class="keywordtype">int</span> size, <span class="keywordtype">int</span> *row, <a class="code" href="classSparseMatrix.html" title="Data type sparse matrix.">SparseMatrix</a> *diag)
<a name="l00145"></a>00145    : <a class="code" href="classOperator.html" title="Abstract operator.">Operator</a>(size)
<a name="l00146"></a>00146 {
<a name="l00147"></a>00147    A = hypre_ParCSRMatrixCreate(MPI_COMM_WORLD, size, size, row, row,
<a name="l00148"></a>00148                                 0, diag-&gt;<a class="code" href="classSparseMatrix.html#a37f9fbf3b31951231a5656206df5edee" title="Returns the number of the nonzero elements in the matrix.">NumNonZeroElems</a>(), 0);
<a name="l00149"></a>00149    hypre_ParCSRMatrixSetDataOwner(A,0);
<a name="l00150"></a>00150    hypre_ParCSRMatrixSetRowStartsOwner(A,0);
<a name="l00151"></a>00151    hypre_ParCSRMatrixSetColStartsOwner(A,0);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153    hypre_CSRMatrixSetDataOwner(A-&gt;diag,0);
<a name="l00154"></a>00154    hypre_CSRMatrixI(A-&gt;diag)    = diag-&gt;<a class="code" href="classSparseMatrix.html#a5e76f22cecc10b89a4f1c30bc9b2f39c" title="Return the array I.">GetI</a>();
<a name="l00155"></a>00155    hypre_CSRMatrixJ(A-&gt;diag)    = diag-&gt;<a class="code" href="classSparseMatrix.html#ad00134d53ef613399af89213f5fadbd2" title="Return the array J.">GetJ</a>();
<a name="l00156"></a>00156    hypre_CSRMatrixData(A-&gt;diag) = diag-&gt;<a class="code" href="classSparseMatrix.html#ac62d784d911f9ac660a7679b216c1e98" title="Return element data.">GetData</a>();
<a name="l00157"></a>00157    hypre_CSRMatrixSetRownnz(A-&gt;diag);
<a name="l00158"></a>00158 
<a name="l00159"></a>00159    hypre_CSRMatrixSetDataOwner(A-&gt;offd,1);
<a name="l00160"></a>00160    hypre_CSRMatrixI(A-&gt;offd)    = hypre_CTAlloc(HYPRE_Int, diag-&gt;<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>()+1);
<a name="l00161"></a>00161 
<a name="l00162"></a>00162    <span class="comment">/* Don&#39;t need to call these, since they allocate memory only</span>
<a name="l00163"></a>00163 <span class="comment">      if it was not already allocated */</span>
<a name="l00164"></a>00164    <span class="comment">// hypre_CSRMatrixInitialize(A-&gt;diag);</span>
<a name="l00165"></a>00165    <span class="comment">// hypre_ParCSRMatrixInitialize(A);</span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167    hypre_ParCSRMatrixSetNumNonzeros(A);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169    hypre_MatvecCommPkgCreate(A);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171    CommPkg = NULL;
<a name="l00172"></a>00172    X = Y = NULL;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix::HypreParMatrix</a>(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> *row, <span class="keywordtype">int</span> *col,
<a name="l00177"></a>00177                                <a class="code" href="classSparseMatrix.html" title="Data type sparse matrix.">SparseMatrix</a> *diag)
<a name="l00178"></a>00178 {
<a name="l00179"></a>00179    <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = hypre_ParCSRMatrixCreate(MPI_COMM_WORLD, M, N, row, col,
<a name="l00180"></a>00180                                 0, diag-&gt;<a class="code" href="classSparseMatrix.html#a37f9fbf3b31951231a5656206df5edee" title="Returns the number of the nonzero elements in the matrix.">NumNonZeroElems</a>(), 0);
<a name="l00181"></a>00181    hypre_ParCSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00182"></a>00182    hypre_ParCSRMatrixSetRowStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00183"></a>00183    hypre_ParCSRMatrixSetColStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00184"></a>00184 
<a name="l00185"></a>00185    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag,0);
<a name="l00186"></a>00186    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = diag-&gt;<a class="code" href="classSparseMatrix.html#a5e76f22cecc10b89a4f1c30bc9b2f39c" title="Return the array I.">GetI</a>();
<a name="l00187"></a>00187    hypre_CSRMatrixJ(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = diag-&gt;<a class="code" href="classSparseMatrix.html#ad00134d53ef613399af89213f5fadbd2" title="Return the array J.">GetJ</a>();
<a name="l00188"></a>00188    hypre_CSRMatrixData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag) = diag-&gt;<a class="code" href="classSparseMatrix.html#ac62d784d911f9ac660a7679b216c1e98" title="Return element data.">GetData</a>();
<a name="l00189"></a>00189    hypre_CSRMatrixSetRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag);
<a name="l00190"></a>00190 
<a name="l00191"></a>00191    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd,1);
<a name="l00192"></a>00192    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd) = hypre_CTAlloc(HYPRE_Int, diag-&gt;<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>()+1);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194    hypre_ParCSRMatrixSetNumNonzeros(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00195"></a>00195 
<a name="l00196"></a>00196    hypre_MatvecCommPkgCreate(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00197"></a>00197 
<a name="l00198"></a>00198    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = NULL;
<a name="l00199"></a>00199    <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a> = NULL;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201    size = <a class="code" href="classHypreParMatrix.html#af1cb1366a1423043af97fadcdb11e1e1" title="Returns the number of rows in the diagonal block of the ParCSRMatrix.">GetNumRows</a>();
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix::HypreParMatrix</a>(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> *row, <span class="keywordtype">int</span> *col,
<a name="l00205"></a>00205                                <a class="code" href="classSparseMatrix.html" title="Data type sparse matrix.">SparseMatrix</a> *diag, <a class="code" href="classSparseMatrix.html" title="Data type sparse matrix.">SparseMatrix</a> *offd,
<a name="l00206"></a>00206                                <span class="keywordtype">int</span> *cmap)
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208    <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = hypre_ParCSRMatrixCreate(MPI_COMM_WORLD, M, N, row, col,
<a name="l00209"></a>00209                                 offd-&gt;<a class="code" href="classSparseMatrix.html#ae084bdd7933d590f232eb9aad5862811" title="Return the number of columns.">Width</a>(), diag-&gt;<a class="code" href="classSparseMatrix.html#a37f9fbf3b31951231a5656206df5edee" title="Returns the number of the nonzero elements in the matrix.">NumNonZeroElems</a>(),
<a name="l00210"></a>00210                                 offd-&gt;<a class="code" href="classSparseMatrix.html#a37f9fbf3b31951231a5656206df5edee" title="Returns the number of the nonzero elements in the matrix.">NumNonZeroElems</a>());
<a name="l00211"></a>00211    hypre_ParCSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00212"></a>00212    hypre_ParCSRMatrixSetRowStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00213"></a>00213    hypre_ParCSRMatrixSetColStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag,0);
<a name="l00216"></a>00216    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = diag-&gt;<a class="code" href="classSparseMatrix.html#a5e76f22cecc10b89a4f1c30bc9b2f39c" title="Return the array I.">GetI</a>();
<a name="l00217"></a>00217    hypre_CSRMatrixJ(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = diag-&gt;<a class="code" href="classSparseMatrix.html#ad00134d53ef613399af89213f5fadbd2" title="Return the array J.">GetJ</a>();
<a name="l00218"></a>00218    hypre_CSRMatrixData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag) = diag-&gt;<a class="code" href="classSparseMatrix.html#ac62d784d911f9ac660a7679b216c1e98" title="Return element data.">GetData</a>();
<a name="l00219"></a>00219    hypre_CSRMatrixSetRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag);
<a name="l00220"></a>00220 
<a name="l00221"></a>00221    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd,0);
<a name="l00222"></a>00222    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd)    = offd-&gt;<a class="code" href="classSparseMatrix.html#a5e76f22cecc10b89a4f1c30bc9b2f39c" title="Return the array I.">GetI</a>();
<a name="l00223"></a>00223    hypre_CSRMatrixJ(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd)    = offd-&gt;<a class="code" href="classSparseMatrix.html#ad00134d53ef613399af89213f5fadbd2" title="Return the array J.">GetJ</a>();
<a name="l00224"></a>00224    hypre_CSRMatrixData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd) = offd-&gt;<a class="code" href="classSparseMatrix.html#ac62d784d911f9ac660a7679b216c1e98" title="Return element data.">GetData</a>();
<a name="l00225"></a>00225    hypre_CSRMatrixSetRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227    hypre_ParCSRMatrixColMapOffd(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) = cmap;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229    hypre_ParCSRMatrixSetNumNonzeros(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00230"></a>00230 
<a name="l00231"></a>00231    hypre_MatvecCommPkgCreate(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = NULL;
<a name="l00234"></a>00234    <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a> = NULL;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236    size = <a class="code" href="classHypreParMatrix.html#af1cb1366a1423043af97fadcdb11e1e1" title="Returns the number of rows in the diagonal block of the ParCSRMatrix.">GetNumRows</a>();
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix::HypreParMatrix</a>(<span class="keywordtype">int</span> *row, <span class="keywordtype">int</span> *col, <a class="code" href="classSparseMatrix.html" title="Data type sparse matrix.">SparseMatrix</a> *sm_a)
<a name="l00240"></a>00240 {
<a name="l00241"></a>00241 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00242"></a>00242 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (sm_a == NULL)
<a name="l00243"></a>00243       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;HypreParMatrix::HypreParMatrix: sm_a==NULL&quot;</span>);
<a name="l00244"></a>00244 <span class="preprocessor">#endif</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span>
<a name="l00246"></a>00246    hypre_CSRMatrix *csr_a;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248    csr_a = hypre_CSRMatrixCreate(sm_a -&gt; <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(), sm_a -&gt; Width(),
<a name="l00249"></a>00249                                  sm_a -&gt; NumNonZeroElems());
<a name="l00250"></a>00250 
<a name="l00251"></a>00251    hypre_CSRMatrixSetDataOwner(csr_a,0);
<a name="l00252"></a>00252    hypre_CSRMatrixI(csr_a)    = sm_a -&gt; GetI();
<a name="l00253"></a>00253    hypre_CSRMatrixJ(csr_a)    = sm_a -&gt; GetJ();
<a name="l00254"></a>00254    hypre_CSRMatrixData(csr_a) = sm_a -&gt; GetData();
<a name="l00255"></a>00255    hypre_CSRMatrixSetRownnz(csr_a);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257    <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = hypre_CSRMatrixToParCSRMatrix(MPI_COMM_WORLD,csr_a,row,col);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = NULL;
<a name="l00260"></a>00260    <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a> = NULL;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262    size = <a class="code" href="classHypreParMatrix.html#af1cb1366a1423043af97fadcdb11e1e1" title="Returns the number of rows in the diagonal block of the ParCSRMatrix.">GetNumRows</a>();
<a name="l00263"></a>00263 
<a name="l00264"></a>00264    hypre_MatvecCommPkgCreate(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix::HypreParMatrix</a>(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> *row, <span class="keywordtype">int</span> *col,
<a name="l00268"></a>00268                                <a class="code" href="classTable.html">Table</a> *diag)
<a name="l00269"></a>00269 {
<a name="l00270"></a>00270    <span class="keywordtype">int</span> nnz = diag-&gt;<a class="code" href="classTable.html#a6d896f9c079aabc1ce8c94982d34c6e2">Size_of_connections</a>();
<a name="l00271"></a>00271    <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = hypre_ParCSRMatrixCreate(MPI_COMM_WORLD, M, N, row, col,
<a name="l00272"></a>00272                                 0, nnz, 0);
<a name="l00273"></a>00273    hypre_ParCSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,1);
<a name="l00274"></a>00274    hypre_ParCSRMatrixSetRowStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00275"></a>00275    hypre_ParCSRMatrixSetColStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag,1);
<a name="l00278"></a>00278    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = diag-&gt;<a class="code" href="classTable.html#af3cf9697d71afed14f9b2997f7a5ee84">GetI</a>();
<a name="l00279"></a>00279    hypre_CSRMatrixJ(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = diag-&gt;<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>();
<a name="l00280"></a>00280 
<a name="l00281"></a>00281    hypre_CSRMatrixData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag) = hypre_TAlloc(<span class="keywordtype">double</span>, nnz);
<a name="l00282"></a>00282    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nnz; k++)
<a name="l00283"></a>00283       (hypre_CSRMatrixData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag))[k] = 1.0;
<a name="l00284"></a>00284 
<a name="l00285"></a>00285    hypre_CSRMatrixSetRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag);
<a name="l00286"></a>00286 
<a name="l00287"></a>00287    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd,1);
<a name="l00288"></a>00288    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd) = hypre_CTAlloc(HYPRE_Int, diag-&gt;<a class="code" href="classTable.html#aebd928bf244520ae94bd2867044b1ae2" title="Returns the number of TYPE I elements.">Size</a>()+1);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290    hypre_ParCSRMatrixSetNumNonzeros(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00291"></a>00291 
<a name="l00292"></a>00292    hypre_MatvecCommPkgCreate(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = NULL;
<a name="l00295"></a>00295    <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a> = NULL;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297    size = <a class="code" href="classHypreParMatrix.html#af1cb1366a1423043af97fadcdb11e1e1" title="Returns the number of rows in the diagonal block of the ParCSRMatrix.">GetNumRows</a>();
<a name="l00298"></a>00298 }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix::HypreParMatrix</a>(MPI_Comm comm, <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> np,
<a name="l00301"></a>00301                                <span class="keywordtype">int</span> *row, <span class="keywordtype">int</span> *col,
<a name="l00302"></a>00302                                <span class="keywordtype">int</span> *i_diag, <span class="keywordtype">int</span> *j_diag,
<a name="l00303"></a>00303                                <span class="keywordtype">int</span> *i_offd, <span class="keywordtype">int</span> *j_offd,
<a name="l00304"></a>00304                                <span class="keywordtype">int</span> *cmap, <span class="keywordtype">int</span> cmap_size)
<a name="l00305"></a>00305 {
<a name="l00306"></a>00306    <span class="keywordtype">int</span> diag_col, offd_col;
<a name="l00307"></a>00307 
<a name="l00308"></a>00308    <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())
<a name="l00309"></a>00309    {
<a name="l00310"></a>00310       diag_col = i_diag[row[1]-row[0]];
<a name="l00311"></a>00311       offd_col = i_offd[row[1]-row[0]];
<a name="l00312"></a>00312 
<a name="l00313"></a>00313       <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = hypre_ParCSRMatrixCreate(comm, row[2], col[2], row, col,
<a name="l00314"></a>00314                                    cmap_size, diag_col, offd_col);
<a name="l00315"></a>00315    }
<a name="l00316"></a>00316    <span class="keywordflow">else</span>
<a name="l00317"></a>00317    {
<a name="l00318"></a>00318       diag_col = i_diag[row[<span class="keywordtype">id</span>+1]-row[id]];
<a name="l00319"></a>00319       offd_col = i_offd[row[<span class="keywordtype">id</span>+1]-row[id]];
<a name="l00320"></a>00320 
<a name="l00321"></a>00321       <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = hypre_ParCSRMatrixCreate(comm, row[np], col[np], row, col,
<a name="l00322"></a>00322                                    cmap_size, diag_col, offd_col);
<a name="l00323"></a>00323    }
<a name="l00324"></a>00324 
<a name="l00325"></a>00325    hypre_ParCSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,1);
<a name="l00326"></a>00326    hypre_ParCSRMatrixSetRowStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00327"></a>00327    hypre_ParCSRMatrixSetColStartsOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,0);
<a name="l00328"></a>00328 
<a name="l00329"></a>00329    <span class="keywordtype">int</span> i;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331    <span class="keywordtype">double</span> *a_diag = hypre_TAlloc(<span class="keywordtype">double</span>, diag_col);
<a name="l00332"></a>00332    <span class="keywordflow">for</span> (i = 0; i &lt; diag_col; i++)
<a name="l00333"></a>00333       a_diag[i] = 1.0;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335    <span class="keywordtype">double</span> *a_offd = hypre_TAlloc(<span class="keywordtype">double</span>, offd_col);
<a name="l00336"></a>00336    <span class="keywordflow">for</span> (i = 0; i &lt; offd_col; i++)
<a name="l00337"></a>00337       a_offd[i] = 1.0;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag,1);
<a name="l00340"></a>00340    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = i_diag;
<a name="l00341"></a>00341    hypre_CSRMatrixJ(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag)    = j_diag;
<a name="l00342"></a>00342    hypre_CSRMatrixData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag) = a_diag;
<a name="l00343"></a>00343    hypre_CSRMatrixSetRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag);
<a name="l00344"></a>00344 
<a name="l00345"></a>00345    hypre_CSRMatrixSetDataOwner(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd,1);
<a name="l00346"></a>00346    hypre_CSRMatrixI(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd)    = i_offd;
<a name="l00347"></a>00347    hypre_CSRMatrixJ(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd)    = j_offd;
<a name="l00348"></a>00348    hypre_CSRMatrixData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd) = a_offd;
<a name="l00349"></a>00349    hypre_CSRMatrixSetRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351    hypre_ParCSRMatrixColMapOffd(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) = cmap;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353    hypre_ParCSRMatrixSetNumNonzeros(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355    hypre_MatvecCommPkgCreate(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00356"></a>00356 
<a name="l00357"></a>00357    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = NULL;
<a name="l00358"></a>00358    <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a> = NULL;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360    size = <a class="code" href="classHypreParMatrix.html#af1cb1366a1423043af97fadcdb11e1e1" title="Returns the number of rows in the diagonal block of the ParCSRMatrix.">GetNumRows</a>();
<a name="l00361"></a>00361 }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix::HypreParMatrix</a>(MPI_Comm comm, <span class="keywordtype">int</span> nrows, <span class="keywordtype">int</span> glob_nrows,
<a name="l00364"></a>00364                                <span class="keywordtype">int</span> glob_ncols, <span class="keywordtype">int</span> *I, <span class="keywordtype">int</span> *J, <span class="keywordtype">double</span> *data,
<a name="l00365"></a>00365                                <span class="keywordtype">int</span> *rows, <span class="keywordtype">int</span> *cols)
<a name="l00366"></a>00366 {
<a name="l00367"></a>00367    <span class="comment">// construct the local CSR matrix</span>
<a name="l00368"></a>00368    <span class="keywordtype">int</span> nnz = I[nrows];
<a name="l00369"></a>00369    hypre_CSRMatrix *local = hypre_CSRMatrixCreate(nrows, glob_ncols, nnz);
<a name="l00370"></a>00370    hypre_CSRMatrixI(local) = I;
<a name="l00371"></a>00371    hypre_CSRMatrixJ(local) = J;
<a name="l00372"></a>00372    hypre_CSRMatrixData(local) = data;
<a name="l00373"></a>00373    hypre_CSRMatrixRownnz(local) = NULL;
<a name="l00374"></a>00374    hypre_CSRMatrixOwnsData(local) = 1;
<a name="l00375"></a>00375    hypre_CSRMatrixNumRownnz(local) = nrows;
<a name="l00376"></a>00376 
<a name="l00377"></a>00377    <span class="keywordtype">int</span> part_size, myid;
<a name="l00378"></a>00378    <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())
<a name="l00379"></a>00379    {
<a name="l00380"></a>00380       myid = 0;
<a name="l00381"></a>00381       part_size = 2;
<a name="l00382"></a>00382    }
<a name="l00383"></a>00383    <span class="keywordflow">else</span>
<a name="l00384"></a>00384    {
<a name="l00385"></a>00385       MPI_Comm_rank(comm, &amp;myid);
<a name="l00386"></a>00386       MPI_Comm_size(comm, &amp;part_size);
<a name="l00387"></a>00387       part_size++;
<a name="l00388"></a>00388    }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390    <span class="comment">// copy in the row and column partitionings</span>
<a name="l00391"></a>00391    HYPRE_Int *row_starts = hypre_TAlloc(HYPRE_Int, part_size);
<a name="l00392"></a>00392    HYPRE_Int *col_starts = hypre_TAlloc(HYPRE_Int, part_size);
<a name="l00393"></a>00393    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; part_size; i++)
<a name="l00394"></a>00394    {
<a name="l00395"></a>00395       row_starts[i] = rows[i];
<a name="l00396"></a>00396       col_starts[i] = cols[i];
<a name="l00397"></a>00397    }
<a name="l00398"></a>00398 
<a name="l00399"></a>00399    <span class="comment">// construct the global ParCSR matrix</span>
<a name="l00400"></a>00400    <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = hypre_ParCSRMatrixCreate(comm, glob_nrows, glob_ncols,
<a name="l00401"></a>00401                                 row_starts, col_starts, 0, 0, 0);
<a name="l00402"></a>00402    hypre_ParCSRMatrixOwnsRowStarts(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) = 1;
<a name="l00403"></a>00403    hypre_ParCSRMatrixOwnsColStarts(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) = 1;
<a name="l00404"></a>00404    GenerateDiagAndOffd(local, <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>, col_starts[myid], col_starts[myid+1]-1);
<a name="l00405"></a>00405    hypre_ParCSRMatrixSetNumNonzeros(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00406"></a>00406    hypre_MatvecCommPkgCreate(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408    <span class="comment">// delete the local CSR matrix</span>
<a name="l00409"></a>00409    hypre_CSRMatrixI(local) = NULL;
<a name="l00410"></a>00410    hypre_CSRMatrixJ(local) = NULL;
<a name="l00411"></a>00411    hypre_CSRMatrixData(local) = NULL;
<a name="l00412"></a>00412    hypre_CSRMatrixDestroy(local);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = NULL;
<a name="l00415"></a>00415    <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a> = NULL;
<a name="l00416"></a>00416    size = <a class="code" href="classHypreParMatrix.html#af1cb1366a1423043af97fadcdb11e1e1" title="Returns the number of rows in the diagonal block of the ParCSRMatrix.">GetNumRows</a>();
<a name="l00417"></a>00417 }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#ad3822103d5bbb58260a40f59a3c4fcb4">HypreParMatrix::SetCommPkg</a>(hypre_ParCSRCommPkg *comm_pkg)
<a name="l00420"></a>00420 {
<a name="l00421"></a>00421    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = comm_pkg;
<a name="l00422"></a>00422 
<a name="l00423"></a>00423    <span class="keywordflow">if</span> (hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>))
<a name="l00424"></a>00424       hypre_MatvecCommPkgDestroy(hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>));
<a name="l00425"></a>00425 
<a name="l00426"></a>00426    hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) = comm_pkg;
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#a017c64734f32796565ecc7d1a22b9f04">HypreParMatrix::CheckCommPkg</a>()
<a name="l00430"></a>00430 {
<a name="l00431"></a>00431 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00432"></a>00432 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> == NULL || <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> != hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>))
<a name="l00433"></a>00433       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;\nHypreParMatrix::CheckCommPkg()&quot;</span>);
<a name="l00434"></a>00434 <span class="preprocessor">#endif</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span>}
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#ad0dabd3eaaa58b2274511498c9137bde">HypreParMatrix::DestroyCommPkg</a>()
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439    <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> == NULL)
<a name="l00440"></a>00440       <span class="keywordflow">return</span>;
<a name="l00441"></a>00441    hypre_TFree(<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;send_procs);
<a name="l00442"></a>00442    hypre_TFree(<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;send_map_starts);
<a name="l00443"></a>00443    hypre_TFree(<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;send_map_elmts);
<a name="l00444"></a>00444    hypre_TFree(<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;recv_procs);
<a name="l00445"></a>00445    hypre_TFree(<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;recv_vec_starts);
<a name="l00446"></a>00446    <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;send_mpi_types)
<a name="l00447"></a>00447       hypre_TFree(<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;send_mpi_types);
<a name="l00448"></a>00448    <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;recv_mpi_types)
<a name="l00449"></a>00449       hypre_TFree(<a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>-&gt;recv_mpi_types);
<a name="l00450"></a>00450    <span class="keywordflow">if</span> (hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) == <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>)
<a name="l00451"></a>00451       hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) = NULL;
<a name="l00452"></a>00452    <span class="keyword">delete</span> <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a>;
<a name="l00453"></a>00453    <a class="code" href="classHypreParMatrix.html#aa5372c817087cb9c2f1467daed67cf08" title="Internal communication object associated with A.">CommPkg</a> = NULL;
<a name="l00454"></a>00454 }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <a class="code" href="classHypreParMatrix.html#ac025c563a34b1fdcc62361f1921468b0" title="Typecasting to hypre&#39;s hypre_ParCSRMatrix*.">HypreParMatrix::operator hypre_ParCSRMatrix*</a>()
<a name="l00457"></a>00457 {
<a name="l00458"></a>00458    <span class="keywordflow">return</span> (<span class="keyword">this</span>) ? <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> : NULL;
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 <a class="code" href="classHypreParMatrix.html#a72c4ccea526ae8b63938d61939fc2561" title="Typecasting to hypre&#39;s HYPRE_ParCSRMatrix, a.k.a. void *.">HypreParMatrix::operator HYPRE_ParCSRMatrix</a>()
<a name="l00462"></a>00462 {
<a name="l00463"></a>00463    <span class="keywordflow">return</span> (<span class="keyword">this</span>) ? (HYPRE_ParCSRMatrix) <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> : (HYPRE_ParCSRMatrix) NULL;
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 hypre_ParCSRMatrix* <a class="code" href="classHypreParMatrix.html#ad9088eebaf70923f7dba257fdf6ed46c" title="Changes the ownership of the the matrix.">HypreParMatrix::StealData</a>()
<a name="l00467"></a>00467 {
<a name="l00468"></a>00468    hypre_ParCSRMatrix *R = <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>;
<a name="l00469"></a>00469    <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a> = NULL;
<a name="l00470"></a>00470    <span class="keywordflow">return</span> R;
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#afb1a2d691a61c33b33f198e7952b4df6" title="Get the diagonal of the matrix.">HypreParMatrix::GetDiag</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;diag)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475    <span class="keywordtype">int</span> size=hypre_CSRMatrixNumRows(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag);
<a name="l00476"></a>00476    diag.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(size);
<a name="l00477"></a>00477    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l00478"></a>00478    {
<a name="l00479"></a>00479       diag(j) = <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag-&gt;data[<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag-&gt;i[j]];
<a name="l00480"></a>00480 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00481"></a>00481 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag-&gt;j[<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag-&gt;i[j]] != j)
<a name="l00482"></a>00482          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;HypreParMatrix::GetDiag&quot;</span>);
<a name="l00483"></a>00483 <span class="preprocessor">#endif</span>
<a name="l00484"></a>00484 <span class="preprocessor"></span>   }
<a name="l00485"></a>00485 }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> * <a class="code" href="classHypreParMatrix.html#a6deacd4b9f03f9dc45e6168862ac720e" title="Returns the transpose of *this.">HypreParMatrix::Transpose</a>()
<a name="l00489"></a>00489 {
<a name="l00490"></a>00490    hypre_ParCSRMatrix * At;
<a name="l00491"></a>00491    hypre_ParCSRMatrixTranspose(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>, &amp;At, 1);
<a name="l00492"></a>00492    hypre_ParCSRMatrixSetNumNonzeros(At);
<a name="l00493"></a>00493 
<a name="l00494"></a>00494    hypre_MatvecCommPkgCreate(At);
<a name="l00495"></a>00495 
<a name="l00496"></a>00496    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classHypreParMatrix.html#ae3b0212596f9f9fb75d275e188fdd0d1" title="Converts hypre&#39;s format to HypreParMatrix.">HypreParMatrix</a>(At);
<a name="l00497"></a>00497 }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 <span class="keywordtype">int</span> <a class="code" href="classHypreParMatrix.html#afa879c538ec2053b43036f405c19e5a5" title="Computes y = alpha * A * x + beta * y.">HypreParMatrix::Mult</a>(<a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;x, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;y,
<a name="l00500"></a>00500                          <span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b)
<a name="l00501"></a>00501 {
<a name="l00502"></a>00502    <span class="keywordflow">return</span> hypre_ParCSRMatrixMatvec(a, <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>, x, b, y);
<a name="l00503"></a>00503 }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#afa879c538ec2053b43036f405c19e5a5" title="Computes y = alpha * A * x + beta * y.">HypreParMatrix::Mult</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;y)<span class="keyword"> const</span>
<a name="l00506"></a>00506 <span class="keyword"></span>{
<a name="l00507"></a>00507    <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> == NULL)
<a name="l00508"></a>00508    {
<a name="l00509"></a>00509       <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <span class="keyword">new</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>(<a class="code" href="classHypreParMatrix.html#a84335af6cbce3b570286ad272ad96f0d">GetGlobalNumCols</a>(),
<a name="l00510"></a>00510                              x.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l00511"></a>00511                              <a class="code" href="classHypreParMatrix.html#aaf11718ed6c23ea57a5ae80eb0b080ce">GetColStarts</a>());
<a name="l00512"></a>00512       <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a> = <span class="keyword">new</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>(<a class="code" href="classHypreParMatrix.html#aedb6237fd215108472cc3820fa4f7df2">GetGlobalNumRows</a>(),
<a name="l00513"></a>00513                              y.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l00514"></a>00514                              <a class="code" href="classHypreParMatrix.html#aed3fa0063ce9d04fccd950bff0a413e3">GetRowStarts</a>());
<a name="l00515"></a>00515    }
<a name="l00516"></a>00516    <span class="keywordflow">else</span>
<a name="l00517"></a>00517    {
<a name="l00518"></a>00518       <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> -&gt; SetData(x.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>());
<a name="l00519"></a>00519       Y -&gt; SetData(y.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>());
<a name="l00520"></a>00520    }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522    hypre_ParCSRMatrixMatvec(1.0, <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>, *<a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a>, 0.0, *Y);
<a name="l00523"></a>00523 }
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#adfdf37d34e181809bbd7d3aa41653d91" title="Computes y = alpha * A^t * x + beta * y.">HypreParMatrix::MultTranspose</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;y)<span class="keyword"> const</span>
<a name="l00526"></a>00526 <span class="keyword"></span>{
<a name="l00527"></a>00527    <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> == NULL)
<a name="l00528"></a>00528    {
<a name="l00529"></a>00529       <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> = <span class="keyword">new</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>(<a class="code" href="classHypreParMatrix.html#a84335af6cbce3b570286ad272ad96f0d">GetGlobalNumCols</a>(),
<a name="l00530"></a>00530                              x.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l00531"></a>00531                              <a class="code" href="classHypreParMatrix.html#aaf11718ed6c23ea57a5ae80eb0b080ce">GetColStarts</a>());
<a name="l00532"></a>00532       Y = <span class="keyword">new</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>(<a class="code" href="classHypreParMatrix.html#aedb6237fd215108472cc3820fa4f7df2">GetGlobalNumRows</a>(),
<a name="l00533"></a>00533                              y.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l00534"></a>00534                              <a class="code" href="classHypreParMatrix.html#aed3fa0063ce9d04fccd950bff0a413e3">GetRowStarts</a>());
<a name="l00535"></a>00535    }
<a name="l00536"></a>00536    <span class="keywordflow">else</span>
<a name="l00537"></a>00537    {
<a name="l00538"></a>00538       <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a> -&gt; SetData(x.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>());
<a name="l00539"></a>00539       Y -&gt; SetData(y.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>());
<a name="l00540"></a>00540    }
<a name="l00541"></a>00541 
<a name="l00542"></a>00542    hypre_ParCSRMatrixMatvecT(1.0, <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>, *<a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a>, 0.0, *Y);
<a name="l00543"></a>00543 }
<a name="l00544"></a>00544 
<a name="l00545"></a>00545 <span class="keywordtype">int</span> <a class="code" href="classHypreParMatrix.html#afa879c538ec2053b43036f405c19e5a5" title="Computes y = alpha * A * x + beta * y.">HypreParMatrix::Mult</a>(HYPRE_ParVector x, HYPRE_ParVector y,
<a name="l00546"></a>00546                          <span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b)
<a name="l00547"></a>00547 {
<a name="l00548"></a>00548    <span class="keywordflow">return</span> hypre_ParCSRMatrixMatvec(a,<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,(hypre_ParVector *)x,b,(hypre_ParVector *)y);
<a name="l00549"></a>00549 }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 <span class="keywordtype">int</span> <a class="code" href="classHypreParMatrix.html#adfdf37d34e181809bbd7d3aa41653d91" title="Computes y = alpha * A^t * x + beta * y.">HypreParMatrix::MultTranspose</a>(<a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp; x, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp; y,
<a name="l00552"></a>00552                                   <span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b)
<a name="l00553"></a>00553 {
<a name="l00554"></a>00554    <span class="keywordflow">return</span> hypre_ParCSRMatrixMatvecT(a,<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,x,b,y);
<a name="l00555"></a>00555 }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#a9f400a2a3da2ccf6b7fd4eaf80550658" title="Prints the locally owned rows in parallel.">HypreParMatrix::Print</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keywordtype">int</span> offi, <span class="keywordtype">int</span> offj)
<a name="l00558"></a>00558 {
<a name="l00559"></a>00559    hypre_ParCSRMatrixPrintIJ(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>,offi,offj,fname);
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 <span class="keywordtype">void</span> <a class="code" href="classHypreParMatrix.html#a11bf99adc6b0c570665147a3651306d3" title="Reads the matrix from a file.">HypreParMatrix::Read</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname)
<a name="l00563"></a>00563 {
<a name="l00564"></a>00564    <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) hypre_ParCSRMatrixDestroy(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00565"></a>00565    <span class="keywordtype">int</span> io,jo;
<a name="l00566"></a>00566    hypre_ParCSRMatrixReadIJ(MPI_COMM_WORLD, fname, &amp;io, &amp;jo, &amp;<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00567"></a>00567    hypre_ParCSRMatrixSetNumNonzeros(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00568"></a>00568 
<a name="l00569"></a>00569    hypre_MatvecCommPkgCreate(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00570"></a>00570 }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572 <a class="code" href="classHypreParMatrix.html#aca4e5e844c1ded03f28d7c4d1ac6f7f3" title="Calls hypre&#39;s destroy function.">HypreParMatrix::~HypreParMatrix</a>()
<a name="l00573"></a>00573 {
<a name="l00574"></a>00574    <a class="code" href="classHypreParMatrix.html#ad0dabd3eaaa58b2274511498c9137bde">DestroyCommPkg</a>();
<a name="l00575"></a>00575 
<a name="l00576"></a>00576    <span class="keywordflow">if</span> (<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>)
<a name="l00577"></a>00577    {
<a name="l00578"></a>00578       <span class="keywordflow">if</span> (hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>))
<a name="l00579"></a>00579          hypre_MatvecCommPkgDestroy(hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>));
<a name="l00580"></a>00580       hypre_ParCSRMatrixCommPkg(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>) = NULL;
<a name="l00581"></a>00581 
<a name="l00582"></a>00582       <span class="keywordflow">if</span> (hypre_CSRMatrixOwnsData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag))
<a name="l00583"></a>00583       {
<a name="l00584"></a>00584          hypre_CSRMatrixDestroy(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag);
<a name="l00585"></a>00585          <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag = NULL;
<a name="l00586"></a>00586       }
<a name="l00587"></a>00587       <span class="keywordflow">else</span>
<a name="l00588"></a>00588       {
<a name="l00589"></a>00589          <span class="keywordflow">if</span> (hypre_CSRMatrixRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag))
<a name="l00590"></a>00590             hypre_TFree(hypre_CSRMatrixRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag));
<a name="l00591"></a>00591          hypre_TFree(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag);
<a name="l00592"></a>00592          <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;diag = NULL;
<a name="l00593"></a>00593       }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595       <span class="keywordflow">if</span> (hypre_CSRMatrixOwnsData(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd))
<a name="l00596"></a>00596       {
<a name="l00597"></a>00597          hypre_CSRMatrixDestroy(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd);
<a name="l00598"></a>00598          <a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd = NULL;
<a name="l00599"></a>00599       }
<a name="l00600"></a>00600       <span class="keywordflow">else</span>
<a name="l00601"></a>00601       {
<a name="l00602"></a>00602          <span class="keywordflow">if</span> (hypre_CSRMatrixRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd))
<a name="l00603"></a>00603             hypre_TFree(hypre_CSRMatrixRownnz(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>-&gt;offd));
<a name="l00604"></a>00604       }
<a name="l00605"></a>00605       hypre_ParCSRMatrixDestroy(<a class="code" href="classHypreParMatrix.html#a40051b0e72d86b44a468fe73f5124f68" title="The actual object.">A</a>);
<a name="l00606"></a>00606    }
<a name="l00607"></a>00607 
<a name="l00608"></a>00608    <span class="keyword">delete</span> <a class="code" href="classHypreParMatrix.html#a353f0a33391fa0b19a875b9edb06863b" title="Auxiliary vectors for typecasting.">X</a>;
<a name="l00609"></a>00609    <span class="keyword">delete</span> <a class="code" href="classHypreParMatrix.html#add591d20a00aa06d9c54985b5c558ede">Y</a>;
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> * <a class="code" href="hypre_8hpp.html#a67a5d7b480c7c62b9aa47b3c02a697fa" title="Returns the matrix A * B.">ParMult</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> *A, <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> *B)
<a name="l00613"></a>00613 {
<a name="l00614"></a>00614    hypre_ParCSRMatrix * ab;
<a name="l00615"></a>00615    ab = hypre_ParMatmul(*A,*B);
<a name="l00616"></a>00616 
<a name="l00617"></a>00617    hypre_MatvecCommPkgCreate(ab);
<a name="l00618"></a>00618 
<a name="l00619"></a>00619    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a>(ab);
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> * <a class="code" href="hypre_8hpp.html#a28a54d4215a329971ea527527e44939d" title="Returns the matrix P^t * A * P.">RAP</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> *A, <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> *P)
<a name="l00623"></a>00623 {
<a name="l00624"></a>00624    <span class="keywordtype">int</span> P_owns_its_col_starts =
<a name="l00625"></a>00625       hypre_ParCSRMatrixOwnsColStarts((hypre_ParCSRMatrix*)(*P));
<a name="l00626"></a>00626    hypre_ParCSRMatrix * rap;
<a name="l00627"></a>00627    hypre_BoomerAMGBuildCoarseOperator(*P,*A,*P,&amp;rap);
<a name="l00628"></a>00628 
<a name="l00629"></a>00629    hypre_ParCSRMatrixSetNumNonzeros(rap);
<a name="l00630"></a>00630    <span class="comment">// hypre_MatvecCommPkgCreate(rap);</span>
<a name="l00631"></a>00631    <span class="keywordflow">if</span> (!P_owns_its_col_starts)
<a name="l00632"></a>00632    {
<a name="l00633"></a>00633       <span class="comment">/* Warning: hypre_BoomerAMGBuildCoarseOperator steals the col_starts</span>
<a name="l00634"></a>00634 <span class="comment">         from P (even if it does not own them)! */</span>
<a name="l00635"></a>00635       hypre_ParCSRMatrixSetRowStartsOwner(rap,0);
<a name="l00636"></a>00636       hypre_ParCSRMatrixSetColStartsOwner(rap,0);
<a name="l00637"></a>00637    }
<a name="l00638"></a>00638    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a>(rap);
<a name="l00639"></a>00639 }
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 <span class="keywordtype">void</span> <a class="code" href="hypre_8hpp.html#af5f7571e32d3eb937073389f75d9ce21">EliminateBC</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;A, <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;Ae,
<a name="l00642"></a>00642                  <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;ess_dof_list,
<a name="l00643"></a>00643                  <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;x, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;b)
<a name="l00644"></a>00644 {
<a name="l00645"></a>00645    <span class="comment">// b -= Ae*x</span>
<a name="l00646"></a>00646    Ae.<a class="code" href="classHypreParMatrix.html#afa879c538ec2053b43036f405c19e5a5" title="Computes y = alpha * A * x + beta * y.">Mult</a>(x, b, -1.0, 1.0);
<a name="l00647"></a>00647 
<a name="l00648"></a>00648    hypre_CSRMatrix *A_diag = hypre_ParCSRMatrixDiag((hypre_ParCSRMatrix *)A);
<a name="l00649"></a>00649    <span class="keywordtype">double</span> *data = hypre_CSRMatrixData(A_diag);
<a name="l00650"></a>00650    <span class="keywordtype">int</span>    *I    = hypre_CSRMatrixI(A_diag);
<a name="l00651"></a>00651 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00652"></a>00652 <span class="preprocessor"></span>   <span class="keywordtype">int</span>    *J    = hypre_CSRMatrixJ(A_diag);
<a name="l00653"></a>00653    <span class="keywordtype">int</span> *I_offd  =
<a name="l00654"></a>00654       hypre_CSRMatrixI(hypre_ParCSRMatrixOffd((hypre_ParCSRMatrix *)A));
<a name="l00655"></a>00655 <span class="preprocessor">#endif</span>
<a name="l00656"></a>00656 <span class="preprocessor"></span>
<a name="l00657"></a>00657    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ess_dof_list.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00658"></a>00658    {
<a name="l00659"></a>00659       <span class="keywordtype">int</span> r = ess_dof_list[i];
<a name="l00660"></a>00660       b(r) = data[I[r]] * x(r);
<a name="l00661"></a>00661 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00662"></a>00662 <span class="preprocessor"></span>      <span class="comment">// Check that in the rows specified by the ess_dof_list, the matrix A has</span>
<a name="l00663"></a>00663       <span class="comment">// only one entry -- the diagonal.</span>
<a name="l00664"></a>00664       <span class="keywordflow">if</span> (I[r+1] != I[r]+1 || J[I[r]] != r || I_offd[r] != I_offd[r+1])
<a name="l00665"></a>00665          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;EliminateBC (hypre.cpp)&quot;</span>);
<a name="l00666"></a>00666 <span class="preprocessor">#endif</span>
<a name="l00667"></a>00667 <span class="preprocessor"></span>   }
<a name="l00668"></a>00668 }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 
<a name="l00671"></a>00671 <a class="code" href="classHypreSolver.html#a3c23584085442dea23813430bfdb8319">HypreSolver::HypreSolver</a>()
<a name="l00672"></a>00672 {
<a name="l00673"></a>00673    size = 0;
<a name="l00674"></a>00674 
<a name="l00675"></a>00675    A = NULL;
<a name="l00676"></a>00676    <a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a> = 0;
<a name="l00677"></a>00677    <a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a> = <a class="code" href="classHypreSolver.html#a03c3ad9e98feebbb28ff5f07dc688478">X</a> = NULL;
<a name="l00678"></a>00678 }
<a name="l00679"></a>00679 
<a name="l00680"></a>00680 <a class="code" href="classHypreSolver.html#a3c23584085442dea23813430bfdb8319">HypreSolver::HypreSolver</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> *_A)
<a name="l00681"></a>00681 {
<a name="l00682"></a>00682    size = _A -&gt; GetNumRows();
<a name="l00683"></a>00683 
<a name="l00684"></a>00684    A = _A;
<a name="l00685"></a>00685    <a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a> = 0;
<a name="l00686"></a>00686    <a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a> = <a class="code" href="classHypreSolver.html#a03c3ad9e98feebbb28ff5f07dc688478">X</a> = NULL;
<a name="l00687"></a>00687 }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689 <span class="keywordtype">void</span> <a class="code" href="classHypreSolver.html#a873629c6575abc84d70e4f5a649652fd" title="Solve the linear system Ax=b.">HypreSolver::Mult</a>(<span class="keyword">const</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;b, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;x)<span class="keyword"> const</span>
<a name="l00690"></a>00690 <span class="keyword"></span>{
<a name="l00691"></a>00691    <span class="keywordflow">if</span> (A == NULL)
<a name="l00692"></a>00692    {
<a name="l00693"></a>00693       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;HypreSolver::Mult (...) : HypreParMatrix A is missing&quot;</span>);
<a name="l00694"></a>00694       <span class="keywordflow">return</span>;
<a name="l00695"></a>00695    }
<a name="l00696"></a>00696    <span class="keywordflow">if</span> (!<a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a>)
<a name="l00697"></a>00697    {
<a name="l00698"></a>00698       <a class="code" href="classHypreSolver.html#a0d88449fc278c7faa6eacb476550d218" title="hypre&#39;s internal Setup function">SetupFcn</a>()(*<span class="keyword">this</span>, *<a class="code" href="classHypreSolver.html#a48bf10954d2874da3406265e80d04a7e" title="The linear system matrix.">A</a>, b, x);
<a name="l00699"></a>00699       <a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a> = 1;
<a name="l00700"></a>00700    }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702    <a class="code" href="classHypreSolver.html#a0acb48a83e99e048e5db6af4b8974b59" title="hypre&#39;s internal Solve function">SolveFcn</a>()(*<span class="keyword">this</span>, *<a class="code" href="classHypreSolver.html#a48bf10954d2874da3406265e80d04a7e" title="The linear system matrix.">A</a>, b, x);
<a name="l00703"></a>00703 }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 <span class="keywordtype">void</span> <a class="code" href="classHypreSolver.html#a873629c6575abc84d70e4f5a649652fd" title="Solve the linear system Ax=b.">HypreSolver::Mult</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;b, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;x)<span class="keyword"> const</span>
<a name="l00706"></a>00706 <span class="keyword"></span>{
<a name="l00707"></a>00707    <span class="keywordflow">if</span> (A == NULL)
<a name="l00708"></a>00708    {
<a name="l00709"></a>00709       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;HypreSolver::Mult (...) : HypreParMatrix A is missing&quot;</span>);
<a name="l00710"></a>00710       <span class="keywordflow">return</span>;
<a name="l00711"></a>00711    }
<a name="l00712"></a>00712    <span class="keywordflow">if</span> (<a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a> == NULL)
<a name="l00713"></a>00713    {
<a name="l00714"></a>00714       <a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a> = <span class="keyword">new</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>(A -&gt; GetGlobalNumRows(),
<a name="l00715"></a>00715                              b.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l00716"></a>00716                              A -&gt; GetRowStarts());
<a name="l00717"></a>00717       <a class="code" href="classHypreSolver.html#a03c3ad9e98feebbb28ff5f07dc688478">X</a> = <span class="keyword">new</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a>(A -&gt; GetGlobalNumCols(),
<a name="l00718"></a>00718                              x.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l00719"></a>00719                              A -&gt; GetColStarts());
<a name="l00720"></a>00720    }
<a name="l00721"></a>00721    <span class="keywordflow">else</span>
<a name="l00722"></a>00722    {
<a name="l00723"></a>00723       <a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a> -&gt; SetData(b.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>());
<a name="l00724"></a>00724       X -&gt; SetData(x.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>());
<a name="l00725"></a>00725    }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727    <a class="code" href="classHypreSolver.html#a873629c6575abc84d70e4f5a649652fd" title="Solve the linear system Ax=b.">Mult</a>(*<a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a>, *X);
<a name="l00728"></a>00728 }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 <a class="code" href="classHypreSolver.html#aeb844a18d8f54a0e2b0e6c34c26e9cda">HypreSolver::~HypreSolver</a>()
<a name="l00731"></a>00731 {
<a name="l00732"></a>00732    <span class="keywordflow">if</span> (<a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a>) <span class="keyword">delete</span> <a class="code" href="classHypreSolver.html#ad82d7436fd5856f7ce287a431db5d541" title="Right-hand side and solution vector.">B</a>;
<a name="l00733"></a>00733    <span class="keywordflow">if</span> (X) <span class="keyword">delete</span> <a class="code" href="classHypreSolver.html#a03c3ad9e98feebbb28ff5f07dc688478">X</a>;
<a name="l00734"></a>00734 }
<a name="l00735"></a>00735 
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 <a class="code" href="classHyprePCG.html#a32fb41f878f624d4c0c85b85a8de0729">HyprePCG::HyprePCG</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;_A) : <a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a>(&amp;_A)
<a name="l00738"></a>00738 {
<a name="l00739"></a>00739    MPI_Comm comm;
<a name="l00740"></a>00740 
<a name="l00741"></a>00741    print_level = 0;
<a name="l00742"></a>00742    use_zero_initial_iterate = 0;
<a name="l00743"></a>00743 
<a name="l00744"></a>00744    HYPRE_ParCSRMatrixGetComm(*A, &amp;comm);
<a name="l00745"></a>00745 
<a name="l00746"></a>00746    HYPRE_ParCSRPCGCreate(comm, &amp;pcg_solver);
<a name="l00747"></a>00747 }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749 <span class="keywordtype">void</span> <a class="code" href="classHyprePCG.html#acb4c1fe6a3addccb48bf8524cc0c2bec">HyprePCG::SetTol</a>(<span class="keywordtype">double</span> tol)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751    HYPRE_ParCSRPCGSetTol(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, tol);
<a name="l00752"></a>00752 }
<a name="l00753"></a>00753 
<a name="l00754"></a>00754 <span class="keywordtype">void</span> <a class="code" href="classHyprePCG.html#aba8948cc7f5bb22438db30bc3a9abf64">HyprePCG::SetMaxIter</a>(<span class="keywordtype">int</span> max_iter)
<a name="l00755"></a>00755 {
<a name="l00756"></a>00756    HYPRE_ParCSRPCGSetMaxIter(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, max_iter);
<a name="l00757"></a>00757 }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 <span class="keywordtype">void</span> <a class="code" href="classHyprePCG.html#aedf1b14e744d87c5bd6259c8a4d8b7e8">HyprePCG::SetLogging</a>(<span class="keywordtype">int</span> logging)
<a name="l00760"></a>00760 {
<a name="l00761"></a>00761    HYPRE_ParCSRPCGSetLogging(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, logging);
<a name="l00762"></a>00762 }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764 <span class="keywordtype">void</span> <a class="code" href="classHyprePCG.html#afcde200456322e7e51e7c9ac6276a6d2">HyprePCG::SetPrintLevel</a>(<span class="keywordtype">int</span> print_lvl)
<a name="l00765"></a>00765 {
<a name="l00766"></a>00766    <a class="code" href="classHyprePCG.html#a7814b70afc23b2b53497bf183dc040a7">print_level</a> = print_lvl;
<a name="l00767"></a>00767    HYPRE_ParCSRPCGSetPrintLevel(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, <a class="code" href="classHyprePCG.html#a7814b70afc23b2b53497bf183dc040a7">print_level</a>);
<a name="l00768"></a>00768 }
<a name="l00769"></a>00769 
<a name="l00770"></a>00770 <span class="keywordtype">void</span> <a class="code" href="classHyprePCG.html#a9e8a3ab4eca497899cc105d2088edb95" title="Set the hypre solver to be used as a preconditioner.">HyprePCG::SetPreconditioner</a>(<a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a> &amp;precond)
<a name="l00771"></a>00771 {
<a name="l00772"></a>00772    HYPRE_ParCSRPCGSetPrecond(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>,
<a name="l00773"></a>00773                              precond.<a class="code" href="classHypreSolver.html#a0acb48a83e99e048e5db6af4b8974b59" title="hypre&#39;s internal Solve function">SolveFcn</a>(),
<a name="l00774"></a>00774                              precond.<a class="code" href="classHypreSolver.html#a0d88449fc278c7faa6eacb476550d218" title="hypre&#39;s internal Setup function">SetupFcn</a>(),
<a name="l00775"></a>00775                              precond);
<a name="l00776"></a>00776 }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 <span class="keywordtype">void</span> <a class="code" href="classHyprePCG.html#ab4f0b7ac7ea8bbbeaf7e32a1e66eeb2c">HyprePCG::SetResidualConvergenceOptions</a>(<span class="keywordtype">int</span> res_frequency, <span class="keywordtype">double</span> rtol)
<a name="l00779"></a>00779 {
<a name="l00780"></a>00780    HYPRE_PCGSetTwoNorm(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, 1);
<a name="l00781"></a>00781    <span class="keywordflow">if</span> (res_frequency &gt; 0)
<a name="l00782"></a>00782       HYPRE_PCGSetRecomputeResidualP(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, res_frequency);
<a name="l00783"></a>00783    <span class="keywordflow">if</span> (rtol &gt; 0.0)
<a name="l00784"></a>00784       HYPRE_PCGSetResidualTol(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, rtol);
<a name="l00785"></a>00785 }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 <span class="keywordtype">void</span> <a class="code" href="classHyprePCG.html#aaded11183cc28d5a43268e43570c78ba" title="Solve Ax=b with hypre&#39;s PCG.">HyprePCG::Mult</a>(<span class="keyword">const</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;b, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;x)<span class="keyword"> const</span>
<a name="l00788"></a>00788 <span class="keyword"></span>{
<a name="l00789"></a>00789    <span class="keywordtype">int</span> myid;
<a name="l00790"></a>00790    <span class="keywordtype">int</span> time_index;
<a name="l00791"></a>00791    <span class="keywordtype">int</span> num_iterations;
<a name="l00792"></a>00792    <span class="keywordtype">double</span> final_res_norm;
<a name="l00793"></a>00793    MPI_Comm comm;
<a name="l00794"></a>00794 
<a name="l00795"></a>00795    HYPRE_ParCSRMatrixGetComm(*A, &amp;comm);
<a name="l00796"></a>00796 
<a name="l00797"></a>00797    <span class="keywordflow">if</span> (!<a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a>)
<a name="l00798"></a>00798    {
<a name="l00799"></a>00799       <span class="keywordflow">if</span> (<a class="code" href="classHyprePCG.html#a7814b70afc23b2b53497bf183dc040a7">print_level</a> &gt; 0)
<a name="l00800"></a>00800       {
<a name="l00801"></a>00801          time_index = hypre_InitializeTiming(<span class="stringliteral">&quot;PCG Setup&quot;</span>);
<a name="l00802"></a>00802          hypre_BeginTiming(time_index);
<a name="l00803"></a>00803       }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805       HYPRE_ParCSRPCGSetup(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, *A, b, x);
<a name="l00806"></a>00806       <a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a> = 1;
<a name="l00807"></a>00807 
<a name="l00808"></a>00808       <span class="keywordflow">if</span> (<a class="code" href="classHyprePCG.html#a7814b70afc23b2b53497bf183dc040a7">print_level</a> &gt; 0)
<a name="l00809"></a>00809       {
<a name="l00810"></a>00810          hypre_EndTiming(time_index);
<a name="l00811"></a>00811          hypre_PrintTiming(<span class="stringliteral">&quot;Setup phase times&quot;</span>, comm);
<a name="l00812"></a>00812          hypre_FinalizeTiming(time_index);
<a name="l00813"></a>00813          hypre_ClearTiming();
<a name="l00814"></a>00814       }
<a name="l00815"></a>00815    }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817    <span class="keywordflow">if</span> (<a class="code" href="classHyprePCG.html#a7814b70afc23b2b53497bf183dc040a7">print_level</a> &gt; 0)
<a name="l00818"></a>00818    {
<a name="l00819"></a>00819       time_index = hypre_InitializeTiming(<span class="stringliteral">&quot;PCG Solve&quot;</span>);
<a name="l00820"></a>00820       hypre_BeginTiming(time_index);
<a name="l00821"></a>00821    }
<a name="l00822"></a>00822 
<a name="l00823"></a>00823    <span class="keywordflow">if</span> (<a class="code" href="classHyprePCG.html#a7f9057e03342230474176e94dfe3e48c">use_zero_initial_iterate</a>)
<a name="l00824"></a>00824       x = 0.0;
<a name="l00825"></a>00825 
<a name="l00826"></a>00826    HYPRE_ParCSRPCGSolve(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, *A, b, x);
<a name="l00827"></a>00827 
<a name="l00828"></a>00828    <span class="keywordflow">if</span> (<a class="code" href="classHyprePCG.html#a7814b70afc23b2b53497bf183dc040a7">print_level</a> &gt; 0)
<a name="l00829"></a>00829    {
<a name="l00830"></a>00830       hypre_EndTiming(time_index);
<a name="l00831"></a>00831       hypre_PrintTiming(<span class="stringliteral">&quot;Solve phase times&quot;</span>, comm);
<a name="l00832"></a>00832       hypre_FinalizeTiming(time_index);
<a name="l00833"></a>00833       hypre_ClearTiming();
<a name="l00834"></a>00834 
<a name="l00835"></a>00835       HYPRE_ParCSRPCGGetNumIterations(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>, &amp;num_iterations);
<a name="l00836"></a>00836       HYPRE_ParCSRPCGGetFinalRelativeResidualNorm(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>,
<a name="l00837"></a>00837                                                   &amp;final_res_norm);
<a name="l00838"></a>00838 
<a name="l00839"></a>00839       MPI_Comm_rank(comm, &amp;myid);
<a name="l00840"></a>00840 
<a name="l00841"></a>00841       <span class="keywordflow">if</span> (myid == 0)
<a name="l00842"></a>00842       {
<a name="l00843"></a>00843          cout &lt;&lt; <span class="stringliteral">&quot;PCG Iterations = &quot;</span> &lt;&lt; num_iterations &lt;&lt; endl
<a name="l00844"></a>00844               &lt;&lt; <span class="stringliteral">&quot;Final PCG Relative Residual Norm = &quot;</span> &lt;&lt; final_res_norm
<a name="l00845"></a>00845               &lt;&lt; endl;
<a name="l00846"></a>00846       }
<a name="l00847"></a>00847    }
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <a class="code" href="classHyprePCG.html#a350b2485a39c995323e37847ddb2351e">HyprePCG::~HyprePCG</a>()
<a name="l00851"></a>00851 {
<a name="l00852"></a>00852    HYPRE_ParCSRPCGDestroy(<a class="code" href="classHyprePCG.html#afe8418d6e4b0548be4c2c9139c9f8de9">pcg_solver</a>);
<a name="l00853"></a>00853 }
<a name="l00854"></a>00854 
<a name="l00855"></a>00855 
<a name="l00856"></a>00856 <a class="code" href="classHypreGMRES.html#a85b8e2660c10e0b65bc41f1fea9e4dc1">HypreGMRES::HypreGMRES</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;_A) : <a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a>(&amp;_A)
<a name="l00857"></a>00857 {
<a name="l00858"></a>00858    MPI_Comm comm;
<a name="l00859"></a>00859 
<a name="l00860"></a>00860    <span class="keywordtype">int</span> k_dim    = 50;
<a name="l00861"></a>00861    <span class="keywordtype">int</span> max_iter = 100;
<a name="l00862"></a>00862    <span class="keywordtype">double</span> tol   = 1e-6;
<a name="l00863"></a>00863 
<a name="l00864"></a>00864    print_level = 0;
<a name="l00865"></a>00865    use_zero_initial_iterate = 0;
<a name="l00866"></a>00866 
<a name="l00867"></a>00867    HYPRE_ParCSRMatrixGetComm(*A, &amp;comm);
<a name="l00868"></a>00868 
<a name="l00869"></a>00869    HYPRE_ParCSRGMRESCreate(comm, &amp;gmres_solver);
<a name="l00870"></a>00870    HYPRE_ParCSRGMRESSetKDim(gmres_solver, k_dim);
<a name="l00871"></a>00871    HYPRE_ParCSRGMRESSetMaxIter(gmres_solver, max_iter);
<a name="l00872"></a>00872    HYPRE_ParCSRGMRESSetTol(gmres_solver, tol);
<a name="l00873"></a>00873 }
<a name="l00874"></a>00874 
<a name="l00875"></a>00875 <span class="keywordtype">void</span> <a class="code" href="classHypreGMRES.html#a86e97797376ca4adf4fe34a4c9379103">HypreGMRES::SetTol</a>(<span class="keywordtype">double</span> tol)
<a name="l00876"></a>00876 {
<a name="l00877"></a>00877    HYPRE_ParCSRGMRESSetTol(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, tol);
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880 <span class="keywordtype">void</span> <a class="code" href="classHypreGMRES.html#aa79b69b547271595df306dc91d5bfe5e">HypreGMRES::SetMaxIter</a>(<span class="keywordtype">int</span> max_iter)
<a name="l00881"></a>00881 {
<a name="l00882"></a>00882    HYPRE_ParCSRGMRESSetMaxIter(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, max_iter);
<a name="l00883"></a>00883 }
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 <span class="keywordtype">void</span> <a class="code" href="classHypreGMRES.html#a6a2c9bb81408839b09abe1ef8c29334c">HypreGMRES::SetKDim</a>(<span class="keywordtype">int</span> k_dim)
<a name="l00886"></a>00886 {
<a name="l00887"></a>00887    HYPRE_ParCSRGMRESSetKDim(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, k_dim);
<a name="l00888"></a>00888 }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890 <span class="keywordtype">void</span> <a class="code" href="classHypreGMRES.html#a482cc77f3be37d337796a43b79b399e4">HypreGMRES::SetLogging</a>(<span class="keywordtype">int</span> logging)
<a name="l00891"></a>00891 {
<a name="l00892"></a>00892    HYPRE_ParCSRGMRESSetLogging(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, logging);
<a name="l00893"></a>00893 }
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 <span class="keywordtype">void</span> <a class="code" href="classHypreGMRES.html#a137a47455c0762c55c85322e5bdd24b9">HypreGMRES::SetPrintLevel</a>(<span class="keywordtype">int</span> print_lvl)
<a name="l00896"></a>00896 {
<a name="l00897"></a>00897    <a class="code" href="classHypreGMRES.html#a65b89d5ec20e21a5e9438c108eabbf04">print_level</a> = print_lvl;
<a name="l00898"></a>00898    HYPRE_ParCSRGMRESSetPrintLevel(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, <a class="code" href="classHypreGMRES.html#a65b89d5ec20e21a5e9438c108eabbf04">print_level</a>);
<a name="l00899"></a>00899 }
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 <span class="keywordtype">void</span> <a class="code" href="classHypreGMRES.html#a6635c24ada49fd26b321a95e856a48c7" title="Set the hypre solver to be used as a preconditioner.">HypreGMRES::SetPreconditioner</a>(<a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a> &amp;precond)
<a name="l00902"></a>00902 {
<a name="l00903"></a>00903    HYPRE_ParCSRGMRESSetPrecond(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>,
<a name="l00904"></a>00904                                precond.<a class="code" href="classHypreSolver.html#a0acb48a83e99e048e5db6af4b8974b59" title="hypre&#39;s internal Solve function">SolveFcn</a>(),
<a name="l00905"></a>00905                                precond.<a class="code" href="classHypreSolver.html#a0d88449fc278c7faa6eacb476550d218" title="hypre&#39;s internal Setup function">SetupFcn</a>(),
<a name="l00906"></a>00906                                precond);
<a name="l00907"></a>00907 }
<a name="l00908"></a>00908 
<a name="l00909"></a>00909 <span class="keywordtype">void</span> <a class="code" href="classHypreGMRES.html#a1f877a8e3242e9a4dfaa9eecdc97438c" title="Solve Ax=b with hypre&#39;s GMRES.">HypreGMRES::Mult</a>(<span class="keyword">const</span> <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;b, <a class="code" href="classHypreParVector.html" title="Wrapper for hypre&#39;s parallel vector class.">HypreParVector</a> &amp;x)<span class="keyword"> const</span>
<a name="l00910"></a>00910 <span class="keyword"></span>{
<a name="l00911"></a>00911    <span class="keywordtype">int</span> myid;
<a name="l00912"></a>00912    <span class="keywordtype">int</span> time_index;
<a name="l00913"></a>00913    <span class="keywordtype">int</span> num_iterations;
<a name="l00914"></a>00914    <span class="keywordtype">double</span> final_res_norm;
<a name="l00915"></a>00915    MPI_Comm comm;
<a name="l00916"></a>00916 
<a name="l00917"></a>00917    HYPRE_ParCSRMatrixGetComm(*A, &amp;comm);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919    <span class="keywordflow">if</span> (!<a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a>)
<a name="l00920"></a>00920    {
<a name="l00921"></a>00921       <span class="keywordflow">if</span> (<a class="code" href="classHypreGMRES.html#a65b89d5ec20e21a5e9438c108eabbf04">print_level</a> &gt; 0)
<a name="l00922"></a>00922       {
<a name="l00923"></a>00923          time_index = hypre_InitializeTiming(<span class="stringliteral">&quot;GMRES Setup&quot;</span>);
<a name="l00924"></a>00924          hypre_BeginTiming(time_index);
<a name="l00925"></a>00925       }
<a name="l00926"></a>00926 
<a name="l00927"></a>00927       HYPRE_ParCSRGMRESSetup(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, *A, b, x);
<a name="l00928"></a>00928       <a class="code" href="classHypreSolver.html#a8e3d0a9756127924a0dfde6dc6ce9862" title="Was hypre&#39;s Setup function called already?">setup_called</a> = 1;
<a name="l00929"></a>00929 
<a name="l00930"></a>00930       <span class="keywordflow">if</span> (<a class="code" href="classHypreGMRES.html#a65b89d5ec20e21a5e9438c108eabbf04">print_level</a> &gt; 0)
<a name="l00931"></a>00931       {
<a name="l00932"></a>00932          hypre_EndTiming(time_index);
<a name="l00933"></a>00933          hypre_PrintTiming(<span class="stringliteral">&quot;Setup phase times&quot;</span>, comm);
<a name="l00934"></a>00934          hypre_FinalizeTiming(time_index);
<a name="l00935"></a>00935          hypre_ClearTiming();
<a name="l00936"></a>00936       }
<a name="l00937"></a>00937    }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939    <span class="keywordflow">if</span> (<a class="code" href="classHypreGMRES.html#a65b89d5ec20e21a5e9438c108eabbf04">print_level</a> &gt; 0)
<a name="l00940"></a>00940    {
<a name="l00941"></a>00941       time_index = hypre_InitializeTiming(<span class="stringliteral">&quot;GMRES Solve&quot;</span>);
<a name="l00942"></a>00942       hypre_BeginTiming(time_index);
<a name="l00943"></a>00943    }
<a name="l00944"></a>00944 
<a name="l00945"></a>00945    <span class="keywordflow">if</span> (<a class="code" href="classHypreGMRES.html#a4f26623991c62cac2108994722843d90">use_zero_initial_iterate</a>)
<a name="l00946"></a>00946       x = 0.0;
<a name="l00947"></a>00947 
<a name="l00948"></a>00948    HYPRE_ParCSRGMRESSolve(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, *A, b, x);
<a name="l00949"></a>00949 
<a name="l00950"></a>00950    <span class="keywordflow">if</span> (<a class="code" href="classHypreGMRES.html#a65b89d5ec20e21a5e9438c108eabbf04">print_level</a> &gt; 0)
<a name="l00951"></a>00951    {
<a name="l00952"></a>00952       hypre_EndTiming(time_index);
<a name="l00953"></a>00953       hypre_PrintTiming(<span class="stringliteral">&quot;Solve phase times&quot;</span>, comm);
<a name="l00954"></a>00954       hypre_FinalizeTiming(time_index);
<a name="l00955"></a>00955       hypre_ClearTiming();
<a name="l00956"></a>00956 
<a name="l00957"></a>00957       HYPRE_ParCSRGMRESGetNumIterations(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>, &amp;num_iterations);
<a name="l00958"></a>00958       HYPRE_ParCSRGMRESGetFinalRelativeResidualNorm(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>,
<a name="l00959"></a>00959                                                     &amp;final_res_norm);
<a name="l00960"></a>00960 
<a name="l00961"></a>00961       MPI_Comm_rank(comm, &amp;myid);
<a name="l00962"></a>00962 
<a name="l00963"></a>00963       <span class="keywordflow">if</span> (myid == 0)
<a name="l00964"></a>00964       {
<a name="l00965"></a>00965          cout &lt;&lt; <span class="stringliteral">&quot;GMRES Iterations = &quot;</span> &lt;&lt; num_iterations &lt;&lt; endl
<a name="l00966"></a>00966               &lt;&lt; <span class="stringliteral">&quot;Final GMRES Relative Residual Norm = &quot;</span> &lt;&lt; final_res_norm
<a name="l00967"></a>00967               &lt;&lt; endl;
<a name="l00968"></a>00968       }
<a name="l00969"></a>00969    }
<a name="l00970"></a>00970 }
<a name="l00971"></a>00971 
<a name="l00972"></a>00972 <a class="code" href="classHypreGMRES.html#a137b9315da70b3379afde976ce213522">HypreGMRES::~HypreGMRES</a>()
<a name="l00973"></a>00973 {
<a name="l00974"></a>00974    HYPRE_ParCSRGMRESDestroy(<a class="code" href="classHypreGMRES.html#ae1be31a79b029a94c7df5458bdebed0f">gmres_solver</a>);
<a name="l00975"></a>00975 }
<a name="l00976"></a>00976 
<a name="l00977"></a>00977 
<a name="l00978"></a>00978 <a class="code" href="classHypreParaSails.html#aab35e3cf75099eef59d29a96a15c9d2c">HypreParaSails::HypreParaSails</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;A) : <a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a>(&amp;A)
<a name="l00979"></a>00979 {
<a name="l00980"></a>00980    MPI_Comm comm;
<a name="l00981"></a>00981 
<a name="l00982"></a>00982    <span class="keywordtype">int</span>    sai_max_levels = 1;
<a name="l00983"></a>00983    <span class="keywordtype">double</span> sai_threshold  = 0.1;
<a name="l00984"></a>00984    <span class="keywordtype">double</span> sai_filter     = 0.1;
<a name="l00985"></a>00985    <span class="keywordtype">int</span>    sai_sym        = 0;
<a name="l00986"></a>00986    <span class="keywordtype">double</span> sai_loadbal    = 0.0;
<a name="l00987"></a>00987    <span class="keywordtype">int</span>    sai_reuse      = 0;
<a name="l00988"></a>00988    <span class="keywordtype">int</span>    sai_logging    = 1;
<a name="l00989"></a>00989 
<a name="l00990"></a>00990    HYPRE_ParCSRMatrixGetComm(A, &amp;comm);
<a name="l00991"></a>00991 
<a name="l00992"></a>00992    HYPRE_ParaSailsCreate(comm, &amp;sai_precond);
<a name="l00993"></a>00993    HYPRE_ParaSailsSetParams(sai_precond, sai_threshold, sai_max_levels);
<a name="l00994"></a>00994    HYPRE_ParaSailsSetFilter(sai_precond, sai_filter);
<a name="l00995"></a>00995    HYPRE_ParaSailsSetSym(sai_precond, sai_sym);
<a name="l00996"></a>00996    HYPRE_ParaSailsSetLoadbal(sai_precond, sai_loadbal);
<a name="l00997"></a>00997    HYPRE_ParaSailsSetReuse(sai_precond, sai_reuse);
<a name="l00998"></a>00998    HYPRE_ParaSailsSetLogging(sai_precond, sai_logging);
<a name="l00999"></a>00999 }
<a name="l01000"></a>01000 
<a name="l01001"></a>01001 <span class="keywordtype">void</span> <a class="code" href="classHypreParaSails.html#ae672948b42fdd12d673c71b15e07d311">HypreParaSails::SetSymmetry</a>(<span class="keywordtype">int</span> sym)
<a name="l01002"></a>01002 {
<a name="l01003"></a>01003    HYPRE_ParaSailsSetSym(<a class="code" href="classHypreParaSails.html#aa2420fb62824586f5377deb28106d1a5">sai_precond</a>, sym);
<a name="l01004"></a>01004 }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006 <a class="code" href="classHypreParaSails.html#a1c459e00cca51be758eab7f8ade7e8be">HypreParaSails::~HypreParaSails</a>()
<a name="l01007"></a>01007 {
<a name="l01008"></a>01008    HYPRE_ParaSailsDestroy(<a class="code" href="classHypreParaSails.html#aa2420fb62824586f5377deb28106d1a5">sai_precond</a>);
<a name="l01009"></a>01009 }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011 
<a name="l01012"></a>01012 <a class="code" href="classHypreBoomerAMG.html#ab6a62fdd70f895d1c7a3c683db233c35">HypreBoomerAMG::HypreBoomerAMG</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;A) : <a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a>(&amp;A)
<a name="l01013"></a>01013 {
<a name="l01014"></a>01014    <span class="keywordtype">int</span> coarsen_type = 10;
<a name="l01015"></a>01015    <span class="keywordtype">int</span> agg_levels   = 1;
<a name="l01016"></a>01016    <span class="keywordtype">int</span> relax_type   = 8;
<a name="l01017"></a>01017    <span class="keywordtype">int</span> relax_sweeps = 1;
<a name="l01018"></a>01018    <span class="keywordtype">double</span> theta     = 0.25;
<a name="l01019"></a>01019    <span class="keywordtype">int</span> interp_type  = 6;
<a name="l01020"></a>01020    <span class="keywordtype">int</span> Pmax         = 4;
<a name="l01021"></a>01021    <span class="keywordtype">int</span> print_level  = 1;
<a name="l01022"></a>01022 
<a name="l01023"></a>01023    HYPRE_BoomerAMGCreate(&amp;amg_precond);
<a name="l01024"></a>01024 
<a name="l01025"></a>01025    HYPRE_BoomerAMGSetCoarsenType(amg_precond, coarsen_type);
<a name="l01026"></a>01026    HYPRE_BoomerAMGSetAggNumLevels(amg_precond, agg_levels);
<a name="l01027"></a>01027    HYPRE_BoomerAMGSetRelaxType(amg_precond, relax_type);
<a name="l01028"></a>01028    HYPRE_BoomerAMGSetNumSweeps(amg_precond, relax_sweeps);
<a name="l01029"></a>01029    HYPRE_BoomerAMGSetMaxLevels(amg_precond, 25);
<a name="l01030"></a>01030    HYPRE_BoomerAMGSetTol(amg_precond, 0.0);
<a name="l01031"></a>01031    HYPRE_BoomerAMGSetMaxIter(amg_precond, 1); <span class="comment">// one V-cycle</span>
<a name="l01032"></a>01032    HYPRE_BoomerAMGSetStrongThreshold(amg_precond, theta);
<a name="l01033"></a>01033    HYPRE_BoomerAMGSetInterpType(amg_precond, interp_type);
<a name="l01034"></a>01034    HYPRE_BoomerAMGSetPMaxElmts(amg_precond, Pmax);
<a name="l01035"></a>01035    HYPRE_BoomerAMGSetPrintLevel(amg_precond, print_level);
<a name="l01036"></a>01036 }
<a name="l01037"></a>01037 
<a name="l01038"></a>01038 <span class="keywordtype">void</span> <a class="code" href="classHypreBoomerAMG.html#ac43e9aefde0a7ccd33d40e8f2b891b61">HypreBoomerAMG::SetSystemsOptions</a>(<span class="keywordtype">int</span> dim)
<a name="l01039"></a>01039 {
<a name="l01040"></a>01040    HYPRE_BoomerAMGSetNumFunctions(<a class="code" href="classHypreBoomerAMG.html#a704449e0050a585239ffcec6850f3012">amg_precond</a>, dim);
<a name="l01041"></a>01041 
<a name="l01042"></a>01042    <span class="comment">// More robust options with respect to convergence</span>
<a name="l01043"></a>01043    HYPRE_BoomerAMGSetAggNumLevels(<a class="code" href="classHypreBoomerAMG.html#a704449e0050a585239ffcec6850f3012">amg_precond</a>, 0);
<a name="l01044"></a>01044    HYPRE_BoomerAMGSetStrongThreshold(<a class="code" href="classHypreBoomerAMG.html#a704449e0050a585239ffcec6850f3012">amg_precond</a>, 0.5);
<a name="l01045"></a>01045 }
<a name="l01046"></a>01046 
<a name="l01047"></a>01047 <a class="code" href="classHypreBoomerAMG.html#a77e0b2aae62ea6fb8beb69d51cf96ba9">HypreBoomerAMG::~HypreBoomerAMG</a>()
<a name="l01048"></a>01048 {
<a name="l01049"></a>01049    HYPRE_BoomerAMGDestroy(<a class="code" href="classHypreBoomerAMG.html#a704449e0050a585239ffcec6850f3012">amg_precond</a>);
<a name="l01050"></a>01050 }
<a name="l01051"></a>01051 
<a name="l01052"></a>01052 
<a name="l01053"></a>01053 <a class="code" href="classHypreAMS.html#a5065e35b3784fd56a45aaade5fb8a839">HypreAMS::HypreAMS</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;A, <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *edge_fespace)
<a name="l01054"></a>01054    : <a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a>(&amp;A)
<a name="l01055"></a>01055 {
<a name="l01056"></a>01056    <span class="keywordtype">int</span> cycle_type       = 13;
<a name="l01057"></a>01057    <span class="keywordtype">int</span> rlx_type         = 2;
<a name="l01058"></a>01058    <span class="keywordtype">int</span> rlx_sweeps       = 1;
<a name="l01059"></a>01059    <span class="keywordtype">double</span> rlx_weight    = 1.0;
<a name="l01060"></a>01060    <span class="keywordtype">double</span> rlx_omega     = 1.0;
<a name="l01061"></a>01061    <span class="keywordtype">int</span> amg_coarsen_type = 10;
<a name="l01062"></a>01062    <span class="keywordtype">int</span> amg_agg_levels   = 1;
<a name="l01063"></a>01063    <span class="keywordtype">int</span> amg_rlx_type     = 8;
<a name="l01064"></a>01064    <span class="keywordtype">double</span> theta         = 0.25;
<a name="l01065"></a>01065    <span class="keywordtype">int</span> amg_interp_type  = 6;
<a name="l01066"></a>01066    <span class="keywordtype">int</span> amg_Pmax         = 4;
<a name="l01067"></a>01067 
<a name="l01068"></a>01068    <span class="keywordtype">int</span> p = edge_fespace-&gt;<a class="code" href="classFiniteElementSpace.html#ac65cc7014e43d28a7909bf344ee487f4" title="Returns the order of the i&#39;th finite element.">GetOrder</a>(0);
<a name="l01069"></a>01069    <span class="keywordtype">int</span> dim = edge_fespace-&gt;<a class="code" href="classFiniteElementSpace.html#af94936ea008e6e1f7b6600a627164582" title="Returns the mesh.">GetMesh</a>()-&gt;<a class="code" href="classMesh.html#a06b6803b50a04ee6961c455b5af90b6b">Dimension</a>();
<a name="l01070"></a>01070 
<a name="l01071"></a>01071    HYPRE_AMSCreate(&amp;ams);
<a name="l01072"></a>01072 
<a name="l01073"></a>01073    HYPRE_AMSSetDimension(ams, dim); <span class="comment">// 2D H(div) and 3D H(curl) problems</span>
<a name="l01074"></a>01074    HYPRE_AMSSetTol(ams, 0.0);
<a name="l01075"></a>01075    HYPRE_AMSSetMaxIter(ams, 1); <span class="comment">// use as a preconditioner</span>
<a name="l01076"></a>01076    HYPRE_AMSSetCycleType(ams, cycle_type);
<a name="l01077"></a>01077    HYPRE_AMSSetPrintLevel(ams, 1);
<a name="l01078"></a>01078 
<a name="l01079"></a>01079    <span class="comment">// define the nodal linear finite element space associated with edge_fespace</span>
<a name="l01080"></a>01080    <a class="code" href="classParMesh.html" title="Class for parallel meshes.">ParMesh</a> *pmesh = (<a class="code" href="classParMesh.html" title="Class for parallel meshes.">ParMesh</a> *) edge_fespace-&gt;<a class="code" href="classFiniteElementSpace.html#af94936ea008e6e1f7b6600a627164582" title="Returns the mesh.">GetMesh</a>();
<a name="l01081"></a>01081    <a class="code" href="classFiniteElementCollection.html">FiniteElementCollection</a> *vert_fec = <span class="keyword">new</span> <a class="code" href="classH1__FECollection.html" title="Arbitrary order H1-conforming (continuous) finite elements.">H1_FECollection</a>(p, dim);
<a name="l01082"></a>01082    <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *vert_fespace = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec);
<a name="l01083"></a>01083 
<a name="l01084"></a>01084    <span class="comment">// generate and set the vertex coordinates</span>
<a name="l01085"></a>01085    <span class="keywordflow">if</span> (p == 1)
<a name="l01086"></a>01086    {
<a name="l01087"></a>01087       <a class="code" href="classParGridFunction.html" title="Class for parallel grid function.">ParGridFunction</a> x_coord(vert_fespace);
<a name="l01088"></a>01088       <a class="code" href="classParGridFunction.html" title="Class for parallel grid function.">ParGridFunction</a> y_coord(vert_fespace);
<a name="l01089"></a>01089       <a class="code" href="classParGridFunction.html" title="Class for parallel grid function.">ParGridFunction</a> z_coord(vert_fespace);
<a name="l01090"></a>01090       <span class="keywordtype">double</span> *coord;
<a name="l01091"></a>01091       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pmesh-&gt;<a class="code" href="classMesh.html#ac2d12b05fea355a064bb01252c04b461" title="Returns number of vertices.">GetNV</a>(); i++)
<a name="l01092"></a>01092       {
<a name="l01093"></a>01093          coord = pmesh -&gt; GetVertex(i);
<a name="l01094"></a>01094          x_coord(i) = coord[0];
<a name="l01095"></a>01095          y_coord(i) = coord[1];
<a name="l01096"></a>01096          <span class="keywordflow">if</span> (dim == 3)
<a name="l01097"></a>01097             z_coord(i) = coord[2];
<a name="l01098"></a>01098       }
<a name="l01099"></a>01099       x = x_coord.ParallelAverage();
<a name="l01100"></a>01100       y = y_coord.ParallelAverage();
<a name="l01101"></a>01101       <span class="keywordflow">if</span> (dim == 2)
<a name="l01102"></a>01102       {
<a name="l01103"></a>01103          z = NULL;
<a name="l01104"></a>01104          HYPRE_AMSSetCoordinateVectors(ams, *x, *y, NULL);
<a name="l01105"></a>01105       }
<a name="l01106"></a>01106       <span class="keywordflow">else</span>
<a name="l01107"></a>01107       {
<a name="l01108"></a>01108          z = z_coord.ParallelAverage();
<a name="l01109"></a>01109          HYPRE_AMSSetCoordinateVectors(ams, *x, *y, *z);
<a name="l01110"></a>01110       }
<a name="l01111"></a>01111    }
<a name="l01112"></a>01112    <span class="keywordflow">else</span>
<a name="l01113"></a>01113    {
<a name="l01114"></a>01114       x = NULL;
<a name="l01115"></a>01115       y = NULL;
<a name="l01116"></a>01116       z = NULL;
<a name="l01117"></a>01117    }
<a name="l01118"></a>01118 
<a name="l01119"></a>01119    <span class="comment">// generate and set the discrete gradient</span>
<a name="l01120"></a>01120    <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a> *grad;
<a name="l01121"></a>01121    grad = <span class="keyword">new</span> <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a>(vert_fespace, edge_fespace);
<a name="l01122"></a>01122    grad-&gt;<a class="code" href="classDiscreteLinearOperator.html#af781c42168ba8e4fc148434cca5ea15a">AddDomainInterpolator</a>(<span class="keyword">new</span> <a class="code" href="classGradientInterpolator.html">GradientInterpolator</a>);
<a name="l01123"></a>01123    grad-&gt;<a class="code" href="classDiscreteLinearOperator.html#a71b321570fbda44b0e6f2d6ab7739f57">Assemble</a>();
<a name="l01124"></a>01124    grad-&gt;<a class="code" href="classMixedBilinearForm.html#aa065ade61cec1afb281a8443eb759d64" title="Finalizes the matrix initialization.">Finalize</a>();
<a name="l01125"></a>01125    G = grad-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a228188e0c70b53c3e032b21d7ed08fc1">ParallelAssemble</a>();
<a name="l01126"></a>01126    HYPRE_AMSSetDiscreteGradient(ams, *G);
<a name="l01127"></a>01127    <span class="keyword">delete</span> grad;
<a name="l01128"></a>01128 
<a name="l01129"></a>01129    <span class="comment">// generate and set the Nedelec interpolation matrices</span>
<a name="l01130"></a>01130    Pi = Pix = Piy = Piz = NULL;
<a name="l01131"></a>01131    <span class="keywordflow">if</span> (p &gt; 1)
<a name="l01132"></a>01132    {
<a name="l01133"></a>01133       <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *vert_fespace_d;
<a name="l01134"></a>01134       <span class="keywordflow">if</span> (cycle_type &lt; 10)
<a name="l01135"></a>01135          vert_fespace_d = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec, dim,
<a name="l01136"></a>01136                                                     <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8aaf0d6502f86edb15f545927a104917fb">Ordering::byVDIM</a>);
<a name="l01137"></a>01137       <span class="keywordflow">else</span>
<a name="l01138"></a>01138          vert_fespace_d = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec, dim,
<a name="l01139"></a>01139                                                     <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8a4c0f58e61480fb4ce67b96175571dd78">Ordering::byNODES</a>);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141       <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a> *id_ND;
<a name="l01142"></a>01142       id_ND = <span class="keyword">new</span> <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a>(vert_fespace_d, edge_fespace);
<a name="l01143"></a>01143       id_ND-&gt;<a class="code" href="classDiscreteLinearOperator.html#af781c42168ba8e4fc148434cca5ea15a">AddDomainInterpolator</a>(<span class="keyword">new</span> <a class="code" href="classIdentityInterpolator.html">IdentityInterpolator</a>);
<a name="l01144"></a>01144       id_ND-&gt;<a class="code" href="classDiscreteLinearOperator.html#a71b321570fbda44b0e6f2d6ab7739f57">Assemble</a>();
<a name="l01145"></a>01145 
<a name="l01146"></a>01146       <span class="keywordflow">if</span> (cycle_type &lt; 10)
<a name="l01147"></a>01147       {
<a name="l01148"></a>01148          id_ND-&gt;<a class="code" href="classMixedBilinearForm.html#aa065ade61cec1afb281a8443eb759d64" title="Finalizes the matrix initialization.">Finalize</a>();
<a name="l01149"></a>01149          Pi = id_ND-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a228188e0c70b53c3e032b21d7ed08fc1">ParallelAssemble</a>();
<a name="l01150"></a>01150       }
<a name="l01151"></a>01151       <span class="keywordflow">else</span>
<a name="l01152"></a>01152       {
<a name="l01153"></a>01153          <a class="code" href="classArray2D.html">Array2D&lt;HypreParMatrix *&gt;</a> Pi_blocks;
<a name="l01154"></a>01154          id_ND-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a8e33e60b18edaa4dcb5bfee0f3c4723f">GetParBlocks</a>(Pi_blocks);
<a name="l01155"></a>01155          Pix = Pi_blocks(0,0);
<a name="l01156"></a>01156          Piy = Pi_blocks(0,1);
<a name="l01157"></a>01157          <span class="keywordflow">if</span> (dim == 3)
<a name="l01158"></a>01158             Piz = Pi_blocks(0,2);
<a name="l01159"></a>01159       }
<a name="l01160"></a>01160 
<a name="l01161"></a>01161       HYPRE_AMSSetInterpolations(ams, *Pi, *Pix, *Piy, *Piz);
<a name="l01162"></a>01162 
<a name="l01163"></a>01163       <span class="keyword">delete</span> vert_fespace_d;
<a name="l01164"></a>01164    }
<a name="l01165"></a>01165 
<a name="l01166"></a>01166    <span class="keyword">delete</span> vert_fespace;
<a name="l01167"></a>01167    <span class="keyword">delete</span> vert_fec;
<a name="l01168"></a>01168 
<a name="l01169"></a>01169    <span class="comment">// set additional AMS options</span>
<a name="l01170"></a>01170    HYPRE_AMSSetSmoothingOptions(ams, rlx_type, rlx_sweeps, rlx_weight, rlx_omega);
<a name="l01171"></a>01171    HYPRE_AMSSetAlphaAMGOptions(ams, amg_coarsen_type, amg_agg_levels, amg_rlx_type,
<a name="l01172"></a>01172                                theta, amg_interp_type, amg_Pmax);
<a name="l01173"></a>01173    HYPRE_AMSSetBetaAMGOptions(ams, amg_coarsen_type, amg_agg_levels, amg_rlx_type,
<a name="l01174"></a>01174                               theta, amg_interp_type, amg_Pmax);
<a name="l01175"></a>01175 }
<a name="l01176"></a>01176 
<a name="l01177"></a>01177 <a class="code" href="classHypreAMS.html#a62d6cc8160657f5fe0bf98e6b79c9388">HypreAMS::~HypreAMS</a>()
<a name="l01178"></a>01178 {
<a name="l01179"></a>01179    HYPRE_AMSDestroy(<a class="code" href="classHypreAMS.html#add0bd97a91bd3c4e8bb77281bc2bc327">ams</a>);
<a name="l01180"></a>01180 
<a name="l01181"></a>01181    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#aff58e4f1f4cec7644632326f3fc21fba" title="Vertex coordinates.">x</a>;
<a name="l01182"></a>01182    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#a665275bbe8fe5a62799f2e08299bfbba">y</a>;
<a name="l01183"></a>01183    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#a646709299f45a6cf023513b6225dea4f">z</a>;
<a name="l01184"></a>01184 
<a name="l01185"></a>01185    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#ac70c2066d66840fc29eb7a8593f9005d" title="Discrete gradient matrix.">G</a>;
<a name="l01186"></a>01186    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#a7e6ca8a1dc3fd89ab0d67bd54c263b6d" title="Nedelec interpolation matrix and its components.">Pi</a>;
<a name="l01187"></a>01187    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#a2c2091f6e755b6f42512873865ec02ba">Pix</a>;
<a name="l01188"></a>01188    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#a94e8df5d9ef22fd007618296dd9679d9">Piy</a>;
<a name="l01189"></a>01189    <span class="keyword">delete</span> <a class="code" href="classHypreAMS.html#af9a0fdec726edc25222f163206cf5398">Piz</a>;
<a name="l01190"></a>01190 }
<a name="l01191"></a>01191 
<a name="l01192"></a>01192 <a class="code" href="classHypreADS.html#a61acda51da7882c3047e4a13fa060e00">HypreADS::HypreADS</a>(<a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> &amp;A, <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *face_fespace)
<a name="l01193"></a>01193    : <a class="code" href="classHypreSolver.html" title="Abstract class for hypre&#39;s solvers and preconditioners.">HypreSolver</a>(&amp;A)
<a name="l01194"></a>01194 {
<a name="l01195"></a>01195    <span class="keywordtype">int</span> cycle_type       = 11;
<a name="l01196"></a>01196    <span class="keywordtype">int</span> rlx_type         = 2;
<a name="l01197"></a>01197    <span class="keywordtype">int</span> rlx_sweeps       = 1;
<a name="l01198"></a>01198    <span class="keywordtype">double</span> rlx_weight    = 1.0;
<a name="l01199"></a>01199    <span class="keywordtype">double</span> rlx_omega     = 1.0;
<a name="l01200"></a>01200    <span class="keywordtype">int</span> amg_coarsen_type = 10;
<a name="l01201"></a>01201    <span class="keywordtype">int</span> amg_agg_levels   = 1;
<a name="l01202"></a>01202    <span class="keywordtype">int</span> amg_rlx_type     = 6;
<a name="l01203"></a>01203    <span class="keywordtype">double</span> theta         = 0.25;
<a name="l01204"></a>01204    <span class="keywordtype">int</span> amg_interp_type  = 6;
<a name="l01205"></a>01205    <span class="keywordtype">int</span> amg_Pmax         = 4;
<a name="l01206"></a>01206    <span class="keywordtype">int</span> ams_cycle_type   = 14;
<a name="l01207"></a>01207 
<a name="l01208"></a>01208    <span class="keywordtype">int</span> p = face_fespace-&gt;<a class="code" href="classFiniteElementSpace.html#ac65cc7014e43d28a7909bf344ee487f4" title="Returns the order of the i&#39;th finite element.">GetOrder</a>(0);
<a name="l01209"></a>01209 
<a name="l01210"></a>01210    HYPRE_ADSCreate(&amp;ads);
<a name="l01211"></a>01211 
<a name="l01212"></a>01212    HYPRE_ADSSetTol(ads, 0.0);
<a name="l01213"></a>01213    HYPRE_ADSSetMaxIter(ads, 1); <span class="comment">// use as a preconditioner</span>
<a name="l01214"></a>01214    HYPRE_ADSSetCycleType(ads, cycle_type);
<a name="l01215"></a>01215    HYPRE_ADSSetPrintLevel(ads, 1);
<a name="l01216"></a>01216 
<a name="l01217"></a>01217    <span class="comment">// define the nodal and edge finite element spaces associated with face_fespace</span>
<a name="l01218"></a>01218    <a class="code" href="classParMesh.html" title="Class for parallel meshes.">ParMesh</a> *pmesh = (<a class="code" href="classParMesh.html" title="Class for parallel meshes.">ParMesh</a> *) face_fespace-&gt;<a class="code" href="classFiniteElementSpace.html#af94936ea008e6e1f7b6600a627164582" title="Returns the mesh.">GetMesh</a>();
<a name="l01219"></a>01219    <a class="code" href="classFiniteElementCollection.html">FiniteElementCollection</a> *vert_fec   = <span class="keyword">new</span> <a class="code" href="classH1__FECollection.html" title="Arbitrary order H1-conforming (continuous) finite elements.">H1_FECollection</a>(p, 3);
<a name="l01220"></a>01220    <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *vert_fespace = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec);
<a name="l01221"></a>01221    <a class="code" href="classFiniteElementCollection.html">FiniteElementCollection</a> *edge_fec   = <span class="keyword">new</span> <a class="code" href="classND__FECollection.html" title="Arbitrary order H(curl)-conforming Nedelec finite elements.">ND_FECollection</a>(p, 3);
<a name="l01222"></a>01222    <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *edge_fespace = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, edge_fec);
<a name="l01223"></a>01223 
<a name="l01224"></a>01224    <span class="comment">// generate and set the vertex coordinates</span>
<a name="l01225"></a>01225    <span class="keywordflow">if</span> (p == 1)
<a name="l01226"></a>01226    {
<a name="l01227"></a>01227       <a class="code" href="classParGridFunction.html" title="Class for parallel grid function.">ParGridFunction</a> x_coord(vert_fespace);
<a name="l01228"></a>01228       <a class="code" href="classParGridFunction.html" title="Class for parallel grid function.">ParGridFunction</a> y_coord(vert_fespace);
<a name="l01229"></a>01229       <a class="code" href="classParGridFunction.html" title="Class for parallel grid function.">ParGridFunction</a> z_coord(vert_fespace);
<a name="l01230"></a>01230       <span class="keywordtype">double</span> *coord;
<a name="l01231"></a>01231       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pmesh-&gt;<a class="code" href="classMesh.html#ac2d12b05fea355a064bb01252c04b461" title="Returns number of vertices.">GetNV</a>(); i++)
<a name="l01232"></a>01232       {
<a name="l01233"></a>01233          coord = pmesh -&gt; GetVertex(i);
<a name="l01234"></a>01234          x_coord(i) = coord[0];
<a name="l01235"></a>01235          y_coord(i) = coord[1];
<a name="l01236"></a>01236          z_coord(i) = coord[2];
<a name="l01237"></a>01237       }
<a name="l01238"></a>01238       x = x_coord.ParallelAverage();
<a name="l01239"></a>01239       y = y_coord.ParallelAverage();
<a name="l01240"></a>01240       z = z_coord.ParallelAverage();
<a name="l01241"></a>01241       HYPRE_ADSSetCoordinateVectors(ads, *x, *y, *z);
<a name="l01242"></a>01242    }
<a name="l01243"></a>01243    <span class="keywordflow">else</span>
<a name="l01244"></a>01244    {
<a name="l01245"></a>01245       x = NULL;
<a name="l01246"></a>01246       y = NULL;
<a name="l01247"></a>01247       z = NULL;
<a name="l01248"></a>01248    }
<a name="l01249"></a>01249 
<a name="l01250"></a>01250    <span class="comment">// generate and set the discrete curl</span>
<a name="l01251"></a>01251    <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a> *curl;
<a name="l01252"></a>01252    curl = <span class="keyword">new</span> <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a>(edge_fespace, face_fespace);
<a name="l01253"></a>01253    curl-&gt;<a class="code" href="classDiscreteLinearOperator.html#af781c42168ba8e4fc148434cca5ea15a">AddDomainInterpolator</a>(<span class="keyword">new</span> <a class="code" href="classCurlInterpolator.html">CurlInterpolator</a>);
<a name="l01254"></a>01254    curl-&gt;<a class="code" href="classDiscreteLinearOperator.html#a71b321570fbda44b0e6f2d6ab7739f57">Assemble</a>();
<a name="l01255"></a>01255    curl-&gt;<a class="code" href="classMixedBilinearForm.html#aa065ade61cec1afb281a8443eb759d64" title="Finalizes the matrix initialization.">Finalize</a>();
<a name="l01256"></a>01256    C = curl-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a228188e0c70b53c3e032b21d7ed08fc1">ParallelAssemble</a>();
<a name="l01257"></a>01257    HYPRE_ADSSetDiscreteCurl(ads, *C);
<a name="l01258"></a>01258    <span class="keyword">delete</span> curl;
<a name="l01259"></a>01259 
<a name="l01260"></a>01260    <span class="comment">// generate and set the discrete gradient</span>
<a name="l01261"></a>01261    <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a> *grad;
<a name="l01262"></a>01262    grad = <span class="keyword">new</span> <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a>(vert_fespace, edge_fespace);
<a name="l01263"></a>01263    grad-&gt;<a class="code" href="classDiscreteLinearOperator.html#af781c42168ba8e4fc148434cca5ea15a">AddDomainInterpolator</a>(<span class="keyword">new</span> <a class="code" href="classGradientInterpolator.html">GradientInterpolator</a>);
<a name="l01264"></a>01264    grad-&gt;<a class="code" href="classDiscreteLinearOperator.html#a71b321570fbda44b0e6f2d6ab7739f57">Assemble</a>();
<a name="l01265"></a>01265    grad-&gt;<a class="code" href="classMixedBilinearForm.html#aa065ade61cec1afb281a8443eb759d64" title="Finalizes the matrix initialization.">Finalize</a>();
<a name="l01266"></a>01266    G = grad-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a228188e0c70b53c3e032b21d7ed08fc1">ParallelAssemble</a>();
<a name="l01267"></a>01267    HYPRE_ADSSetDiscreteGradient(ads, *G);
<a name="l01268"></a>01268    <span class="keyword">delete</span> grad;
<a name="l01269"></a>01269 
<a name="l01270"></a>01270    <span class="comment">// generate and set the Nedelec and Raviart-Thomas interpolation matrices</span>
<a name="l01271"></a>01271    RT_Pi = RT_Pix = RT_Piy = RT_Piz = NULL;
<a name="l01272"></a>01272    ND_Pi = ND_Pix = ND_Piy = ND_Piz = NULL;
<a name="l01273"></a>01273    <span class="keywordflow">if</span> (p &gt; 1)
<a name="l01274"></a>01274    {
<a name="l01275"></a>01275       <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *vert_fespace_d;
<a name="l01276"></a>01276 
<a name="l01277"></a>01277       <span class="keywordflow">if</span> (ams_cycle_type &lt; 10)
<a name="l01278"></a>01278          vert_fespace_d = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec, 3,
<a name="l01279"></a>01279                                                     <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8aaf0d6502f86edb15f545927a104917fb">Ordering::byVDIM</a>);
<a name="l01280"></a>01280       <span class="keywordflow">else</span>
<a name="l01281"></a>01281          vert_fespace_d = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec, 3,
<a name="l01282"></a>01282                                                     <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8a4c0f58e61480fb4ce67b96175571dd78">Ordering::byNODES</a>);
<a name="l01283"></a>01283 
<a name="l01284"></a>01284       <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a> *id_ND;
<a name="l01285"></a>01285       id_ND = <span class="keyword">new</span> <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a>(vert_fespace_d, edge_fespace);
<a name="l01286"></a>01286       id_ND-&gt;<a class="code" href="classDiscreteLinearOperator.html#af781c42168ba8e4fc148434cca5ea15a">AddDomainInterpolator</a>(<span class="keyword">new</span> <a class="code" href="classIdentityInterpolator.html">IdentityInterpolator</a>);
<a name="l01287"></a>01287       id_ND-&gt;<a class="code" href="classDiscreteLinearOperator.html#a71b321570fbda44b0e6f2d6ab7739f57">Assemble</a>();
<a name="l01288"></a>01288 
<a name="l01289"></a>01289       <span class="keywordflow">if</span> (ams_cycle_type &lt; 10)
<a name="l01290"></a>01290       {
<a name="l01291"></a>01291          id_ND-&gt;<a class="code" href="classMixedBilinearForm.html#aa065ade61cec1afb281a8443eb759d64" title="Finalizes the matrix initialization.">Finalize</a>();
<a name="l01292"></a>01292          ND_Pi = id_ND-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a228188e0c70b53c3e032b21d7ed08fc1">ParallelAssemble</a>();
<a name="l01293"></a>01293       }
<a name="l01294"></a>01294       <span class="keywordflow">else</span>
<a name="l01295"></a>01295       {
<a name="l01296"></a>01296          <a class="code" href="classArray2D.html">Array2D&lt;HypreParMatrix *&gt;</a> ND_Pi_blocks;
<a name="l01297"></a>01297          id_ND-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a8e33e60b18edaa4dcb5bfee0f3c4723f">GetParBlocks</a>(ND_Pi_blocks);
<a name="l01298"></a>01298          ND_Pix = ND_Pi_blocks(0,0);
<a name="l01299"></a>01299          ND_Piy = ND_Pi_blocks(0,1);
<a name="l01300"></a>01300          ND_Piz = ND_Pi_blocks(0,2);
<a name="l01301"></a>01301       }
<a name="l01302"></a>01302 
<a name="l01303"></a>01303       <span class="keywordflow">if</span> (cycle_type &lt; 10 &amp;&amp; ams_cycle_type &gt; 10)
<a name="l01304"></a>01304       {
<a name="l01305"></a>01305          <span class="keyword">delete</span> vert_fespace_d;
<a name="l01306"></a>01306          vert_fespace_d = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec, 3,
<a name="l01307"></a>01307                                                     <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8aaf0d6502f86edb15f545927a104917fb">Ordering::byVDIM</a>);
<a name="l01308"></a>01308       }
<a name="l01309"></a>01309       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cycle_type &gt; 10 &amp;&amp; ams_cycle_type &lt; 10)
<a name="l01310"></a>01310       {
<a name="l01311"></a>01311          <span class="keyword">delete</span> vert_fespace_d;
<a name="l01312"></a>01312          vert_fespace_d = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a>(pmesh, vert_fec, 3,
<a name="l01313"></a>01313                                                     <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8a4c0f58e61480fb4ce67b96175571dd78">Ordering::byNODES</a>);
<a name="l01314"></a>01314       }
<a name="l01315"></a>01315 
<a name="l01316"></a>01316       <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a> *id_RT;
<a name="l01317"></a>01317       id_RT = <span class="keyword">new</span> <a class="code" href="classParDiscreteLinearOperator.html">ParDiscreteLinearOperator</a>(vert_fespace_d, face_fespace);
<a name="l01318"></a>01318       id_RT-&gt;<a class="code" href="classDiscreteLinearOperator.html#af781c42168ba8e4fc148434cca5ea15a">AddDomainInterpolator</a>(<span class="keyword">new</span> <a class="code" href="classIdentityInterpolator.html">IdentityInterpolator</a>);
<a name="l01319"></a>01319       id_RT-&gt;<a class="code" href="classDiscreteLinearOperator.html#a71b321570fbda44b0e6f2d6ab7739f57">Assemble</a>();
<a name="l01320"></a>01320 
<a name="l01321"></a>01321       <span class="keywordflow">if</span> (cycle_type &lt; 10)
<a name="l01322"></a>01322       {
<a name="l01323"></a>01323          id_RT-&gt;<a class="code" href="classMixedBilinearForm.html#aa065ade61cec1afb281a8443eb759d64" title="Finalizes the matrix initialization.">Finalize</a>();
<a name="l01324"></a>01324          RT_Pi = id_RT-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a228188e0c70b53c3e032b21d7ed08fc1">ParallelAssemble</a>();
<a name="l01325"></a>01325       }
<a name="l01326"></a>01326       <span class="keywordflow">else</span>
<a name="l01327"></a>01327       {
<a name="l01328"></a>01328          <a class="code" href="classArray2D.html">Array2D&lt;HypreParMatrix *&gt;</a> RT_Pi_blocks;
<a name="l01329"></a>01329          id_RT-&gt;<a class="code" href="classParDiscreteLinearOperator.html#a8e33e60b18edaa4dcb5bfee0f3c4723f">GetParBlocks</a>(RT_Pi_blocks);
<a name="l01330"></a>01330          RT_Pix = RT_Pi_blocks(0,0);
<a name="l01331"></a>01331          RT_Piy = RT_Pi_blocks(0,1);
<a name="l01332"></a>01332          RT_Piz = RT_Pi_blocks(0,2);
<a name="l01333"></a>01333       }
<a name="l01334"></a>01334 
<a name="l01335"></a>01335       HYPRE_ADSSetInterpolations(ads,
<a name="l01336"></a>01336                                  *RT_Pi, *RT_Pix, *RT_Piy, *RT_Piz,
<a name="l01337"></a>01337                                  *ND_Pi, *ND_Pix, *ND_Piy, *ND_Piz);
<a name="l01338"></a>01338 
<a name="l01339"></a>01339       <span class="keyword">delete</span> vert_fespace_d;
<a name="l01340"></a>01340    }
<a name="l01341"></a>01341 
<a name="l01342"></a>01342    <span class="keyword">delete</span> vert_fec;
<a name="l01343"></a>01343    <span class="keyword">delete</span> vert_fespace;
<a name="l01344"></a>01344    <span class="keyword">delete</span> edge_fec;
<a name="l01345"></a>01345    <span class="keyword">delete</span> edge_fespace;
<a name="l01346"></a>01346 
<a name="l01347"></a>01347    <span class="comment">// set additional ADS options</span>
<a name="l01348"></a>01348    HYPRE_ADSSetSmoothingOptions(ads, rlx_type, rlx_sweeps, rlx_weight, rlx_omega);
<a name="l01349"></a>01349    HYPRE_ADSSetAMGOptions(ads, amg_coarsen_type, amg_agg_levels, amg_rlx_type,
<a name="l01350"></a>01350                           theta, amg_interp_type, amg_Pmax);
<a name="l01351"></a>01351    HYPRE_ADSSetAMSOptions(ads, ams_cycle_type, amg_coarsen_type, amg_agg_levels,
<a name="l01352"></a>01352                           amg_rlx_type, theta, amg_interp_type, amg_Pmax);
<a name="l01353"></a>01353 }
<a name="l01354"></a>01354 
<a name="l01355"></a>01355 <a class="code" href="classHypreADS.html#a917c50137e72d79212893d5f1d630aaa">HypreADS::~HypreADS</a>()
<a name="l01356"></a>01356 {
<a name="l01357"></a>01357    HYPRE_ADSDestroy(<a class="code" href="classHypreADS.html#a723cd574f233791667fbaac2a95c425c">ads</a>);
<a name="l01358"></a>01358 
<a name="l01359"></a>01359    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#afc5856b3823916ce6b592c88faa7462d" title="Vertex coordinates.">x</a>;
<a name="l01360"></a>01360    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#ae2360c48ebdf24921a6c4b8d6b6e2e0b">y</a>;
<a name="l01361"></a>01361    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a39bba9b8230d88a9c1fda73d292c855b">z</a>;
<a name="l01362"></a>01362 
<a name="l01363"></a>01363    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a87ca0034c7efb4cb179d5b1f2d415468" title="Discrete gradient matrix.">G</a>;
<a name="l01364"></a>01364    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a3dc87b75ce013107b902aec080e6335f" title="Discrete curl matrix.">C</a>;
<a name="l01365"></a>01365 
<a name="l01366"></a>01366    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a50945956631b7c295a2b6f7c12fcc700" title="Raviart-Thomas interpolation matrix and its components.">RT_Pi</a>;
<a name="l01367"></a>01367    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#ad8fcfd5f6925cb3083c617d1f8faa56b">RT_Pix</a>;
<a name="l01368"></a>01368    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a891eea0e2475dfc3e27b2dfc088f7a5f">RT_Piy</a>;
<a name="l01369"></a>01369    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a8772aa9c96a65c07803b9089e88f96d0">RT_Piz</a>;
<a name="l01370"></a>01370 
<a name="l01371"></a>01371    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a67f6976bceee05033e2681d2b2ea1fe2" title="Nedelec interpolation matrix and its components.">ND_Pi</a>;
<a name="l01372"></a>01372    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#a23f3dbe39a1c296ba8077b89537dfc0c">ND_Pix</a>;
<a name="l01373"></a>01373    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#ace436889a2c594562306b6e6fb1aaadd">ND_Piy</a>;
<a name="l01374"></a>01374    <span class="keyword">delete</span> <a class="code" href="classHypreADS.html#ae52e4a67ba98c82d5934b4c6adce3a5d">ND_Piz</a>;
<a name="l01375"></a>01375 }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Nov 18 2011 11:44:55 for MFEM by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
